import{M as o}from"../vendor/vendor-vue-multiselect.216400db.js";import{E as n}from"../app.a373aa59.js";import{m as i,i as r}from"../vendor/vendor-core.3574f8d9.js";import{n as u}from"../_plugin-vue2_normalizer.7b9a2fe2.js";import"../vendor/vendor-others.c8ba1624.js";import"../vendor/vendor-essential.91b5cfa2.js";import"../vendor/vendor-bootstrap-vue.17129278.js";import"../vendor/vendor-vue-gtag.f8884558.js";const p={name:"search-tag",components:{Multiselect:o},props:{value:{type:[Object,Array,String]},label:{type:String,default:$t("general.enter_a_tag")},entityLabel:{type:String,default:$t("general.tags")},trackBy:{type:String,default:"slug"},showBy:{type:String,default:"name"},error:{type:String,default:null},taggable:{type:Boolean,default:!0},searchable:{type:Boolean,default:!0},allowEmpty:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},multiple:{type:Boolean,default:!0},closeOnSelect:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},wrapperClasses:{type:String},inputClasses:{type:String,default:""},position:{type:String,default:"top"},simple:{type:Boolean,default:!1},commaSeparatedMultiple:{type:Boolean,default:!1},addNew:{type:String},addNewModal:{type:Boolean,default:!1},neededPermission:{type:String},autoFocus:{type:Boolean,default:!1},optionsLimit:{type:Number,deafult:5},url:{type:String,default:"tags"},type:{type:String,default:""},method:{type:String,default:"get"},params:{type:Object,default(){return{}}}},data(){return{cbId:"",options:[],formErrors:{},showNewModel:!1,isLoading:!1}},computed:{...i("config",["uiConfigs"]),...i("user",["hasPermission"]),tags:{get(){if(this.value&&this.simple)if(this.multiple){let e=this.value,t=[];return _.isArray(e)||(e=e.replace(/\s+/g,"").split(",")),this.options.length?t=this.options.filter(s=>e.indexOf(s[this.trackBy])!==-1):t=e.map(s=>({slug:s,name:s.replace("-"," ")})),t}else return this.options.find(e=>e[this.trackBy]===this.value);else return this.value},set(e){let t=null;e&&this.simple?_.isArray(e)?(t=e.map(s=>s[this.trackBy]),t=t.join(",")):t=e[this.trackBy]:t=e,this.$emit("input",t),this.$emit("update:error","")}}},methods:{...r("common",["Custom"]),...r("config",["SetUiConfig"]),searchTags:_.debounce(function(e){if(e.length<3)return!1;this.isLoading=!0,this.Custom({url:this.url+(this.type?"?type="+this.type:""),method:this.method,params:{q:e,...this.params}}).then(t=>{this.tags?this.options=[...this.tags,...t]:this.options=t,this.isLoading=!1}).catch(t=>{this.tags?this.options=[...this.tags]:this.options=[],this.isLoading=!1,this.formErrors=n(t)})},500),addTag(e){this.$emit("tag",e),this.focus()},removeTag(e){this.tags=this.tags.filter(t=>t[this.trackBy]!==e[this.trackBy])},clearSelectedTags(){this.tags=null,this.options=[],this.focus()},focus(){setTimeout(()=>{this.$refs&&this.cbId&&this.$refs[`multiselect${this.cbId}`]&&this.$refs[`multiselect${this.cbId}`].activate()},500)}},mounted(){this.autoFocus&&this.focus()},created(){this.cbId=Math.random().toString(16).slice(2)}};var c=function(){var t=this,s=t._self._c;return s("div",{class:["multiselect-wrapper",{"not-empty":!!t.tags},{required:t.required},t.wrapperClasses]},[s("label",{staticClass:"input-group-material-label"},[t._v(t._s(t.label)+" "),t.required?s("span",{staticClass:"required-asterix"},[t._v("*")]):t._e()]),s("multiselect",{ref:`multiselect${t.cbId}`,class:["input-group-material",t.inputClasses],attrs:{options:t.options,placeholder:t.label,"track-by":t.trackBy,label:t.showBy,searchable:t.searchable,"show-labels":!1,"allow-empty":t.allowEmpty,multiple:t.multiple,"close-on-select":t.closeOnSelect,taggable:t.taggable,"tag-placeholder":t.$t("general.enter_a_tag"),disabled:t.disabled,loading:t.loading||t.isLoading,"internal-search":!1,"options-limit":t.optionsLimit,"tag-position":t.position},on:{tag:t.addTag,"search-change":t.searchTags,remove:t.removeTag},scopedSlots:t._u([{key:"clear",fn:function(a){return[t.tags&&t.allowEmpty?s("div",{staticClass:"multiselect__clear",on:{mousedown:function(l){return l.preventDefault(),l.stopPropagation(),t.clearSelectedTags(a.search)}}}):t._e()]}},{key:"noResult",fn:function(){return[s("span",{staticClass:"multiselect__no_result text-muted"},[t._v(t._s(t.$t("global.could_not_find_any",{attribute:t.entityLabel})))])]},proxy:!0},{key:"noOptions",fn:function(){return[s("span",{staticClass:"multiselect__helper text-muted"},[t._v(t._s(t.$t("general.search_helper_text")))])]},proxy:!0}]),model:{value:t.tags,callback:function(a){t.tags=a},expression:"tags"}}),t._t("errorBlock",function(){return[t.error?s("div",{staticClass:"text-danger invalid-feedback error-block mt-1"},[t._v(" "+t._s(t.error)+" ")]):t._e()]})],2)},d=[],f=u(p,c,d,!1,null,null,null,null);const k=f.exports;export{k as default};
