import{m as o,i as s}from"./vendor/vendor-core.3574f8d9.js";import{l as f,m as n,n as h,o as m}from"./app.a373aa59.js";import"./vendor/vendor-essential.91b5cfa2.js";import"./vendor/vendor-others.c8ba1624.js";const p={components:{},data(){return{formData:{},formErrors:{},initialFormData:null,initianLength:0,emptyFormData:null,entity:null,preRequisite:{},isLoading:!0,useUserPreference:!1,dataType:null,configType:""}},computed:{...o("config",{configsWithPreference:"configs",configs:"configsOriginal",vars:"vars",allowExtraInput:"allowExtraInput"}),formHasErrors(){let t=!1;return this.formErrors.objForEach(i=>{t=i!==""?!0:t}),t}},methods:{...s("config",["GetConfig"]),...s("user",["GetUser"]),...s("navigation",["Generate"]),...s("common",["Custom"]),findActualValue(t,i,e="uuid"){return i.find(r=>r[e]===t)||null},submit(t=!1){if(formUtil.isUnchanged(this.initialFormData,this.formData))return this.$toasted.info(this.$t("general.nothing_changed"),this.$toastConfig.info),!1;this.isLoading=!0,this.formData.hasOwnProperty("type")&&(this.formData.type=this.formData.type.snakeCase());const i=t===!0||this.useUserPreference?f:this.configType==="module"?n:h;if(this.beforeSubmit&&typeof this.beforeSubmit=="function"&&this.beforeSubmit()===!1){this.isLoading=!1;return}i(this.formData).then(e=>{(t===!0||this.useUserPreference?this.GetUser:this.GetConfig)().then(()=>{this.$toasted.success(e.message,this.$toastConfig),this.initialFormData=_.cloneDeep(this.formData),this.isLoading=!1}).catch(a=>{this.isLoading=!1,this.formErrors=formUtil.handleErrors(a)}),typeof this.afterSubmit=="function"&&this.afterSubmit(),typeof this.afterSubmitSuccess=="function"&&this.afterSubmitSuccess()}).catch(e=>{this.isLoading=!1,this.formErrors=formUtil.handleErrors(e),typeof this.afterSubmit=="function"&&this.afterSubmit(),typeof this.afterSubmitError=="function"&&this.afterSubmitError()})},reset(){formUtil.confirmAction().then(t=>{t.value&&(this.formData=Object.assign({},this.formData,_.cloneDeep(this.initialFormData)))})},unsavedCheck(t){formUtil.unsavedCheckAlert(this.initialFormData,this.formData,t)},fillPreRequisite(t){this.preRequisite.objForEach((i,e)=>{this.preRequisite[e]=t.hasOwnProperty(e)?t[e]:i}),this.isLoading=!1},fillFormData(){this.isLoading=!0;const t=this.useUserPreference?this.configsWithPreference:this.configs;this.formData.type&&t[this.formData.type]&&(this.formData=formUtil.assignValues(this.formData,t[this.formData.type])),this.formData.types&&Array.isArray(this.formData.types)&&this.formData.types.forEach(i=>{this.formData=formUtil.assignValues(this.formData,t[i])}),this.formData.override&&this.formData.objForEach((i,e)=>{i&&_.isObject(i)?this.formData[e]=formUtil.assignValues(this.formData[e],t[e]):this.formData[e]=t[e]?t[e]:i}),typeof this.addNewRow=="function"&&typeof this.addNewRowIfNone=="function"&&this.addNewRowIfNone(),this.isLoading=!1},async getInitialData(t){this.isLoading=!0;try{const i=await m(Object.keys(this.preRequisite).join(","));return this.fillPreRequisite(i),t&&this.$nextTick(()=>{t()}),i}catch(i){throw this.isLoading=!1,this.formErrors=formUtil.handleErrors(i),i}}},mounted(){this.fillFormData(),this.initialFormData=_.cloneDeep(this.formData)},beforeDestroy(){delete this.formData,delete this.formErrors,delete this.preRequisite},beforeRouteLeave(t,i,e){this.unsavedCheck(e)}};export{p as f};
