const o="@@InfiniteScroll";var b=function(e,t){var i,r,n,s,l,a=function(){e.apply(s,l),r=i};return function(){if(s=this,l=arguments,i=Date.now(),n&&(clearTimeout(n),n=null),r){var c=t-(i-r);c<0?a():n=setTimeout(()=>{a()},c)}else a()}},v=function(e){return e===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):e.scrollTop},E=document.defaultView.getComputedStyle,x=function(e){for(var t=e;t&&t.tagName!=="HTML"&&t.tagName!=="BODY"&&t.nodeType===1;){var i=E(t).overflowY;if(i==="scroll"||i==="auto")return t;t=t.parentNode}return window},y=function(e){return e===window?document.documentElement.clientHeight:e.clientHeight},g=function(e){return e===window?v(window):e.getBoundingClientRect().top+v(window)},p=function(e){for(var t=e.parentNode;t;){if(t.tagName==="HTML")return!0;if(t.nodeType===11)return!1;t=t.parentNode}return!1},w=function(){if(!this.binded){this.binded=!0;var e=this,t=e.el,i=t.getAttribute("infinite-scroll-throttle-delay"),r=200;i&&(r=Number(e.vm[i]||i),(isNaN(r)||r<0)&&(r=200)),e.throttleDelay=r,e.scrollEventTarget=x(t),e.scrollListener=b(u.bind(e),e.throttleDelay),e.scrollEventTarget.addEventListener("scroll",e.scrollListener),this.vm.$on("hook:beforeDestroy",function(){e.scrollEventTarget.removeEventListener("scroll",e.scrollListener)});var n=t.getAttribute("infinite-scroll-disabled"),s=!1;n&&(this.vm.$watch(n,function(h){e.disabled=h,!h&&e.immediateCheck&&u.call(e)}),s=Boolean(e.vm[n])),e.disabled=s;var l=t.getAttribute("infinite-scroll-distance"),a=0;l&&(a=Number(e.vm[l]||l),isNaN(a)&&(a=0)),e.distance=a;var c=t.getAttribute("infinite-scroll-immediate-check"),d=!0;c&&(d=Boolean(e.vm[c])),e.immediateCheck=d,d&&u.call(e);var m=t.getAttribute("infinite-scroll-listen-for-event");m&&e.vm.$on(m,function(){u.call(e)})}},u=function(e){var t=this.scrollEventTarget,i=this.el,r=this.distance;if(!(e!==!0&&this.disabled)){var n=v(t),s=n+y(t),l=!1;if(t===i)l=t.scrollHeight-s<=r;else{var a=g(i)-g(t)+i.offsetHeight+n;l=s+r>=a}l&&this.expression&&this.expression()}};const f={bind(e,t,i){e[o]={el:e,vm:i.context,expression:t.value};const r=arguments;e[o].vm.$on("hook:mounted",function(){e[o].vm.$nextTick(function(){p(e)&&w.call(e[o],r),e[o].bindTryCount=0;var n=function(){e[o].bindTryCount>10||(e[o].bindTryCount++,p(e)?w.call(e[o],r):setTimeout(n,50))};n()})})},unbind(e){e&&e[o]&&e[o].scrollEventTarget&&e[o].scrollEventTarget.removeEventListener("scroll",e[o].scrollListener)}},T=function(e){e.directive("InfiniteScroll",f)};window.Vue&&(window.infiniteScroll=f,Vue.use(T));f.install=T;export{f as I};
