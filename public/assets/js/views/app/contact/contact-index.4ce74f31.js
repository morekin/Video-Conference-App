import{t as i}from"../../../table.beb39f38.js";import{f as o}from"../../../filter-form.45f778d7.js";import{n as r}from"../../../_plugin-vue2_normalizer.7b9a2fe2.js";import{m as l}from"../../../vendor/vendor-core.3574f8d9.js";import{S as c}from"../../../modal-form.e741cc94.js";import"../../../app.a373aa59.js";import"../../../vendor/vendor-others.c8ba1624.js";import"../../../vendor/vendor-essential.91b5cfa2.js";import"../../../vendor/vendor-bootstrap-vue.17129278.js";import"../../../vendor/vendor-vue-gtag.f8884558.js";import"../../../header.43f859fb.js";import"../../../event-bus.6a5776a8.js";import"../../../modal-form.2f5baf34.js";const d={extends:o};var m=function(){var t=this,e=t._self._c;return e("filter-wrapper",{attrs:{boxed:t.boxed,"is-loading":t.isLoading},on:{close:function(s){return t.$emit("close")}}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 col-md-4 mb-4"},[e("base-input",{attrs:{"auto-focus":"",label:t.$t("contact.props.name"),type:"text",disabled:t.isLoading},model:{value:t.filters.name,callback:function(s){t.$set(t.filters,"name",s)},expression:"filters.name"}})],1),e("div",{staticClass:"col-12 col-md-4 mb-4"},[e("base-input",{attrs:{label:t.$t("contact.props.email"),type:"text",disabled:t.isLoading},model:{value:t.filters.email,callback:function(s){t.$set(t.filters,"email",s)},expression:"filters.email"}})],1)])])},u=[],p=r(d,m,u,!1,null,null,null,null);const f=p.exports,g={name:"segments-form",components:{SegmentForm:c},props:{selectedRows:{type:Array,default(){return[]}},preRequisite:{type:Object,default(){return{}},required:!0},formErrors:{type:Object,default(){return{}}},isLoading:{type:Boolean,default:!1},heading:{type:String,default:`${$t("global.edit",{attribute:$t("contact.segment.segments")})}`},boxed:{type:Boolean,default:!0},tagType:{type:String,default:""}},data(){return{formData:{segments:null,action:"add"}}},computed:{...l("config",["vars"])},watch:{selectedRows(n,t){n.length||(this.formData.segments=null,this.formData.action="add")}},methods:{cancel(){this.$emit("cancel")},submit(){this.$emit("submit",this.formData)}}};var b=function(){var t=this,e=t._self._c;return e("base-container",{class:["mb-4",{"mt-element":t.boxed}],attrs:{boxed:t.boxed,"with-loader":"","is-loading":t.isLoading,"loader-color":t.vars.loaderColor}},[e("close-button",{attrs:{title:t.$t("general.close"),"small-corner-padding":""},on:{click:t.cancel}}),e("h5",{staticClass:"text-muted font-weight-bold mb-4"},[t._v(t._s(t.heading))]),e("form",{on:{submit:function(s){return s.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 col-md-6"},[e("base-select",{attrs:{options:t.preRequisite.segments,label:t.$t("global.select",{attribute:t.$t("contact.segment.segments")}),error:t.formErrors.segments,multiple:"","close-on-select":!1,"allow-empty":!0,"page-route":"appSegmentList"},on:{"update:error":function(s){return t.$set(t.formErrors,"segments",s)}},model:{value:t.formData.segments,callback:function(s){t.$set(t.formData,"segments",s)},expression:"formData.segments"}})],1),e("div",{staticClass:"col-12 col-md-3 d-flex align-items-center"},[e("base-radio",{staticClass:"mt-2",attrs:{value:"add",inline:""},model:{value:t.formData.action,callback:function(s){t.$set(t.formData,"action",s)},expression:"formData.action"}},[t._v(" "+t._s(t.$t("general.add"))+" ")]),e("base-radio",{staticClass:"ml-3 mt-2",attrs:{value:"remove",inline:""},model:{value:t.formData.action,callback:function(s){t.$set(t.formData,"action",s)},expression:"formData.action"}},[t._v(" "+t._s(t.$t("general.remove"))+" ")])],1),e("div",{staticClass:"col-12 col-md-3 d-flex justify-content-end align-items-center"},[e("base-button",{attrs:{type:"button",design:"light",disabled:t.isLoading},on:{click:t.cancel}},[t._v(t._s(t.$t("general.cancel")))]),e("base-button",{attrs:{type:"submit",design:"primary",disabled:t.isLoading}},[t._v(t._s(t.$t("general.apply")))])],1)])])],1)},_=[],v=r(g,b,_,!1,null,null,null,null);const y=v.exports,h={components:{FilterForm:f,SegmentsForm:y},extends:i,data(){return{fields:[{key:"select",label:"",cantHide:!0,thClass:"select-wrapper",tdClass:"select-wrapper"},{key:"email",label:$t("contact.props.email")},{key:"name",label:$t("contact.props.name"),sort:"name"},{key:"user",label:$t("user.user")},{key:"segments",label:$t("contact.segment.segments")},{key:"createdAt",label:$t("general.created_at"),sort:"created_at",transformer:"date",thClass:"d-none",tdClass:"d-none"},{key:"updatedAt",label:$t("general.updated_at"),sort:"updated_at",transformer:"date",thClass:"d-none",tdClass:"d-none"},{key:"actions",label:"",cantHide:!0,tdClass:"actions-dropdown-wrapper"}],preRequisite:{segments:[]},filtersOptions:{name:"",email:"",tags:""},permissionsRequired:"access-contact",routesRequired:{add:"appContactAdd",import:"appContactImport"},initUrl:"contacts",dataType:"contact",tagsUrl:"contacts/segment",refreshAfterTagsApplied:!0}},mounted(){this.getInitialData()}};var $=function(){var t=this,e=t._self._c;return e("div",{staticClass:"entity-list-container"},[e("collapse-transition",{attrs:{group:!0,duration:300,tag:"div"}},[t.showFilters?e("filter-form",{key:"filters",attrs:{boxed:!0,"pre-requisite":t.preRequisite,"is-loading":t.isLoading},on:{close:t.toggleFilter}}):t._e(),e("base-container",{key:"list",staticClass:"p-0",attrs:{boxed:"","with-loader":"","is-loading":t.isLoading,"loader-color":t.vars.loaderColor}},[t.isInitialized?e("table-wrapper",{attrs:{meta:t.entities.meta,filtered:t.isFiltered,"add-button-route":"appContactAdd","add-button-permissions":["access-contact"],"entity-title":"contact.contact","entities-title":"contact.contacts","entity-description":"contact.module_description"}},[e("b-table",{directives:[{name:"show",rawName:"v-show",value:t.entities.meta.total,expression:"entities.meta.total"}],ref:"btable",attrs:{items:t.itemsProvider,fields:t.fields,busy:t.isLoading,hover:"",striped:"",stacked:"sm","per-page":t.entities.meta.perPage,"current-page":t.entities.meta.currentPage,filters:null},on:{"update:busy":function(s){t.isLoading=s}},scopedSlots:t._u([{key:"head(select)",fn:function(s){return[e("base-checkbox",{attrs:{"click-stop":!0},model:{value:t.selectAllRows,callback:function(a){t.selectAllRows=a},expression:"selectAllRows"}})]}},{key:"cell(select)",fn:function(s){return[e("base-checkbox",{attrs:{"click-stop":!0,value:s.item.uuid},model:{value:t.selectedRows,callback:function(a){t.selectedRows=a},expression:"selectedRows"}})]}},{key:"cell(createdAt)",fn:function(s){return[e("view-date",{staticClass:"mb-0",attrs:{value:s.item.createdAt,"with-tz":"",tag:"span"}})]}},{key:"cell(updatedAt)",fn:function(s){return[e("view-date",{staticClass:"mb-0",attrs:{value:s.item.updatedAt,"with-tz":"",tag:"span"}})]}},{key:"cell(segments)",fn:function(s){return[s.item.segments.length<3?e("view-list",{staticClass:"mb-0",attrs:{value:s.item.segments,type:"badge","badge-type":"dark"}}):[e("view-list",{staticClass:"mb-0",attrs:{value:s.item.segments,type:"badge","badge-type":"dark",limit:2},scopedSlots:t._u([{key:"addOnRight",fn:function(){return[e("badge",{staticClass:"mb-0",attrs:{type:"light"}},[t._v("+ "+t._s(s.item.segments.length-2)+" "+t._s(t.$t("contact.segment.segments")))])]},proxy:!0}],null,!0)})]]}},{key:"cell(user)",fn:function(s){return[s.item.user?e("router-link",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn btn-sm btn-light",attrs:{to:{name:"appUserView",params:{uuid:s.item.user.uuid}},title:t.$t("global.view",{attribute:t.$t("user.user")})}},[e("i",{staticClass:"fas fa-user"})]):t._e()]}},{key:"cell(actions)",fn:function(s){return[e("table-row-actions",[t.hasPermission("access-contact")?e("router-link",{staticClass:"dropdown-item",attrs:{to:{name:"appContactEdit",params:{uuid:s.item.uuid}}}},[e("i",{staticClass:"fas fa-edit"}),t._v(" "+t._s(t.$t("global.edit",{attribute:t.$t("contact.contact")})))]):t._e(),t.hasPermission("access-contact")?e("a",{staticClass:"dropdown-item",on:{click:function(a){return a.stopPropagation(),t.deleteEntity(s.item)}}},[e("i",{staticClass:"fas fa-trash"}),t._v(" "+t._s(t.$t("global.delete",{attribute:t.$t("contact.contact")})))]):t._e()],1)]}}],null,!1,1797693651)})],1):t._e()],1),t.showTagsForm&&t.hasPermission("access-contact")?e("segments-form",{key:"segments-form",attrs:{"selected-rows":t.selectedRows,"pre-requisite":t.preRequisite,"form-errors":t.formErrors,"is-loading":t.isLoading},on:{cancel:function(s){t.selectedRows=[]},submit:t.applyTags}}):t._e()],1)],1)},k=[],w=r(h,$,k,!1,null,null,null,null);const O=w.exports;export{O as default};
