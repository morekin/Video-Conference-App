import{m as j,i as U,d as A}from"../../../vendor/vendor-core.3574f8d9.js";import{g as I}from"../../../meeting-configs.8da2e942.js";import{s as v}from"../../../vendor/vendor-screenfull.9a79c0ca.js";import{u as H,R as D,g as N,l as q,d as z,A as G,F as J,L as Q}from"../../../live-poll.20e74c5f.js";import{s as W,l as K}from"../../../index.d951cdc8.js";import{g as Y,c as E,p as Z,s as X}from"../../../media.60d422e2.js";import{a as F,S as p,q as b,t as $,d as x,v as ee,b as k,w as te,x as O,g as R,f as ie,A as se}from"../../../app.a373aa59.js";import"../../../vendor/vendor-essential.91b5cfa2.js";import{n as S,d as T}from"../../../momentz.ae4aeebe.js";import{J as C}from"../../../vendor/vendor-others.c8ba1624.js";import{u as V}from"../../../uploader.da0c2632.js";import{L as ae}from"../../../logger.45fb8d96.js";import{c as ne}from"../../../auth.4cd43863.js";import"../../../event-bus.6a5776a8.js";import{A as oe}from"../../../AppLogo.91541531.js";import{n as re}from"../../../_plugin-vue2_normalizer.7b9a2fe2.js";import"../../../form.90751a24.js";import"../../../header.43f859fb.js";import"../../../FileUploader.78ddb8c0.js";import"../../../vendor/vendor-laravel-echo.aae8cf55.js";import"../../../vendor/vendor-pusher-js.7eab09ad.js";import"../../../vendor/vendor-bootstrap-vue.17129278.js";import"../../../vendor/vendor-vue-gtag.f8884558.js";const o=new ae,le=H(),B={},de={width:{max:3840,ideal:1280,min:320},height:{max:2160,ideal:720,min:180}};let u=null,L=null;const ce={components:{},data(){return{initUrl:"meetings",fallBackRoute:"appMeetingList",statusMessage:"",recordingStatus:"",requestAccessStatus:"",uuid:null,prevRoute:null,meeting:{type:{},category:{},config:{},user:{},attachments:[],uuid:null,title:null,identifier:null,isHost:!1,isInstantMeeting:!1,isMeetingRoom:!1,accessibleViaLink:!1,isPam:!1,isPaid:!1,keepAlive:!1,hasEvent:!1,eventUuid:null,shouldRemind:!1,agenda:null,cover:null,description:null,startDateTime:null,period:null,plannedStartDateTime:null,hasSnapshots:!1,hasRecordings:!1,hasChunkRecordings:!1,hasTranscripts:!1,maxParticipantCount:1e3,accessibleToMembers:!1,delayed:!1,status:"scheduled",cancellationReason:null,startedAt:null,endedAt:null,estimatedEndTime:null,canModerate:!1,isBlocked:!1},meetingBackup:{},preRequisites:{},eventHandlerFns:{},pageConfigs:{autoHideFooter:!1,backgroundBlur:!1,mirroredVideo:!1},pageQueries:{callType:"",autoStart:!1,muteCamera:!1,muteMicrophone:!1,iframe:!1},meetingConfigs:{...I(),debugMode:!1,forceTurn:!1,canToggleAudio:!0,canToggleVideo:!0,lastLayout:"fullpage",recordingFormatAudio:"audio/webm",recordingFormatVideo:"video/webm",recordingTimeSlice:5e3,endTimeSnoozePeriod:1},meetingConfigsFormData:{},meetingConfigsPreRequisite:{rtcLibraries:[{uuid:"rtcmc",label:"RTCMC"}],visibilityOptions:[{uuid:"everyone",label:$t("meeting.config.everyone")},{uuid:"meeting_group_and_participants",label:$t("meeting.config.meeting_group_and_participants")},{uuid:"meeting_group",label:$t("meeting.config.meeting_group")}]},meetingRules:{sendAudio:!0,sendVideo:!0,receiveAudio:!0,receiveVideo:!0},mediaConstraints:{audio:!0,video:!0},mediaDevices:{cams:[],mics:[],speakers:[],camsLoaded:!1,micsLoaded:!1,hasWebcam:!1,hasMicrophone:!1,hasSpeaker:!1,hasWebcamPermission:!1,hasMicrophonePermission:!1,resolutions:[{uuid:"ld180p",label:"180p",constraints:{width:320,height:180,aspectRatio:1.7777777778}},{uuid:"ld240p",label:"QVGA",constraints:{width:320,height:240}},{uuid:"sd360p",label:"360p",constraints:{width:640,height:360,aspectRatio:1.7777777778}},{uuid:"sd480p",label:"VGA",constraints:{width:640,height:480}},{uuid:"sd600p",label:"SVGA",constraints:{width:800,height:600}},{uuid:"hd720p",label:"HD",constraints:{width:1280,height:720,aspectRatio:1.7777777778}},{uuid:"fhd1080p",label:"FHD",constraints:{width:1920,height:1080,aspectRatio:1.7777777778}},{uuid:"4k",label:"4K",constraints:{width:3840,height:2160,aspectRatio:1.7777777778}}]},selectedDevices:{cam:null,mic:null,speaker:null,enableCamera:!0,enableMicrophone:!0,videoMuted:!1,audioMuted:!1,facingMode:null,camDirection:"user",resolution:null},recordingConfigs:{type:"video",mimeType:"video/webm",timeSlice:5e3,disableLogs:!1},feedsList:[],membersLive:[],liveParticipants:[],polls:[],recordedFilesToUpload:[],snoozeOpts:[{uuid:5,name:5,type:"m"},{uuid:10,name:10,type:"m"},{uuid:15,name:15,type:"m"},{uuid:30,name:30,type:"m"},{uuid:60,name:1,type:"h"}],feedsCount:0,participantsCount:0,numberOfBroadcastViewers:0,recordingDuration:0,meetingDuration:0,isLoading:!1,isSidebarLoading:!1,isWhiteboardLoading:!1,isSilentLoading:!1,isMeetingConfigsLoading:!1,isPollsLoading:!1,isRoomOnline:!1,isMeetingLive:!1,isHandUp:!1,isSpeaking:!1,isFocused:!1,isLayoutCompact:!1,isOffline:!1,hasGreenroom:!0,greenroomStarted:!1,showParticipantsList:!1,showPollsList:!1,showPollForm:!1,showLivePoll:!1,showBulkActions:!1,showFileSharing:!1,showWhiteboard:!1,showMeetingInfo:!1,showMeetingConfigs:!1,showAgenda:!1,showFlipClock:!0,localStream:null,localBlurredStream:null,localScreenStream:null,localWhiteboardStream:null,canvasDesigner:null,autoEndingToast:null,fileSharingConnection:null,recorder:null,selectedPoll:null,livePoll:null,afterSessionIsCreated:null,canvasDesignerFilesLoaded:!1,duplicateTab:!1,hasNativeShare:!!navigator.share,stopNavigation:!1,stopNavigationMessage:"",defaultConfigs:{},defaultUser:{uuid:"",username:"",name:"",profile:{name:"",avatar:"",cover:""}}}},computed:{...j("config",["configs","uiConfigs","vars"]),user(){return this.defaultUser},startDateTimeIsFuture(){const t=this.meeting&&this.showFlipClock&&this.isStartDateTimeInFuture();return t?this.startCountDown():window.countdownInterval&&clearInterval(window.countdownInterval),t},liveMembersCount(){return this.membersLive.length-1},allFeedsCount(){const t=this.localStream?1:this.meeting.type.uuid==="webinar"||this.meeting.type.uuid==="podcast"?0:1;return this.feedsCount+t+(this.localScreenStream?1:0)+(this.localWhiteboardStream?1:0)}},watch:{},methods:{...U("config",["GetConfig","SetUiConfig"]),...U("common",["Init","Get","Custom","GetPreRequisite"]),configPageUrl(){return this.$router.resolve({name:"appMeetingSingleConfig",params:{subUuid:this.uuid}}).href},snapshotsPageUrl(){return this.$router.resolve({name:"appMeetingSnapshots",params:{uuid:this.uuid}}).href},recordingsPageUrl(){return this.$router.resolve({name:"appMeetingRecordings",params:{uuid:this.uuid}}).href},toggleFullScreen(){v.isEnabled&&(v.isFullscreen?v.exit():v.request())},toggleFooterAutoHide(){this.pageConfigs.autoHideFooter=!this.pageConfigs.autoHideFooter,this.$gaEvent("engagement","toggleAutoHideFooter")},toggleBackgroundBlur(){this.$gaEvent("engagement","toggleBackgroundBlur"),this.pageConfigs.backgroundBlur?this.unblurLocalStream():this.blurLocalStream()},toggleLayout(t){this.meetingConfigs.layout=t||this.meetingConfigs.layout,this.meetingConfigs.lastLayout=this.meetingConfigs.layout,this.meetingConfigs.layout!=="grid"&&(this.isLayoutCompact=!1,this.changeFocus()),F(`${this.vars.localStorageKey}_selected_layout`,this.meetingConfigs.layout),this.$gaEvent("engagement","toggleLayout",t)},toggleAllSidebarFalse(){this.showAgenda=!1,this.showBulkActions=!1,this.showParticipantsList=!1,this.showFileSharing=!1,this.showPollsList=!1},toggleFileSharing(){const t=this.showFileSharing;this.toggleAllSidebarFalse(),this.showFileSharing=!t,this.$gaEvent("engagement","toggleFileSharing")},toggleAgenda(){const t=this.showAgenda;this.toggleAllSidebarFalse(),this.showAgenda=!t,this.$gaEvent("engagement","toggleAgenda")},toggleMeetingConfig(){const t=this.showMeetingConfigs;this.toggleAllSidebarFalse(),t?(this.showMeetingConfigs=!1,Object.assign(this.meetingConfigsFormData,this.meetingConfigs)):(this.isMeetingConfigsLoading=!0,Object.assign(this.meetingConfigsFormData,this.meetingConfigs),this.$nextTick(()=>{this.showMeetingConfigs=!0}),window.setTimeout(()=>{this.isMeetingConfigsLoading=!1},1e3)),this.$gaEvent("engagement","toggleMeetingConfig")},toggleBulkActions(){const t=this.showBulkActions;this.toggleAllSidebarFalse(),this.showBulkActions=!t,this.$gaEvent("engagement","toggleBulkActions")},toggleParticipantsList(){const t=this.showParticipantsList;this.toggleAllSidebarFalse(),this.showParticipantsList=!t,this.$gaEvent("engagement","toggleParticipantsList")},togglePollsList(){const t=this.showPollsList;this.toggleAllSidebarFalse(),this.showPollsList=!t,this.showPollsList&&this.getPolls(),this.$gaEvent("engagement","togglePollsList")},toggleLivePoll(t){if(o.log("toggleLivePoll called",t),window.showLivePollTimer&&(clearTimeout(window.showLivePollTimer),window.showLivePollTimer=null),this.toggleAllSidebarFalse(),this.$gaEvent("engagement","toggleLivePoll"),t&&t.isResult){this.livePoll=t,window.setTimeout(()=>{this.showLivePoll=!0},1e3);return}if(t=this.isPollLive(t),this.showLivePoll||!t){this.showLivePoll=!1,window.setTimeout(()=>{this.livePoll=null},1e3);return}this.livePoll=t,window.setTimeout(()=>{const e=moment.utc(t.endAt,this.vars.serverDateTimeFormat),i=S({moment:!0,format:this.vars.serverDateTimeFormat}),s=((e.valueOf()-i.valueOf())/1e3).toFixed(0);if(s<=0){this.showLivePoll=!1,this.livePoll=null;return}this.showLivePoll=!0,o.log("Live poll will be closed in (seconds)",s),window.showLivePollTimer=window.setTimeout(()=>{this.toggleLivePoll()},1e3*s)},1e3)},toggleMeetingInfo(){this.showMeetingInfo=!this.showMeetingInfo,this.$gaEvent("engagement","toggleMeetingInfo")},toggleCompactLayout(){this.isLayoutCompact=!this.isLayoutCompact,this.$gaEvent("engagement","toggleCompactLayout")},toggleWhiteboard(){this.$gaEvent("engagement","toggleWhiteboard"),this.showWhiteboard?(this.meetingConfigs.layout=this.meetingConfigs.lastLayout,this.showWhiteboard=!1):(this.canvasDesigner||this.captureWhiteboardStream(),this.meetingConfigs.lastLayout=this.meetingConfigs.layout,this.meetingConfigs.layout="grid",this.showWhiteboard=!0)},stopWhiteboard(){formUtil.confirmAction().then(t=>{t.value?(this.meetingConfigs.layout=this.meetingConfigs.lastLayout,this.showWhiteboard=!1,this.destroyWhiteboard()):(t.dismiss,p.DismissReason.cancel)})},toggleBackgroundSize(t){const e=t.target;e.classList.contains("background-size-contain")?e.classList.remove("background-size-contain"):e.classList.add("background-size-contain")},toggleObjectFit(t){let e=null;if(t==="localStreamElement"&&this.$refs.localStreamElement){e=this.$refs.localStreamElement.parentElement,Array.from(e.children).forEach(i=>{i.classList.contains("object-fit-contain")?i.classList.remove("object-fit-contain"):i.classList.add("object-fit-contain")});return}else if(t==="localScreenStreamElement"&&this.$refs.localScreenStreamElement)e=this.$refs.localScreenStreamElement;else if(t==="localWhiteboardStreamElement"&&this.$refs.localWhiteboardStreamElement)e=this.$refs.localWhiteboardStreamElement;else if(this.feedsList.length&&t&&_.isObject(t)){const i=this.$refs.feedsElements.find(a=>a.id===t.key);if(!i)return;const s=i.getElementsByClassName(`${t.key}-video`)[0];if(!s)return;e=s}e&&(e.classList.contains("object-fit-contain")?e.classList.remove("object-fit-contain"):e.classList.add("object-fit-contain"))},changeFocus(t){if(o.log("on changeFocus",t),!!this.feedsList.length)if(this.isFocused=!1,this.feedsList.forEach(e=>{e.isFocused=!1}),t)if(this.meetingConfigs.layout==="grid"&&(this.meetingConfigs.layout="gallery"),_.isObject(t)){const e=this.feedsList.findIndex(i=>i.key===t.key);this.feedsList[e].isFocused=!0}else this.isFocused=t;else this.feedsList[0].isFocused=!0},share(){this.shareURL(null,!0)},shareURL(t,e=!1){if(!this.meeting)return;this.isLoading=!0,this.$gaEvent("engagement","shareURL","Shown");let i=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");i=i+(this.meeting.identifier?`/m/${this.meeting.identifier}`:`/app/live/meetings/${this.meeting.uuid}`);const s=this.meeting.identifier?`<span class="text-nowrap">${$t("meeting.meeting_code")}:</span> <strong class="ml-2 text-wrap-pre-line text-word-break-all"> ${this.meeting.identifier}</strong>`:null,a=(n=`${$t("misc.share_alert.text")}<br><small class='text-muted'>${i}</small><br>`,r)=>{X({title:$t("meeting.user_inviting_msg",{attribute:this.user.name}),file:r?{dataUrl:r,name:"meeting.png"}:null,alertTitle:s,alertHtml:n,url:i},()=>{this.$gaEvent("engagement","shareURL","Copied"),this.$toasted.success($t("meeting.url_has_been_copied"),this.$toastConfig)},e)};Y({data:i,icon:this.configs.assets.iconMaskable,success:n=>{!this.isLoading||(this.isLoading=!1,window.shareShownConfirmTimer&&(clearTimeout(window.shareShownConfirmTimer),window.shareShownConfirmTimer=null),a(`<img class='img-thumbnail' src='${n}'/><br><br>${$t("misc.share_alert.text")}<br><small class='text-muted'>${i}</small><br>`,n))},error:()=>{!this.isLoading||(this.isLoading=!1,window.shareShownConfirmTimer&&(clearTimeout(window.shareShownConfirmTimer),window.shareShownConfirmTimer=null),a())}}),window.shareShownConfirmTimer=window.setTimeout(()=>{this.isLoading&&(this.isLoading=!1,a())},5e3)},toggleHandUp(){this.$gaEvent("engagement","toggleHandUp"),window.lowerHandTimer&&(clearTimeout(window.lowerHandTimer),window.lowerHandTimer=null),(this.meetingRules.sendAudio||this.meetingRules.sendVideo)&&(this.isHandUp=!this.isHandUp,u.sendMessage({event:"remoteHandToggled",data:{id:this.localStream?this.localStream.id:null,userUuid:this.user.uuid,isHandUp:this.isHandUp}}),this.isHandUp&&(window.lowerHandTimer=window.setTimeout(()=>{this.toggleHandUp()},3e4)))},takeSnapshotOfStream(t,e=!1){if(!this.meetingConfigs.canTakeSnapshot)return;this.$gaEvent("engagement","takeSnapshot");let i=null,s=`${this.user.username} stream by self`,a=!1;if(e){if(i=this.$refs[t],!i)return;a=t==="localScreenStreamElement"||t==="localWhiteboardStreamElement"?!1:this.pageConfigs.mirroredVideo}else{const r=this.$refs.feedsElements.find(d=>d.id===t.key);if(!r)return;i=r.getElementsByClassName(`${t.key}-video`)[0],s=`${t.user.username} stream by ${this.user.username}`,a=t.mirroredVideo}const n=this.takeSnapshot(i,a);if(E(),this.meeting.canModerate||this.meetingConfigs.anyoneCanTakeSnapshot)this.meetingAction({action:"snapshots",loaderVar:"isSilentLoading",method:"post",data:{image:n,name:s},callback:r=>{this.$toasted.info($t("meeting.snapshot_taken"),{...this.$toastConfig.info,duration:1e4,icon:{name:"fa-download"},action:{text:"View / Download",href:r.fullUrl,target:"_blank"}}),this.isSilentLoading=!1}}),this.informAboutSnapshot(t);else if(e){const r=new Image;r.src=n,window.open("").document.write(r.outerHTML)}},takeSnapshot(t,e){let i=document.createElement("canvas");i.id="snapshotCanvas";let s=null,a=i.getContext("2d");const n=()=>{const r=(t.videoWidth||t.clientWidth)/(t.videoHeight||t.clientHeight),d=t.videoWidth-100,l=parseInt(d/r,10);i.width=d*2,i.height=l*2,e&&(a.translate(i.width,0),a.scale(-1,1))};return n(),a.drawImage(t,0,0,i.width,i.height),s=i.toDataURL("image/png"),t.srcObject,this.eventHandlerFns.loadedmetadataFn=()=>{n(),a.drawImage(t,0,0,i.width,i.height),s=i.toDataURL("image/png")},t.addEventListener("loadedmetadata",this.eventHandlerFns.loadedmetadataFn),window.setTimeout(()=>{t.removeEventListener("loadedmetadata",this.eventHandlerFns.loadedmetadataFn),this.eventHandlerFns.loadedmetadataFn=null,i=null},1e3),s},banRemoteUser(t){!this.feedsList.length||!t||(formUtil.confirmAction().then(e=>{e.value?this.feedsList.find(s=>s.key===t.key)&&(u.sendMessage({event:"userBanned",data:t}),this.Custom({url:`/${this.initUrl}/${this.uuid}/invitees/${t.user.uuid}/block`,method:"post"}).then(s=>{this.$toasted.success(s.message,this.$toastConfig)}).catch(s=>{o.error("error: ",s),formUtil.handleErrors(s)})):(e.dismiss,p.DismissReason.cancel)}),_.isObject(t)?this.feedsList[selectedIndex].isFocused=!0:this.isFocused=t)},toggleRemoteAVSource(t,e="audio",i="temporary",s=!1){if(!this.feedsList.length||!e)return;if(!t){this.showBulkActions=!1,i==="permanent"&&((!e||e==="both"||e==="audio")&&this.feedsList.forEach(n=>{n.canToggleAudio=s}),(!e||e==="both"||e==="video")&&this.feedsList.forEach(n=>{n.canToggleVideo=s})),u.sendMessage({event:"toggleRemoteAV",data:{userUuid:"all",target:e,type:i,enable:s},callback:()=>{this.$toasted.success($t("meeting.action_successful"),this.$toastConfig)}});return}const a=this.feedsList.findIndex(n=>n.key===t.key);a!==-1&&(i==="permanent"&&((!e||e==="both"||e==="audio")&&(this.feedsList[a].canToggleAudio=s),(!e||e==="both"||e==="video")&&(this.feedsList[a].canToggleVideo=s)),u.sendMessage({event:"toggleRemoteAV",data:{userUuid:t.user.uuid,target:e,type:i,enable:s},callback:()=>{this.$toasted.success($t("meeting.action_successful"),this.$toastConfig)}}))},informAboutSnapshot(t){this.meetingConfigs.enableSnapshotAlert&&u.sendMessage({event:"snapshotTaken",data:{byUser:this.user,ofUser:t.extra,item:t}})},informAboutMeetingUpdate(t){!this.meeting.canModerate||u.sendMessage({event:"meetingUpdated",data:t})},isStartDateTimeInFuture(){var t;return!!(((t=this.meeting)==null?void 0:t.startDateTime)&&moment.utc(this.meeting.startDateTime,this.vars.serverDateTimeFormat).isAfter(S({moment:!0,format:this.vars.serverDateTimeFormat})))},startCountDown(){window.countdownInterval&&clearInterval(window.countdownInterval),window.countdownInterval=window.setInterval(()=>{this.isStartDateTimeInFuture()?this.showFlipClock=!0:(this.showFlipClock&&!document.hasFocus()&&Z(),this.showFlipClock=!1)},1e3)},stopAutoEndMeeting(){window.autoEndMeetingTimeout&&(clearTimeout(window.autoEndMeetingTimeout),window.autoEndMeetingTimeout=null),this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(b.close(),this.autoEndingToast=null)},startAutoEndMeeting(t=300){window.autoEndMeetingTimeout&&(clearTimeout(window.autoEndMeetingTimeout),window.autoEndMeetingTimeout=null),window.autoEndMeetingTimeout=window.setTimeout(()=>{this.meeting.canModerate?this.endMeeting(!1):this.getOffline(!1)},1e3*t)},startMeetingTimer(){if(window.meetingDurationInterval&&(this.meetingDuration=null,clearInterval(window.meetingDurationInterval)),!this.meeting||this.meeting.status!=="live")return;const t=()=>{if(!this.meeting||this.meeting.status!=="live"){this.stopAutoEndMeeting(),this.stopMeetingTimer();return}if(this.meetingConfigs.autoEndMeeting&&this.meeting.estimatedEndTime){const i=this.meetingConfigs.alertBeforeAutoEndTime||5,s=moment.utc(this.meeting.estimatedEndTime,this.vars.serverDateTimeFormat),a=S({moment:!0,format:this.vars.serverDateTimeFormat}),n=((s.valueOf()-a.valueOf())/1e3).toFixed(0);if(n<=0)window.autoEndMeetingTimeout&&(clearInterval(window.autoEndMeetingTimeout),window.autoEndMeetingTimeout=null),this.meeting.canModerate?this.endMeeting(!1):this.getOffline(!1);else if(n<=i*60){let r=$(n)+" "+$t("list.general.durations.seconds");if(n>=60?r=$(n)+" "+$t("list.general.durations.minutes"):n>=3600&&(r=$(n)+" "+$t("list.general.durations.hours")),this.meetingConfigs.alertBeforeAutoEnd)if(window.autoEndMeetingTimeout&&this.autoEndingToast&&p.isVisible()&&p.isTimerRunning())b.update({title:$t("meeting.auto_ending_msg",{attribute:r})});else{if(!this.autoEndingToast&&p.isVisible())return;if(this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(b.close(),this.autoEndingToast=null),this.meeting.canModerate){let d={iconHtml:'<i class="far fa-clock"></i>',title:$t("meeting.auto_ending_msg",{attribute:r}),timer:n*1e3,showConfirmButton:!1,showDenyButton:!1,position:"bottom"};this.meetingConfigs.canSnoozeAutoEnd&&(d.showConfirmButton=!0,d.confirmButtonText=$t("meeting.snooze")),this.meetingConfigs.canCancelAutoEnd&&(d.showDenyButton=!0,d.denyButtonText=$t("meeting.keep_meeting_live")),this.autoEndingToast=b.fire(d).then(l=>{l.isConfirmed&&this.meetingConfigs.canSnoozeAutoEnd?(this.stopAutoEndMeeting(),this.meeting.estimatedEndTime=moment.utc(this.meeting.estimatedEndTime,this.vars.serverDateTimeFormat).add(10,"minutes").format(this.vars.serverDateTimeFormat),this.meetingAction("snooze-end-time",{period:this.meetingConfigs.endTimeSnoozePeriod||5},{alert:!1,inform:{endTimeSnoozed:!0}}),b.close(),this.autoEndingToast=null):l.isDenied&&this.meetingConfigs.canCancelAutoEnd&&(this.stopAutoEndMeeting(),this.meetingConfigs.autoEndMeeting=!1,this.meetingAction("cancel-auto-end",null,{alert:!1,inform:{autoEndCancelled:!0}}),b.close(),this.autoEndingToast=null)})}else this.autoEndingToast=b.fire({iconHtml:'<i class="far fa-clock"></i>',title:$t("meeting.auto_ending_msg",{attribute:r}),timer:n*1e3,showConfirmButton:!1,position:"bottom"})}window.autoEndMeetingTimeout&&this.autoEndingToast||(this.stopAutoEndMeeting(),this.startAutoEndMeeting(n))}else n>i*60?this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(b.close(),this.autoEndingToast=null):this.stopAutoEndMeeting()}},e=moment.utc(this.meeting.startedAt,this.vars.serverDateTimeFormat).valueOf();window.meetingDurationInterval=window.setInterval(()=>{const i=S({moment:!0,format:this.vars.serverDateTimeFormat}).valueOf();this.meetingDuration=$((i-e)/1e3),this.pageQueries.iframe||this.pageQueries.autoStart||this.pageQueries.callType||t()},1e3)},stopMeetingTimer(){window.meetingDurationInterval&&(this.meetingDuration=null,clearInterval(window.meetingDurationInterval))},reportAnIssue(){const t={meeting:this.meeting,meetingRules:this.meetingRules,meetingConfigs:this.meetingConfigs,pageConfigs:this.pageConfigs,mediaConstraints:this.mediaConstraints,mediaDevices:this.mediaDevices,selectedDevices:this.selectedDevices,feedsList:this.feedsList,DetectRTC:B};this.meeting.canModerate?(o.log(t),x('"'+JSON.stringify(t)+'"')):x('"'+window.btoa(JSON.stringify(t))+'"'),this.$toasted.success($t("general.report_an_issue_success"),this.$toastConfig)},editPoll(t){this.selectedPoll=t,this.showPollForm=!0},closePollForm(){this.showPollForm=!1,this.selectedPoll=null,this.getPolls()},isPollLive(t){return t&&t.isPublished&&t.startAt&&(t.startAt=T(t.startAt,this.vars.serverDateTimeFormat),t.endAt=t.endAt?T(t.endAt,this.vars.serverDateTimeFormat):T(moment(t.startAt,this.vars.serverDateTimeFormat).add(t.duration,"seconds"),this.vars.serverDateTimeFormat),!!moment.utc(t.endAt,this.vars.serverDateTimeFormat).isAfter(S({moment:!0,format:this.vars.serverDateTimeFormat})))?t:!1},anyLivePoll(){o.log("anyLivePoll called",this.polls);const t=this.polls[0];t&&t.isPublished&&!t.isResult&&this.toggleLivePoll(t)},showPollResult(t){!t||(t.options.forEach((e,i)=>{if(t.result){const s=t.result.find(a=>a.uuid===e.uuid);Object.assign(t.options[i],s)}t.correctAnswer&&e.uuid===t.correctAnswer.uuid&&(t.options[i].selected=!0),t.submittedAnswer&&e.uuid===t.submittedAnswer.uuid&&(t.options[i].answered=!0)}),this.toggleLivePoll(t))},addStreamToRecord(t){if(!(this.meetingConfigs.canRecord&&this.meeting.canModerate&&this.recordingStatus==="started"&&t)||this.meetingConfigs.rtcLibrary==="janus")return;const e=this.recorder;if(e){const i=e.getInternalRecorder();i&&i.addStreams(t)}},startRecording(t,e=null){if(this.$gaEvent("engagement","startRecording"),!(this.meetingConfigs.canRecord&&this.meeting.canModerate))return;this.recordingStatus="started",this.recordingConfigs.disableLogs=!this.meetingConfigs.debugMode;const i=()=>{const l=new Date().getTime();window.recordingDurationInterval&&(this.recordingDuration=null,clearInterval(window.recordingDurationInterval)),window.recordingDurationInterval=window.setInterval(()=>{this.recordingDuration=$((new Date().getTime()-l)/1e3)},1e3)};if(this.meetingConfigs.rtcLibrary==="janus")return;let s=this.recorder;if(s)return;let a=[],n=[];const r=uuid();u.getAllStreams().forEach(l=>{a.push(l.stream)});const d=this.getLocalStreamToPublish();d.stream&&a.push(d.stream),this.localScreenStream&&a.push(this.localScreenStream),this.localWhiteboardStream&&a.push(this.localWhiteboardStream),this.meetingConfigs.autoUploadRecording&&(this.recordingConfigs.ondataavailable=l=>{n.push(l),this.uploadRecording({uuid:r,chunk:!0,blob:l,order:n.length})}),s=D(a,this.recordingConfigs),this.recorder=s,s.startRecording(),i()},pauseRecording(){if(this.$gaEvent("engagement","pauseRecording"),this.meetingConfigs.rtcLibrary==="janus")return;const t=this.recorder;if(!t){this.$toasted.error("No recorder found!",this.$toastConfig.error);return}this.recordingStatus="paused",t.pauseRecording(),window.recordingDurationInterval&&clearInterval(window.recordingDurationInterval)},resumeRecording(){this.$gaEvent("engagement","resumeRecording");const t=this.recorder;if(!t){this.$toasted.error("No recorder found!",this.$toastConfig.error);return}this.recordingStatus="started",t.resumeRecording();const e=new Date().getTime(),i=ee(this.recordingDuration||"00:00");window.recordingDurationInterval&&clearInterval(window.recordingDurationInterval),window.recordingDurationInterval=window.setInterval(()=>{this.recordingDuration=$(i+(new Date().getTime()-e)/1e3)},1e3)},stopRecording(){if(this.$gaEvent("engagement","stopRecording"),this.meetingConfigs.rtcLibrary==="janus")return;this.checkPendingUploads();const t=this.recorder;if(!t){this.$toasted.error("No recorder found!",this.$toastConfig.error);return}this.recordingStatus="ended",t.stopRecording(()=>{window.recordingDurationInterval&&(this.recordingDuration=null,clearInterval(window.recordingDurationInterval),window.recordingDurationInterval=null);const e=($t("meeting.meeting_recording")+"-"+S({moment:!0,format:this.vars.serverDateTimeFormat}).unix()).kebabCase()+".webm";D.getSeekableBlob(t.getBlob(),i=>{this.checkPendingUploads(),this.meetingConfigs.autoUploadRecording?(t.reset(),this.recorder=null):this.meetingConfigs.autoUploadRecorded?this.uploadRecorded(i,t,e):k.fire({title:$t("meeting.recorded_meeting"),allowOutsideClick:!1,allowEscapeKey:!1,position:"bottom",showDenyButton:!0,showCancelButton:!0,confirmButtonText:`<i class="fas fa-download"></i> ${$t("general.download")}`,denyButtonText:`<i class="fas fa-upload"></i> ${$t("general.upload")}`,cancelButtonText:`${$t("general.cancel")}`,customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger",denyButton:"btn btn-primary"}}).then(s=>{if(s.isConfirmed){const a=URL.createObjectURL(i),n=document.createElement("a");D.invokeSaveAsDialog(i,e),n.style.display="none",n.href=a,n.download=e,document.body.appendChild(n),window.setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(n),this.recordingStatus=""},100),t.reset(),this.recorder=null,this.checkPendingUploads()}else if(s.isDenied)this.uploadRecorded(i,t,e),this.checkPendingUploads();else{s.dismiss,p.DismissReason.cancel,t.reset(),this.recorder=null,this.checkPendingUploads();return}}),this.checkPendingUploads()})})},checkPendingUploads:_.throttle(function(){this.recordedFilesToUpload.filter(e=>e.status==="waiting"||e.status==="uploading").length?(this.stopNavigation=!0,this.stopNavigationMessage=$t("meeting.uploads_pending_message")):(this.stopNavigation=!1,this.stopNavigationMessage=""),this.uploadRecording()},500,{leading:!0,trailing:!1}),uploadRecording(t){const e=_.throttle(()=>{const s=this.recordedFilesToUpload.filter(n=>n.status==="waiting"&&n.chunk),a=this.recordedFilesToUpload.filter(n=>n.status==="uploading"&&n.chunk);if(s.length){let n=[];const r=A.CancelToken;let l=5-a.length;for(let g=this.recordedFilesToUpload.length-1;g>=0&&l>0;g--){const c=this.recordedFilesToUpload[g];if(n[g]=h=>{c.progress=Math.round(h.loaded*100/h.total)},c.status==="waiting"){l=l-1;let h=new FormData;h.append("file",c.blob),h.append("mime",c.mime),h.append("request_uuid",c.requestUuid),h.append("order",c.order),h.append("chunk",c.chunk),c.status="uploading";let m=new r(f=>{c.cancel=f});V({url:`/${this.initUrl}/${this.uuid}/recordings`,data:h,silent:!0},n[g],m).then(f=>{c.status="uploaded",delete c.cancel,this.checkPendingUploads(),window.setTimeout(()=>{delete this.recordedFilesToUpload.splice(this.recordedFilesToUpload.findIndex(y=>y.uuid===c.uuid),1),this.checkPendingUploads()},3e3)}).catch(f=>{if(f.response&&f.response.data){const y=f.response.data||{},w=y.errors?formUtil.assignErrors(y.errors):{};c.error=w.message,c.status="error"}else c.status="cancelled";this.checkPendingUploads()})}}}},1e3,{leading:!0,trailing:!1});if(!t||!t.uuid){e();return}const i=($t("meeting.meeting_recording")+"-"+S({moment:!0,format:this.vars.serverDateTimeFormat}).unix()).kebabCase()+".webm";this.recordedFilesToUpload||(this.recordedFilesToUpload=[]),this.recordedFilesToUpload.unshift({uuid:uuid(),chunk:t.chunk,blob:t.blob,mime:t.blob.type,requestUuid:t.uuid,order:t.order,status:"waiting",name:i,progress:0,error:null,download:null}),e(),this.checkPendingUploads()},uploadRecorded(t,e,i){const s=()=>{if(this.recordedFilesToUpload.filter(l=>l.status==="waiting"&&!l.chunk).length){let l=[];const g=A.CancelToken;this.recordedFilesToUpload.forEach((c,h)=>{const m=this.recordedFilesToUpload[h];if(m.download=a,l[h]=f=>{m.progress=Math.round(f.loaded*100/f.total)},m.status==="waiting"){let f=new FormData;f.append("file",m.file),f.append("mime",m.file.type),f.append("request_uuid",m.uuid),m.status="uploading";let y=new g(w=>{m.cancel=w});V({url:`/${this.initUrl}/${this.uuid}/recordings`,data:f,silent:!0},l[h],y).then(w=>{m.status="uploaded",delete m.cancel,this.checkPendingUploads(),window.setTimeout(()=>{delete this.recordedFilesToUpload.splice(this.recordedFilesToUpload.findIndex(M=>M.uuid===m.uuid),1),this.checkPendingUploads()},3e3)}).catch(w=>{if(w.response&&w.response.data){const M=w.response.data||{},P=M.errors?formUtil.assignErrors(M.errors):{};m.error=P.message,m.status="error",this.$toasted.error(P.message,this.$toastConfig.error)}else m.status="cancelled";this.checkPendingUploads()})}})}},a=d=>{const l=URL.createObjectURL(d),g=document.createElement("a");D.invokeSaveAsDialog(d,i),g.style.display="none",g.href=l,g.download=i,document.body.appendChild(g),window.setTimeout(()=>{document.body.removeChild(g),window.URL.revokeObjectURL(g),this.recorded=!1},100)},n=this.recordingConfigs&&this.recordingConfigs.mimeType?this.recordingConfigs.mimeType:"video/webm",r=new File([t],i,{type:n});r.size>this.defaultConfigs.system.postMaxSize?this.$toasted.error(this.$t("global.file_too_large",{attribute:r.name}),this.$toastConfig.error):(this.recordedFilesToUpload||(this.recordedFilesToUpload=[]),this.recordedFilesToUpload.unshift({uuid:uuid(),chunk:!1,blob:t,file:r,status:"waiting",progress:0,error:null}),s()),this.checkPendingUploads(),e.reset(),this.recorder=null},stopStream(t){if(!!t)try{t.getTracks().forEach(e=>{e.enabled=!1,e.stop()})}catch(e){o.error(e)}},captureLocalStream({success:t,failed:e}){var n,r,d;if(F(`${this.vars.localStorageKey}_selected_device`,this.selectedDevices),this.meetingRules.sendVideo||(this.selectedDevices.enableCamera=!1),this.meetingRules.sendAudio||(this.selectedDevices.enableMicrophone=!1),this.mediaConstraints.video=this.selectedDevices.enableCamera,this.mediaConstraints.audio=this.selectedDevices.enableMicrophone,!this.mediaConstraints.video&&!this.mediaConstraints.audio){this.stopStream(this.localStream||((n=this.$refs.localStreamElement)==null?void 0:n.srcObject)),this.localStream=null,this.$refs.localStreamElement&&(this.$refs.localStreamElement.srcObject=null),_.isFunction(t)&&t();return}const i=(r=this.selectedDevices.mic)==null?void 0:r.deviceId,s=(d=this.selectedDevices.cam)==null?void 0:d.deviceId;let a={};if(this.mediaConstraints.audio&&(a.audio={deviceId:i?{exact:i}:void 0}),this.mediaConstraints.video){if(a.video={...de},this.selectedDevices.resolution){const l=this.mediaDevices.resolutions.find(g=>g.uuid===this.selectedDevices.resolution);l&&(a.video.width={exact:l.constraints.width},a.video.height={exact:l.constraints.height})}this.selectedDevices.facingMode?a.video.facingMode={exact:this.selectedDevices.facingMode}:a.video.deviceId=s?{exact:s}:void 0}o.log("captureLocalStream gumConstraints",a),navigator.mediaDevices.getUserMedia(a).then(l=>{var c;const g=this.localStream||((c=this.$refs.localStreamElement)==null?void 0:c.srcObject);return this.localStream=l,window.capturedLocalStream=l,this.$refs.localStreamElement&&(this.$refs.localStreamElement.srcObject=l,this.$refs.localStreamElement.controls=!1),window.setTimeout(()=>{this.stopStream(g)},3e3),_.isFunction(t)&&t(l),l}).catch(l=>{_.isFunction(t)&&e(l),o.error("getUserMedia error: ",l.message,l.name),l.name==="NotFoundError"||l.name==="NotReadableError"?this.$toasted.error($t("meeting.media_devices.not_found_or_unreadable"),this.$toastConfig.error):l.name==="OverconstrainedError"?(this.$toasted.error($t("meeting.media_devices.reset_and_try_again"),this.$toastConfig.error),this.selectedDevices.resolution=null):l.name==="NotAllowedError"||l.name==="PermissionDeniedError"?this.$toasted.error($t("meeting.media_devices.permission_denied"),this.$toastConfig.error):this.$toasted.error($t("meeting.media_devices.unknown_error"),this.$toastConfig.error),te(`${this.vars.localStorageKey}_selected_device`)})},startGreenroom(t={}){o.log("StartGreenroom called!"),this.statusMessage=this.$t("meeting.status_message.connecting"),this.greenroomStarted||this.checkLastSelectedDevices(),this.captureLocalStream({success:(e=null)=>{this.greenroomStarted=!0,this.statusMessage=this.$t("meeting.status_message.ready"),_.isFunction(t.callback)&&t.callback(e)},failed:e=>{o.error(e),this.statusMessage=this.$t("meeting.status_message.failed")}})},updateGreenroom(){this.startGreenroom({callback:(t=null)=>{!this.isMeetingLive||this.localBlurredStream||(this.statusMessage=$t("meeting.status_message.live"),this.updatePublishedFeed({stream:this.localStream,info:{from:"cam",mirroredVideo:this.pageConfigs.mirroredVideo},mediaConstraints:this.mediaConstraints}))}})},toggleLocalCamera(t,e){this.statusMessage=this.$t("meeting.status_message.connecting"),this.localBlurredStream&&!e&&this.unblurLocalStream(),this.selectedDevices.enableCamera=e!=null?e:!this.selectedDevices.enableCamera,this.updateGreenroom()},toggleLocalMicrophone(t,e){this.statusMessage=this.$t("meeting.status_message.connecting"),this.selectedDevices.enableMicrophone=e!=null?e:!this.selectedDevices.enableMicrophone,this.updateGreenroom()},changeLocalVideoDevice(t=null){this.statusMessage=this.$t("meeting.status_message.changing_device"),this.selectedDevices.cam=t,this.selectedDevices.enableCamera=!0,this.selectedDevices.facingMode=null,t.label&&(this.selectedDevices.camDirection=/front/i.test(t.label)?"user":/rear/i.test(t.label)||/back/i.test(t.label)?"environment":null),this.updateGreenroom()},changeLocalVideoResolution(t=null){this.statusMessage=this.$t("meeting.status_message.changing_device"),this.selectedDevices.resolution=this.selectedDevices.resolution===t.uuid?null:t.uuid,this.selectedDevices.enableCamera=!0,this.updateGreenroom()},changeLocalAudioDevice(t=null){this.statusMessage=this.$t("meeting.status_message.changing_device"),this.selectedDevices.mic=t,this.selectedDevices.enableMicrophone=!0,this.updateGreenroom()},switchFacingMode(){this.statusMessage=this.$t("meeting.status_message.changing_device"),this.selectedDevices.cam&&this.selectedDevices.cam.label&&(this.selectedDevices.facingMode=/front/i.test(device.label)?"user":/rear/i.test(device.label)||/back/i.test(device.label)?"environment":null),this.selectedDevices.facingMode=this.selectedDevices.facingMode==="user"?"environment":"user",this.selectedDevices.camDirection=this.selectedDevices.facingMode,this.selectedDevices.cam=null,this.selectedDevices.resolution=null,this.selectedDevices.enableCamera=!0,this.updateGreenroom()},blurLocalStream(){const t=this,e=this.$refs.localStreamElement,i=this.$refs.localBlurredStreamElement;let s=!0;const a=i.getContext("2d");this.pageConfigs.backgroundBlur=!0,(()=>{const c=e.videoWidth||e.clientWidth,h=e.videoHeight||e.clientHeight;e.width=c,e.height=h,i.width=c,i.height=h})(),a.fillStyle="black",a.fillRect(0,0,i.width,i.height),e.addEventListener("playing",c=>{s=!0}),e.addEventListener("emptied",c=>{s=!1}),e.addEventListener("suspend",c=>{s=!1});const r=async()=>{try{N(),L=await q({architecture:"MobileNetV1",multiplier:.75,outputStride:16,quantBytes:2}),this.localBlurredStream=i.captureStream();const c=this.localStream.getAudioTracks()[0];this.localBlurredStream&&c&&(o.log("blurLocalStream - Audio Track added!"),this.localBlurredStream.addTrack(c.clone())),this.isMeetingLive&&this.updatePublishedFeed({stream:this.localBlurredStream,info:{from:"cam",mirroredVideo:!1},mediaConstraints:this.mediaConstraints,action:"blur"}),g(L)}catch(c){o.error(c)}},d=10,l=3,g=async c=>{for(;t.pageConfigs.backgroundBlur&&c&&t.selectedDevices.enableCamera&&s;){const h=await c.segmentPerson(e,{flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:3,scoreThreshold:.2,nmsRadius:20,minKeypointScore:.3,refineSteps:10});z(i,e,h,d,l,t.pageConfigs.mirroredVideo)}t.pageConfigs.backgroundBlur&&c&&t.selectedDevices.enableCamera?window.setTimeout(()=>{g(c)},1e3):this.unblurLocalStream()};r()},unblurLocalStream(){if(this.pageConfigs.backgroundBlur=!1,L&&(L.dispose(),L=null),this.localBlurredStream){const t=this.localBlurredStream;this.localBlurredStream=null,this.isMeetingLive&&this.updateGreenroom(),window.setTimeout(()=>{t.getVideoTracks().forEach(e=>{e.enabled=!1,e.stop()})},1e3)}},captureScreenStream({constraints:t,success:e,failed:i}){this.stopSharingScreen();let s=t||{video:{cursor:"always"},audio:!1};navigator.mediaDevices.getDisplayMedia(s).then(a=>{this.localScreenStream=a,this.$refs.localScreenStreamElement&&(this.$refs.localScreenStreamElement.srcObject=a,this.$refs.localScreenStreamElement.controls=!1),_.isFunction(e)&&e(a)}).catch(a=>{_.isFunction(e)&&i(a),o.log("getDisplayMedia error: ",a.message,a.name)})},shareScreen(){this.captureScreenStream({success:t=>{t.getTracks().forEach(e=>{e.addEventListener("ended",this.stopSharingScreen)}),this.publishFeed({stream:this.localScreenStream,info:{from:"screen",mirroredVideo:!1},callback:()=>{this.addStreamToRecord(this.localScreenStream)}})},failed:t=>{this.statusMessage=this.$t("meeting.status_message.failed")}})},stopSharingScreen(){var e;o.log("stopSharingScreen called");const t=this.localScreenStream||((e=this.$refs.localScreenStreamElement)==null?void 0:e.srcObject);if(!!t){this.updatePublishedFeed({stream:!1,info:{from:"screen",mirroredVideo:!1},action:"remove"});try{t.getTracks().forEach(i=>{i.removeEventListener("ended",this.stopSharingScreen),i.enabled=!1,i.stop()})}catch(i){o.error(i)}this.localScreenStream=null,this.$refs.localScreenStreamElement&&(this.$refs.localScreenStreamElement.srcObject=null)}},captureWhiteboardStream(){this.isWhiteboardLoading=!0,this.canvasDesigner||this.initCanvasDesigner();const t=(s="main-canvas")=>{const a=this.canvasDesigner.iframe;if(!a)return;const n=a.contentDocument?a.contentDocument:a.contentWindow.document;return n?n.getElementById(s):void 0},e=(s=!1)=>{const a=d=>{!d||d.getContext("2d")},n=t();a(n);const r=t("temp-canvas");a(r)},i=s=>{!s||(this.localWhiteboardStream=s,this.$refs.localWhiteboardStreamElement&&(this.$refs.localWhiteboardStreamElement.srcObject=s,this.$refs.localWhiteboardStreamElement.controls=!1),this.meetingConfigs.rtcLibrary==="janus"&&this.localWhiteboardStream.getTracks().forEach(a=>{a.addEventListener("mute",n=>{e(!0)})}),e(),this.publishFeed({stream:this.localWhiteboardStream,info:{from:"whiteboard",mirroredVideo:!1},callback:()=>{window.setTimeout(()=>{e()},2e3),this.addStreamToRecord(this.localWhiteboardStream)}}))};if(!this.$refs.whiteboard||!CanvasDesigner){this.isWhiteboardLoading=!1;return}this.meetingConfigs.whiteboardCollaboration&&this.canvasDesigner.addSyncListener(s=>{u.sendMessage({type:"whiteboard",data:s})}),this.canvasDesigner.setSelected("pencil"),this.canvasDesigner.setTools({pencil:!0,text:!0,image:!0,pdf:!0,eraser:!0,line:!0,arrow:!0,dragSingle:!0,dragMultiple:!0,arc:!0,rectangle:!0,quadratic:!0,bezier:!1,marker:!0,zoom:!1,lineWidth:!0,colorsPicker:!0,extraOptions:!1,code:!1,undo:!0}),this.canvasDesigner.iframe?this.isWhiteboardLoading=!1:this.canvasDesigner.appendTo(this.$refs.whiteboard,()=>{if(e(),this.meetingConfigs.whiteboardCollaboration){if(!this.feedsList.find(a=>a.isWhiteboard)){const a=t();i(a.captureStream(30))}window.setTimeout(()=>{o.log("sync-canvas-points"),u.sendMessage({type:"whiteboard",data:"sync-canvas-points"}),this.isWhiteboardLoading=!1},3e3)}else{const s=t();i(s.captureStream(30)),this.isWhiteboardLoading=!1}})},destroyWhiteboard(){var e;this.canvasDesigner&&(this.canvasDesigner.destroy(),this.canvasDesigner=null);const t=this.localWhiteboardStream||((e=this.$refs.localWhiteboardStreamElement)==null?void 0:e.srcObject);!t||(this.updatePublishedFeed({stream:!1,info:{from:"whiteboard",mirroredVideo:!1},action:"remove"}),this.stopStream(t),this.localWhiteboardStream=null,this.$refs.localWhiteboardStreamElement&&(this.$refs.localWhiteboardStreamElement.srcObject=null))},handlePlay(t){if(!this.feedsList.length||!t)return;const e=this.feedsList.findIndex(i=>i.key===t.key);this.feedsList[e].playing=!0},playStream(t){if(!this.feedsList.length||!t)return;const e=this.feedsList.findIndex(n=>n.key===t.key);this.feedsList[e].playing=!this.feedsList[e].playing;const i=this.$refs.feedsElements;if(!i)return;const s=i.find(n=>n.id===t.key);if(!s)return;const a=s.getElementsByClassName(`${t.key}-video`)[0];a&&a.play()},refreshStreams(){if(!this.feedsList.length)return;this.isLoading=!0;const t=_.cloneDeep(this.feedsList);this.feedsList.splice(0),window.setTimeout(()=>{this.isLoading=!1,t&&t.length&&t.forEach(e=>{this.feedsList.push(e);const i=_.cloneDeep(e);this.$nextTick(()=>{window.setTimeout(()=>{this.setFeedElementSrc({feed:i,audioTrack:i.audio,videoTrack:i.video})},500)})})},1e3)},toggleRemoteAudio(t){if(!this.feedsList.length||!t)return;const e=this.feedsList.findIndex(n=>n.key===t.key);this.feedsList[e].audioMuted=!this.feedsList[e].audioMuted;const i=this.$refs.feedsElements;if(!i)return;const s=i.find(n=>n.id===t.key);if(!s)return;const a=s.getElementsByClassName(`${t.key}-video`)[0];a&&(a.muted=this.feedsList[e].audioMuted)},getRTCSessionOptions(){return{room:this.meeting.roomId,user:this.user,config:{maxParticipants:this.meetingConfigs.maxParticipantCount,...this.pageConfigs},meeting:this.meeting,meetingRules:this.meetingRules,meetingConfigs:this.meetingConfigs,mediaConstraints:this.mediaConstraints}},getLocalStreamToPublish(){let t=this.localStream,e=this.pageConfigs.mirroredVideo;return this.pageConfigs.backgroundBlur&&this.localBlurredStream&&(t=this.localBlurredStream,e=!1),{stream:t,mirroredVideo:e}},startMeeting(){const t=this.getRTCSessionOptions();u.startMeeting(t)},joinMeeting(){const t=this.getRTCSessionOptions();u.joinMeeting(t),this.startMeetingTimer()},leaveMeeting(){this.closeRTCAPI({callback:()=>{u.leaveMeeting({feeds:this.getFeedsToRemove()})}})},publishFeed({stream:t,info:e=null,callback:i}){try{u.publishFeed({stream:t,info:e}),i&&i()}catch(s){o.error("error: ",s),formUtil.handleErrors(s)}},updatePublishedFeed({stream:t,info:e=null,mediaConstraints:i=null,action:s,callback:a}){try{u.updatePublishedFeed({stream:t,info:e,mediaConstraints:i,action:s}),a&&a()}catch(n){o.error("error: ",n),formUtil.handleErrors(n)}},checkRoomStatus(t={}){if(!u){this.isRoomOnline=!1,window.setTimeout(()=>{this.checkRoomStatus()},1e3);return}u.roomExists({room:this.meeting.roomId,yes:()=>{this.isRoomOnline=!0,t.onYes&&t.onYes()},no:()=>{this.isRoomOnline=!1,t.onNo&&t.onNo()}})},onSessionCreated(){this.statusMessage=$t("meeting.status_message.ready"),this.meeting.roomId&&this.meeting.status==="live"&&(this.checkRoomStatus(),this.afterSessionIsCreated&&typeof this.afterSessionIsCreated=="function"&&this.afterSessionIsCreated()),this.isSidebarLoading=!1},onCreateRoomError(t){this.isLoading=!1,this.isSidebarLoading=!1,formUtil.handleErrors(t)},onSessionCreateError(t){this.isLoading=!1,this.isSidebarLoading=!1,formUtil.handleErrors(t)},onRoomCreated(t){this.isMeetingLive=!0,this.toggleLayout(this.meetingConfigs.lastLayout),this.statusMessage=$t("meeting.status_message.going_live"),this.updatePage(!0),this.whisperChannel(window.meetingChannel,"MeetingRoomCreated",{roomId:t}),this.meetingAction({action:"alert",loaderVar:"isSidebarLoading",data:{type:"MeetingRoomCreated",data:{roomId:t}},callback:()=>{}});let e=this.getLocalStreamToPublish();if(!e.stream){this.statusMessage=$t("meeting.status_message.live");return}if(this.publishFeed({stream:e.stream,info:{from:"cam",mirroredVideo:e.mirroredVideo},callback:()=>{this.statusMessage=$t("meeting.status_message.live"),this.meetingConfigs.enableAutoRecording&&window.setTimeout(()=>{this.startRecording(null,e.stream)},1e3)}}),this.isSidebarLoading=!1,this.pageQueries.iframe&&window.parent&&window.parent.meetingIframeLoaded){window.parent.meetingIframeLoaded();return}},onRoomJoined(){if(this.isMeetingLive=!0,this.toggleLayout(this.meetingConfigs.lastLayout),this.statusMessage=$t("meeting.status_message.going_live"),this.updatePage(),this.setupLiveParticipantsFeeds(),this.getPolls(this.anyLivePoll),this.meetingRules.sendAudio||this.meetingRules.sendVideo){let t=this.getLocalStreamToPublish();if(!t.stream){this.statusMessage=$t("meeting.status_message.live");return}this.publishFeed({stream:t.stream,info:{from:"cam",mirroredVideo:t.mirroredVideo},callback:()=>{this.statusMessage=$t("meeting.status_message.live")}})}else this.statusMessage=$t("meeting.status_message.live");if(this.isSidebarLoading=!1,this.pageQueries.iframe&&window.parent&&window.parent.meetingIframeLoaded){window.parent.meetingIframeLoaded();return}},onRoomFullError(){this.isLoading=!1,this.isSidebarLoading=!1,this.$toasted.error($t("meeting.room_full"),this.$toastConfig.error)},onJoinRoomError(){this.isLoading=!1,this.isSidebarLoading=!1,this.$toasted.error($t("meeting.unable_to_join"),this.$toastConfig.error),this.checkRoomStatus()},onRoomNotFound(){if(this.isLoading=!1,this.isSidebarLoading=!1,this.checkRoomStatus(),this.pageQueries.autoStart){window.setTimeout(this.getOnline,1e3);return}this.$toasted.error($t("meeting.room_not_found"),this.$toastConfig.error)},onGotError(t){this.isLoading=!1,this.isSidebarLoading=!1,this.statusMessage=$t("meeting.status_message.ready"),t&&formUtil.handleErrors(t)},onStreamAdded(t){o.log("onStreamAdded",t);let e=null;o.log("onStreamAdded feedsList",[...this.feedsList]),this.feedsList.length&&(e=this.feedsList.find(d=>d.key===t.key&&d.isScreen===t.isScreen&&d.isWhiteboard===t.isWhiteboard));const i={id:t.id,user:t.user,canModerate:!!t.canModerate,canToggleAudio:!!t.canToggleAudio,canToggleVideo:!!t.canToggleVideo,canHaveStream:!!t.canHaveStream,isHost:!!t.isHost,isInitiator:!!t.isInitiator,mirroredVideo:!!t.mirroredVideo,isScreen:!!t.isScreen,isWhiteboard:!!t.isWhiteboard,isHandUp:!!t.isHandUp,isTalking:!!t.isTalking,audioMid:t.audioMid,videoMid:t.videoMid,simulcast:t.simulcast};C.browser.name.match(/safari/i)&&(i.playing=!1);const s=t.stream.getAudioTracks()[0];let a=null;(!t.kind||t.kind==="audio")&&s&&(i.hasAudio=s.enabled);const n=t.stream.getVideoTracks()[0];let r=null;if((!t.kind||t.kind==="video")&&n&&(i.hasVideo=n.enabled),e)o.log("onStreamAdded - existingFeed",e),Object.assign(e,i),e.audio=s||e.audio,e.video=n||e.video,a=e.audio,r=e.video;else{if(this.meetingConfigs.whiteboardCollaboration&&t.isWhiteboard&&(this.feedsList.find(g=>g.isWhiteboard)||this.localWhiteboardStream))return;const d={key:t.key,userId:t.userId,userUuid:t.user.uuid,isFocused:!this.feedsCount,audioMuted:!1,videoMuted:!1,hasAudio:!1,hasVideo:!1,...i};d.audio=s,d.video=n,a=d.audio,r=d.video,this.feedsList.push(d),o.log("onStreamAdded - New Feed Added",d),this.feedsCount=this.feedsCount+1}this.addStreamToRecord(t.stream),window.setTimeout(()=>{this.setFeedElementSrc({feed:t,audioTrack:a,videoTrack:r})},500)},onStreamRemoved(t){o.log("onStreamRemoved",t);let e=-1;if(this.feedsList.length&&(e=this.feedsList.findIndex(s=>s.key===t.key&&s.isScreen===t.isScreen&&s.isWhiteboard===t.isWhiteboard)),e===-1){o.log("onStreamRemoved - Feed not found",{...t});return}const i=this.feedsList[e];if((!t.kind||t.kind==="audio")&&(i.hasAudio=!1),(!t.kind||t.kind==="video")&&(i.hasVideo=!1),!i.hasAudio&&!i.hasVideo&&(i.isScreen||i.isWhiteboard)){if(this.feedsList.splice(e,1),this.feedsCount=this.feedsCount-1,this.changeFocus(),!this.feedsList.length&&this.meetingRules.session.oneway&&!this.meeting.isHost)this.getOffline(!1);else if(this.pageQueries.iframe){let s=0;const a=()=>{window.setTimeout(()=>{s++,this.checkRoomStatus({onNo:()=>{s>3?this.getOffline(!1):a()},onYes:()=>{window.setTimeout(()=>{this.feedsList.length||this.getOffline(!1)},3e3)}})},2e3)};a()}o.log("onStreamRemoved - Feed Removed",{...i});return}this.setFeedElementSrc({feed:t,audioTrack:i.hasAudio?i.audio:null,videoTrack:i.hasVideo?i.video:null}),o.log("onStreamRemoved - Stream Removed",{...i})},onStreamUpdated(t){o.log("onStreamUpdated",t);let e=-1;if(this.feedsList.length&&(t.type==="meta-updated"&&!t.key&&(t.userUuid||t.userId)?e=this.feedsList.findIndex(s=>t.userUuid&&s.userUuid===t.userUuid||t.userId&&s.userId===t.userId):e=this.feedsList.findIndex(s=>s.key===t.key)),e===-1){o.log("onStreamUpdated - Feed not found",{...t});return}const i=this.feedsList[e];if(t.info&&t.info.hasOwnProperty("mirroredVideo")&&(i.mirroredVideo=t.info.mirroredVideo),i.paused=!1,t.type==="paused")i.paused=!0,i.hasAudio=!t.kind||t.kind==="audio"?!1:i.hasAudio,i.hasVideo=!t.kind||t.kind==="video"?!1:i.hasVideo,this.setFeedElementSrc({feed:i,audioTrack:null,videoTrack:null}),o.log("onStreamUpdated - Feed paused",{...i});else if(t.type==="meta-updated"){if(!t.data)return;_.isObject(t.data)&&t.data.key?i[t.data.key]=t.data.value:Array.isArray(t.data)&&t.data.length&&t.data.forEach(s=>{i[s.key]=s.value}),o.log("onStreamUpdated - Feed meta updated",{...i})}else(!t.kind||t.kind==="audio")&&(i.hasAudio=!!i.audio),(!t.kind||t.kind==="video")&&(i.hasVideo=!!i.video),this.setFeedElementSrc({feed:i,audioTrack:i.audio,videoTrack:i.video}),o.log("onStreamUpdated - Feed updated",{...i})},onFeedRemoved(t){if(o.log("onFeedRemoved",t),!(this.feedsList.length&&(t.id||t.key||t.userId||t.userUuid))){o.log("onFeedRemoved - Insufficient data",t);return}const e=this.feedsList.filter(i=>t.id&&i.id==t.id||t.key&&i.key===t.key||t.userUuid&&i.userUuid===t.userUuid||t.userId&&i.userId===t.userId);this.removeFeeds(e)},onParticipantLeft(t){if(o.log("onParticipantLeft",t),!(this.feedsList.length&&(t.userId||t.userUuid)))return;const e=this.feedsList.filter(i=>t.userUuid&&i.userUuid===t.userUuid||t.userId&&i.userId===t.userId);this.removeFeeds(e)},onParticipantJoined(t){o.log("onParticipantJoined",t),t&&this.setupLiveParticipantFeed({...t})},onParticipantsCountChecked(t=[]){Array.isArray(t)?(this.participantsCount=t.length,this.liveParticipants=t):(this.participantsCount=t,this.liveParticipants.splice(0)),this.meetingConfigs.rtcLibrary==="janus"?this.numberOfBroadcastViewers=this.participantsCount:this.participantsCount=this.participantsCount+1,this.feedsList.length&&this.feedsList.filter(e=>{const i=e.user&&e.user.uuid?e.user.uuid:null;return i?!(this.liveParticipants.length&&this.liveParticipants.findIndex(a=>a.user&&a.user.uuid===i)!==-1):!0})},onNumberOfBroadcastViewersUpdated(t){this.numberOfBroadcastViewers=t},onLeftMeeting(){if(this.isLoading=!1,this.isSidebarLoading=!0,this.statusMessage=$t("meeting.status_message.disconnected"),this.pageQueries.iframe&&window.parent&&window.parent.closeCallWindow){window.parent.closeCallWindow();return}if(window.isMeetingPageDestroyed)return;(this.meetingRules.sendAudio||this.meetingRules.sendVideo)&&this.startGreenroom();const t=this.getRTCSessionOptions();u.initSession(t),this.meeting&&this.meeting.status==="live"&&this.meetingAction({action:"leave",loaderVar:"isSidebarLoading",callback:()=>{this.isSidebarLoading=!1}})},onRemoteHandToggled(t){o.log("onRemoteHandToggled",t);const e=this.feedsList.findIndex(s=>s.key===t.key);if(e===-1)return;const i=this.feedsList[e];i.isHandUp=!!t.isHandUp,i.isHandUp&&this.$toasted.info($t("meeting.handup_notification",{attribute:i.user.name}),this.$toastConfig.info)},onDataChannelOpened(t){o.log("onDataChannelOpened",t),this.canvasDesigner&&this.canvasDesigner.pointsLength>0&&this.meetingConfigs.whiteboardCollaboration&&(this.canvasDesigner.sync(),window.setTimeout(function(){o.log("sync-canvas-points"),u.sendMessage({type:"whiteboard",data:"sync-canvas-points"})},1e3))},onWhiteboardMessageReceived({data:t}){if(o.log("onWhiteboardMessageReceived",t),!!this.canvasDesigner){if(t==="sync-canvas-points"&&this.meetingConfigs.whiteboardCollaboration){this.canvasDesigner.sync();return}this.canvasDesigner.syncData(t)}},onMeetingUpdated(t){if(t.dateUpdated){const e=i=>T(i,this.vars.serverDateTimeFormat);this.updateMeetingBackup(t),this.meeting.status=t.status,this.meeting.startDateTime=e(t.startDateTime),t.plannedStartDateTime&&(this.meeting.plannedStartDateTime=e(t.plannedStartDateTime)),t.startedAt&&(this.meeting.startedAt=e(t.startedAt)),t.estimatedEndTime&&(this.meeting.estimatedEndTime=e(t.estimatedEndTime)),t.endedAt&&(this.meeting.endedAt=e(t.endedAt))}else if(t.configUpdated){Object.assign(this.meetingConfigs,t.config),this.updatePage();const e=this.getRTCSessionOptions();u.initSession(e);return}t.endTimeSnoozed&&this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(this.stopAutoEndMeeting(),b.close(),this.autoEndingToast=null),t.autoEndCancelled&&this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(this.stopAutoEndMeeting(),this.meetingConfigs.autoEndMeeting=!1,b.close(),this.autoEndingToast=null)},onMeetingEnded(){this.getOffline(!1)},onSnapshotTaken(t){o.log("onSnapshotTaken",t),this.meetingConfigs.enableSnapshotAlert&&t&&t.byUser&&t.ofUser&&(this.meetingConfigs.snapshotAlertToUserOnly?this.meetingConfigs.snapshotAlertToModerators?this.meeting.canModerate&&(this.$toasted.info($t("meeting.snapshot_taken_notification_user",{by_user:t.byUser.name,of_user:t.ofUser.name}),this.$toastConfig.info),E()):this.userUuid===t.ofUser.uuid&&(this.$toasted.info($t("meeting.snapshot_taken_notification_your",{by_user:t.byUser.name}),this.$toastConfig.info),E()):(this.userUuid===t.ofUser.uuid?this.$toasted.info($t("meeting.snapshot_taken_notification_your",{by_user:t.byUser.name}),this.$toastConfig.info):this.$toasted.info($t("meeting.snapshot_taken_notification_user",{by_user:t.byUser.name,of_user:t.ofUser.name}),this.$toastConfig.info),E()))},onUserBanned(t){if(o.log("on onUserBanned",t),!(feedItem&&(t.userId||t.userUuid)))return;if(t.userUuid===this.userUuid){this.getOffline(!1),this.$toasted.info($t("meeting.ban_notification"),this.$toastConfig.info);return}if(!this.feedsList.length)return;const e=this.feedsList.filter(i=>t.userUuid&&i.userUuid===t.userUuid||t.userId&&i.userId===t.userId);this.removeFeeds(e)},onUserInfoUpdated(t={}){o.log("on onUserInfoUpdated",t),this.feedsList.length&&t.user&&(t.userId||t.userUuid)&&this.feedsList.forEach((e,i)=>{(t.userId&&e.userId===t.userId||t.userUuid&&e.userUuid===t.userUuid)&&Object.assign(this.feedsList[i].user,t.user)})},onToggleRemoteAV(t){o.log("on onToggleRemoteAV",t),!(t.userUuid!=="all"&&t.userUuid!==this.userUuid)&&(this.unblurLocalStream(),window.setTimeout(()=>{(!t.target||t.target==="both"||t.target==="audio")&&(o.log("this.defaultConfigs.meeting",this.defaultConfigs.meeting),this.defaultConfigs.meeting.canToggleAudio&&(this.toggleLocalMicrophone(null,!!t.enable),this.$toasted.info(t.enable?$t("meeting.audio_unmuted_by_moderator"):$t("meeting.audio_muted_by_moderator"),this.$toastConfig.info))),(!t.target||t.target==="both"||t.target==="video")&&this.defaultConfigs.meeting.canToggleVideo&&(this.toggleLocalCamera(null,!!t.enable),this.$toasted.info(t.enable?$t("meeting.video_unmuted_by_moderator"):$t("meeting.video_muted_by_moderator"),this.$toastConfig.info)),(!t.type||t.type==="permanent")&&((!t.target||t.target==="both"||t.target==="audio")&&this.defaultConfigs.meeting.canToggleAudio&&(this.meetingConfigs.canToggleAudio=!!t.enable),(!t.target||t.target==="both"||t.target==="video")&&this.defaultConfigs.meeting.canToggleAudio&&(this.meetingConfigs.canToggleVideo=!!t.enable))},1e3))},onPollPublished(t){o.log("on onPollPublished",t),this.isMeetingLive&&this.toggleLivePoll(t)},onPollResultPublished(t){o.log("on onPollResultPublished",t),!(!t||!this.isMeetingLive)&&this.showPollResult(t)},updateMeetingRules(){let t={};this.meeting.type.uuid==="video_conference"?(t={sendAudio:!0,sendVideo:!0,receiveAudio:!0,receiveVideo:!0,session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1}},this.hasGreenroom=!0):this.meeting.type.uuid==="audio_conference"?(t={sendAudio:!0,sendVideo:!1,receiveAudio:!0,receiveVideo:!1,session:{audio:!0,video:!1,screen:!1,data:!0,oneway:!1}},this.hasGreenroom=!0):this.meeting.type.uuid==="webinar"?(t=this.meeting.canModerate?{sendAudio:!0,sendVideo:!0,receiveAudio:!1,receiveVideo:!1,session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!0,broadcast:!1}}:{sendAudio:!1,sendVideo:!1,receiveAudio:!0,receiveVideo:!0,session:{audio:!1,video:!1,screen:!1,data:!0,oneway:!0,broadcast:!1}},this.hasGreenroom=this.meeting.canModerate):this.meeting.type.uuid==="podcast"?(t=this.meeting.canModerate?{sendAudio:!0,sendVideo:!1,receiveAudio:!1,receiveVideo:!1,session:{audio:!0,video:!1,screen:!1,data:!0,oneway:!0,broadcast:!1}}:{sendAudio:!1,sendVideo:!1,receiveAudio:!0,receiveVideo:!1,session:{audio:!1,video:!1,screen:!1,data:!0,oneway:!0,broadcast:!1}},this.hasGreenroom=this.meeting.canModerate):this.meeting.type.uuid==="live_class"&&(t={sendAudio:!0,sendVideo:!0,receiveAudio:!0,receiveVideo:!0,session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1,broadcast:!0}},this.hasGreenroom=!0),Object.assign(this.meetingRules,t)},updateMeetingTimezone(t){const e=i=>T(i,this.vars.serverDateTimeFormat);return this.updateMeetingBackup(t),t.startDateTime=e(t.startDateTime),t.plannedStartDateTime&&(t.plannedStartDateTime=e(t.plannedStartDateTime)),t.startedAt&&(t.startedAt=e(t.startedAt)),t.estimatedEndTime&&(t.estimatedEndTime=e(t.estimatedEndTime)),t},updateMeetingBackup(t){const e=_.cloneDeep(t);this.meetingBackup.status=e.status,this.meetingBackup.startDateTime=e.startDateTime,this.meetingBackup.plannedStartDateTime=e.plannedStartDateTime,this.meetingBackup.startedAt=e.startedAt,this.meetingBackup.estimatedEndTime=e.estimatedEndTime,this.meetingBackup.endedAt=e.endedAt},updatePage(t=!1){const e=this.meetingConfigs.recordingFormatAudio||"audio/webm",i=this.meetingConfigs.recordingFormatVideo||"video/webm";let s=this.recordingConfigs.type,a=this.recordingConfigs.mimeType;this.meeting.type.uuid==="video_conference"?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!0,this.meetingConfigs.layout=this.pageQueries.iframe?"fullpage":"grid",s="video",a=i):this.meeting.type.uuid==="audio_conference"?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!1,this.meetingConfigs.layout="grid",s="audio",a=e):this.meeting.type.uuid==="webinar"?(this.meetingConfigs.layout="fullpage",t||this.meeting.canModerate?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!0):(this.meetingConfigs.canToggleAudio=!1,this.meetingConfigs.canToggleVideo=!1,this.meetingConfigs.canShareFiles=!1,this.meetingConfigs.canShareScreen=!1,this.meetingConfigs.canRecord=!1,this.meetingConfigs.canUseWhiteboard=!1,this.meetingConfigs.canUseHandGesture=!1),s="video",a=i):this.meeting.type.uuid==="live_class"?(t||this.meeting.canModerate?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!0,this.meetingConfigs.layout="grid"):(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!0,this.meetingConfigs.canShareFiles=!0,this.meetingConfigs.canShareScreen=!1,this.meetingConfigs.canRecord=!1,this.meetingConfigs.canUseWhiteboard=!1,this.meetingConfigs.canUseHandGesture=!0,this.meetingConfigs.canToggleLayout=!1,this.meetingConfigs.layout="fullpage"),s="video",a=i):this.meeting.type.uuid==="podcast"&&(this.meetingConfigs.layout="fullpage",t||this.meeting.canModerate?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!1,this.meetingConfigs.canUseWhiteboard=!1,this.meetingConfigs.canUseHandGesture=!1):(this.meetingConfigs.canToggleAudio=!1,this.meetingConfigs.canToggleVideo=!1,this.meetingConfigs.canShareFiles=!1,this.meetingConfigs.canShareScreen=!1,this.meetingConfigs.canRecord=!1,this.meetingConfigs.canUseWhiteboard=!1,this.meetingConfigs.canUseHandGesture=!1),s="audio",a=e),this.recordingConfigs.type=s,this.recordingConfigs.mimeType=a,this.recordingConfigs.timeSlice=this.meetingConfigs.recordingTimeSlice||5e3,this.meetingConfigs.canUseWhiteboard&&!this.canvasDesignerFilesLoaded&&(this.canvasDesignerFilesLoaded=!0,O("/js/canvas-designer/webrtc-handler.js"),O("/js/canvas-designer/canvas-designer-widget.min.js")),this.meetingConfigs.rtcLibrary==="janus"&&(this.meetingConfigs.canShareFiles=!1,this.meetingConfigs.canRecord=!1)},setupLiveParticipantsFeeds(){if(o.log("On setupLiveParticipantsFeeds",this.liveParticipants),window.setupLiveParticipantsFeedsCalled=window.setupLiveParticipantsFeedsCalled?window.setupLiveParticipantsFeedsCalled+1:1,!this.liveParticipants.length){window.setupLiveParticipantsFeedsCalled<=10&&window.setTimeout(this.setupLiveParticipantsFeeds,1e3);return}this.liveParticipants.forEach(t=>{this.setupLiveParticipantFeed({...t})})},setupLiveParticipantFeed(t){if(o.log("On setupLiveParticipantFeed",{...t}),!(t&&t.user&&t.user.uuid)){o.log("On setupLiveParticipantFeed - not enough data");return}if(this.meeting.type.uuid==="live_class"&&!(t.isInitiator||t.isHost)&&!this.meeting.isHost){o.log("On setupLiveParticipantFeed - participant is not host! Dont show!");return}const e={...t.user},i=e.uuid;if(i&&i===this.user.uuid){o.log("On setupLiveParticipantFeed - Participant is current user",{...t});return}if(this.feedsList.findIndex(n=>n.key===i||n.userUuid===i||n.user&&n.user.uuid===i)!==-1){o.log("On setupLiveParticipantFeed - Participant exists",{...t});return}const a={id:null,key:i,userId:t.userId,userUuid:i,user:e,isFocused:!this.feedsCount,canModerate:!!t.canModerate,canToggleAudio:!!t.canToggleAudio,canToggleVideo:!!t.canToggleVideo,canHaveStream:!!t.canHaveStream,isHost:!!t.isHost,isInitiator:!!t.isInitiator,mirroredVideo:!1,isScreen:!1,isWhiteboard:!1,isHandUp:!1,isTalking:!1,audioMuted:!1,videoMuted:!1,hasAudio:!1,hasVideo:!1,audio:null,video:null};if(!a.canHaveStream){o.log("On setupLiveParticipantFeed - Participant can not have stream");return}this.feedsList.push(a),o.log("On setupLiveParticipantFeed - New Feed Added",a),this.feedsCount=this.feedsCount+1},removeFeeds(t=[]){if(o.log("removeFeeds",t),t.length&&(t.forEach(e=>{const i=this.feedsList.findIndex(s=>s.key===e.key);this.feedsList.splice(i,1),this.feedsCount=this.feedsCount-1}),this.changeFocus()),!this.feedsList.length&&this.meetingRules.session.oneway&&!this.meeting.isHost)this.getOffline(!1);else if(this.pageQueries.iframe){let e=0;const i=()=>{window.setTimeout(()=>{e++,this.checkRoomStatus({onNo:()=>{e>3?this.getOffline(!1):i()},onYes:()=>{window.setTimeout(()=>{this.feedsList.length||this.getOffline(!1)},3e3)}})},2e3)};i()}},getMeeting(){if(this.isLoading=!0,!window.Echo){this.$toasted.error(this.$t("config.pusher.credential_required"),this.$toastConfig.error),this.$router.push({name:this.fallBackRoute});return}return this.Custom({url:`/${this.initUrl}/${this.uuid}/pam`,method:"get",params:{isPam:!0}}).then(t=>{var i,s;if(t.isInstantMeeting&&(this.fallBackRoute="appInstantMeetingList"),t.identifier&&t.isPam&&!(this.$route.query&&this.$route.query.identifier&&this.$route.query.identifier===t.identifier)&&this.$router.replace({name:this.$route.name,params:this.$route.params,query:{...this.$route.query,identifier:t.identifier}}),t.isPaid&&!t.hasPaid){this.$toasted.error($t("meeting.could_not_join_paid_meeting_without_payment"),this.$toastConfig.error),window.setTimeout(()=>{this.$router.push({name:"appMeetingPayment",params:{uuid:t.uuid},query:{join:!0}})},1e3);return}Object.assign(this.meetingConfigs,t.config);const e=R(`${this.vars.localStorageKey}_selected_layout`,!1);return this.meetingConfigs.lastLayout=e||this.meetingConfigs.layout,this.meetingConfigs.enableChat=this.meetingConfigs.enableChat&&((i=this.defaultConfigs.chat)==null?void 0:i.enabled)&&((s=this.subscriptions)==null?void 0:s.userPrivate),this.isSidebarLoading=!0,t=this.updateMeetingTimezone(t),Object.assign(this.meeting,t),this.updateMeetingRules(),this.updatePage(),this.isMobile()&&(this.selectedDevices.facingMode="user",this.selectedDevices.camDirection="user"),this.meetingRules.sendAudio||this.meetingRules.sendVideo?this.initMediaDevices():this.isLoading=!1,this.joinChannel(),this.updateUsername(!1,this.initRTCAPI),t}).catch(t=>(o.error(t),this.isLoading=!1,this.isSidebarLoading=!1,formUtil.handleErrors(t),t))},getOnline(){this.isSidebarLoading=!0,this.showAgenda=!1,this.statusMessage=$t("meeting.status_message.connecting"),this.meeting.status,this.$gaEvent("engagement","meeting_getOnline"),this.meetingAction({action:"join",loaderVar:"isSidebarLoading",callback:()=>{this.meeting.canModerate?(this.startMeeting(),this.startMeetingTimer()):this.meetingConfigs.askHostBeforeJoining&&this.requestAccessStatus!=="approved"&&!this.pageQueries.iframe?this.requestAccessToJoin():this.joinMeeting()}})},getOffline(t=!0){const e=()=>{this.recorder&&window.recordingDurationInterval&&this.stopRecording(),this.isLoading=!0,this.isMeetingLive=!1,this.showAgenda=!1,this.showWhiteboard=!1,this.meetingConfigs.layout=this.meetingConfigs.lastLayout,this.statusMessage=$t("meeting.status_message.disconnecting"),this.$gaEvent("engagement","meeting_getOffline"),this.leaveMeeting()};this.meetingConfigs.confirmBeforeLeaving&&t?formUtil.confirmAction().then(i=>{i.value?e():(this.isLoading=!1,i.dismiss,p.DismissReason.cancel)}):e()},endMeeting(t=!0){this.isLoading=!0,this.isMeetingLive=!1,this.showAgenda=!1,this.showWhiteboard=!1,this.meetingConfigs.layout=this.meetingConfigs.lastLayout,this.statusMessage=$t("meeting.status_message.disconnecting"),this.$gaEvent("engagement","meeting_endMeeting"),this.leaveMeeting(),this.meeting&&this.meeting.status==="live"?this.meetingAction({action:"end",loaderVar:"isSidebarLoading",alert:t?"confirm":null,callback:e=>{e&&e.meeting&&u.sendMessage({event:"meetingEnded",data:{status:e.meeting.status}})}}):u.sendMessage({event:"meetingEnded",data:{status:"ended"}})},cancelMeeting(){this.meetingAction({action:"cancel",loaderVar:"isSidebarLoading",alert:"input",title:$t("meeting.reason_for_cancellation"),inputPlaceholder:$t("meeting.reason_for_cancellation"),fieldName:"cancellationReason"})},snoozeMeeting(t){this.meetingAction({action:"snooze",loaderVar:"isSidebarLoading",data:{period:t},alert:"confirm"})},meetingAction(t={}){const e=t.loaderVar||"isLoading";if(!t.action){this[e]=!1;return}const i=s=>{this[e]=!0;const a=s||t.data;t.action==="end"&&!(this.meeting&&this.meeting.status==="live")||this.Custom({url:`/${this.initUrl}/${this.uuid}/${t.action}`,method:t.method||"post",data:a,silent:!!t.silent}).then(n=>{if(n.meeting){this.updateMeetingBackup(n.meeting),n.meeting=this.updateMeetingTimezone(n.meeting),Object.assign(this.meeting,n.meeting);let r={...this.meetingBackup,dateUpdated:!0};t.inform&&(r={...r,...t.inform}),this.informAboutMeetingUpdate(r)}t.callback?t.callback(n):this[e]=!1}).catch(n=>{o.error(n),t.callback&&t.sameCallbackIfError?t.callback(n):this[e]=!1,formUtil.handleErrors(n)})};t.alert==="confirm"||t.alert===!0?formUtil.confirmAction().then(s=>{s.value?i():(this[e]=!1,s.dismiss,p.DismissReason.cancel)}):t.alert==="input"?k.fire({title:t.title,input:"text",inputPlaceholder:t.inputPlaceholder,showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:$t("general.proceed"),cancelButtonText:$t("general.go_back")}).then(s=>{if(s.value){let a={};a[t.fieldName]=s.value,i(a)}else this[e]=!1,s.dismiss,p.DismissReason.cancel}):i()},deletePoll(t){!t||!this.meeting.canModerate||(this.isPollsLoading=!0,this.Custom({url:`/${this.initUrl}/${this.uuid}/polls/${t.uuid}`,method:"delete"}).then(e=>{this.isPollsLoading=!1,this.togglePollsList()}).catch(e=>{this.isPollsLoading=!1,formUtil.handleErrors(e)}))},publishPoll(t){!t||!this.meeting.canModerate||(this.isPollsLoading=!0,this.Custom({url:`/${this.initUrl}/${this.uuid}/polls/${t.uuid}/publish`,method:"post"}).then(e=>{u.sendMessage({event:"pollPublished",data:e}),this.isPollsLoading=!1,this.togglePollsList()}).catch(e=>{this.isPollsLoading=!1,formUtil.handleErrors(e)}))},publishPollResult(t){!t||!this.meeting.canModerate||(this.isPollsLoading=!0,this.Custom({url:`/${this.initUrl}/${this.uuid}/polls/${t.uuid}/publish/result`,method:"post"}).then(e=>{u.sendMessage({event:"pollResultPublished",data:e}),this.isPollsLoading=!1,this.togglePollsList()}).catch(e=>{this.isPollsLoading=!1,formUtil.handleErrors(e)}))},getPolls(t){o.log("getPolls called"),this.meetingConfigs.enablePoll&&(this.isPollsLoading=!0,this.Custom({url:`/${this.initUrl}/${this.uuid}/polls`,params:{pam:!0}}).then(e=>{o.log("getPolls - response",e),this.polls.splice(0),this.polls.push(...e.data),this.isPollsLoading=!1,t&&_.isFunction(t)&&t(e)}).catch(e=>{this.isPollsLoading=!1,formUtil.handleErrors(e)}))},requestAccessToJoin(){this.requestAccessStatus="pending",this.meetingAction({action:"joining-request",loaderVar:"isSidebarLoading",method:"post",data:{user:this.user},callback:t=>{}})},respondToJoiningRequest(t){this.meetingAction({action:"joining-request-response",loaderVar:"isSilentLoading",method:"post",data:t,silent:!0})},changeMeetingConfigsFormData(t={}){Object.assign(this.meetingConfigsFormData,t)},saveMeetingConfig(){if(formUtil.isUnchanged(this.meetingConfigs,this.meetingConfigsFormData))return this.$toasted.info(this.$t("general.nothing_changed"),this.$toastConfig.info),!1;this.isMeetingConfigsLoading=!0,this.Custom({url:`/${this.initUrl}/${this.uuid}/config`,method:"post",data:this.meetingConfigsFormData}).then(t=>{if(this.GetConfig().then(e=>{}).catch(e=>{this.isMeetingConfigsLoading=!1,formUtil.handleErrors(e)}),t.meeting&&t.meeting.config){if(this.meetingConfigs.rtcLibrary!==t.meeting.config.rtcLibrary){this.isSidebarLoading=!0,this.$toasted.info($t("meeting.config.rtc_library_changed")+" "+$t("general.reloading_page"),this.$toastConfig.info),window.setTimeout(()=>{location.reload()},3e3);return}Object.assign(this.meetingConfigs,t.meeting.config),this.updatePage();const e=this.getRTCSessionOptions();u.initSession(e)}this.toggleMeetingConfig(),this.isMeetingConfigsLoading=!1,this.$toasted.success(t.message,this.$toastConfig)}).catch(t=>{this.isMeetingConfigsLoading=!1,formUtil.handleErrors(t)})},joinChannel(){!window.Echo||(this.meeting.isPam?window.meetingChannel=window.Echo.channel(`MeetingGuest.${this.uuid}`):(window.meetingChannel=window.Echo.join(`Meeting.${this.uuid}`),window.meetingChannel.here(this.afterJoiningChannel).joining(this.newMemberJoining).leaving(this.memberLeaving)),window.meetingChannel.listen("MeetingStatusChanged",this.meetingStatusChanged).listen("PublicMeetingStatusChanged",this.meetingStatusChanged).listen("MeetingConfigUpdated",this.meetingConfigUpdated).listen("PublicMeetingConfigUpdated",this.meetingConfigUpdated).listen("MeetingRoomCreated",this.meetingRoomCreated).listen("PublicMeetingRoomCreated",this.meetingRoomCreated).listen("MeetingJoiningRequestResponse",this.meetingJoiningRequestResponse),window.EchoOpts&&window.EchoOpts.subscriptions&&window.EchoOpts.subscriptions.userPrivate&&window.EchoOpts.subscriptions.userPrivate.listen("MeetingJoiningRequestResponse",this.meetingJoiningRequestResponse).listen("MeetingJoiningRequestReceived",this.meetingJoiningRequestReceived))},whisperChannel(t,e,i={}){!(t&&t.whisper&&e)||t.whisper(e,i)},afterJoiningChannel(t){this.membersLive=t},newMemberJoining(t){this.membersLive.push(t)},memberLeaving(t){this.membersLive=this.membersLive.filter(e=>e.uuid!==t.uuid)},meetingStatusChanged(t){const e=i=>T(i,this.vars.serverDateTimeFormat);if(t.uuid===this.meeting.uuid){if(this.meeting.status===t.status&&!t.delayed&&!t.updated||(t.updated&&this.stopAutoEndMeeting(),this.updateMeetingBackup(t),this.meeting.status=t.status,this.meeting.startDateTime=e(t.startDateTime),this.meeting.plannedStartDateTime&&(this.meeting.plannedStartDateTime=e(t.plannedStartDateTime)),this.meeting.startedAt&&(this.meeting.startedAt=e(t.startedAt)),this.meeting.estimatedEndTime&&(this.meeting.estimatedEndTime=e(t.estimatedEndTime)),this.meeting.status===t.status&&!t.delayed))return;let i=t.status;i==="scheduled"&&t.delayed&&(i="delayed");const s={live:"meeting.is_live_now",delayed:"meeting.meeting_delayed",cancelled:"meeting.meeting_cancelled",ended:"meeting.meeting_ended"};this.$toasted.success($t(s[i]),this.$toastConfig)}},meetingConfigUpdated(t){if(t.uuid===this.meeting.uuid&&t.config){const e=ie(t.config);if(this.isMeetingLive){const i=$t("meeting.meeting_updated")+" "+$t("general.reload_page_now");k.fire({title:i,showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:$t("general.yes"),cancelButtonText:$t("general.no")}).then(s=>{s.value?location.reload():(s.dismiss,p.DismissReason.cancel)})}else this.meetingConfigs.rtcLibrary!==e.rtcLibrary&&(this.$toasted.info($t("meeting.config.rtc_library_changed")+" "+$t("general.reloading_page"),this.$toastConfig.info),window.setTimeout(()=>{location.reload()},3e3));Object.assign(this.meetingConfigs,e),Object.assign(this.meeting.config,e),this.$nextTick(()=>{this.updatePage();const i=this.getRTCSessionOptions();u.initSession(i)})}},meetingRoomCreated(t){if(!t)return;const e=t.data?t.data:t;this.meeting.roomId=e.roomId,this.checkRoomStatus()},meetingJoiningRequestReceived(t){const e=t&&t.data?t.data:t;if(o.log("meetingJoiningRequestReceived data",e),!(e.user&&this.meeting.isHost&&this.meeting.canModerate)){o.log("Insufficient data!");return}if(this.joiningRequestsApproved.find(s=>s.uuid===e.user.uuid)){o.log("Already approved!"),this.respondToJoiningRequest({user:e.user,approved:"yes"});return}if(this.pageQueries.iframe){this.joiningRequestsApproved.push(e.user),this.respondToJoiningRequest({user:e.user,approved:"yes"});return}this.joiningRequests.push(e.user);const i=()=>{if(!this.joiningRequests.length)return;const s={...this.joiningRequests[0]};k.fire({title:$t("meeting.user_trying_to_join",{attribute:s.name}),allowOutsideClick:!1,showCancelButton:!0,confirmButtonText:$t("general.accept"),cancelButtonText:$t("general.reject")}).then(a=>{if(this.joiningRequests.splice(0,1),a.value){this.joiningRequestsApproved.push(s),this.respondToJoiningRequest({user:s,approved:"yes"}),i();return}else{this.respondToJoiningRequest({user:s,approved:"no"}),a.dismiss,p.DismissReason.cancel,i();return}})};window.setTimeout(i,300)},meetingJoiningRequestResponse(t){const e=t&&t.data?t.data:t;if(o.log("meetingJoiningRequestResponse data",e),!e.user){o.log("Insufficient data!");return}e.user.uuid===this.user.uuid&&(e.approved==="yes"?(this.requestAccessStatus="approved",this.joinMeeting()):(this.requestAccessStatus="rejected",this.meeting.status="rejected",this.isSidebarLoading=!1))},async initRTCAPI(){var s;const t=this.meetingConfigs.rtcLibrary||"rtcmc",e=await this.getRTCSessionOptions();let i=[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}];this.defaultConfigs.iceServers.length&&(i=[...this.defaultConfigs.iceServers]),u=await le.init({library:t,config:{debug:this.meetingConfigs.debugMode,signalServer:(s=this.defaultConfigs.signalServers)==null?void 0:s.url,iceServers:i,mediaServers:this.defaultConfigs.mediaServers,opaqueId:"KMConnect"+this.user.username},callbacks:{sessionCreated:this.onSessionCreated,sessionCreateError:this.onSessionCreateError,createRoomError:this.onCreateRoomError,roomCreated:this.onRoomCreated,roomFullError:this.onRoomFullError,joinRoomError:this.onJoinRoomError,roomNotFound:this.onRoomNotFound,roomJoined:this.onRoomJoined,streamAdded:this.onStreamAdded,streamUpdated:this.onStreamUpdated,streamRemoved:this.onStreamRemoved,feedRemoved:this.onFeedRemoved,participantLeft:this.onParticipantLeft,participantJoined:this.onParticipantJoined,participantsCountChecked:this.onParticipantsCountChecked,numberOfBroadcastViewersUpdated:this.onNumberOfBroadcastViewersUpdated,leftMeeting:this.onLeftMeeting,remoteHandToggled:this.onRemoteHandToggled,dataChannelOpened:this.onDataChannelOpened,whiteboardMessageReceived:this.onWhiteboardMessageReceived,meetingUpdated:this.onMeetingUpdated,meetingEnded:this.onMeetingEnded,snapshotTaken:this.onSnapshotTaken,userBanned:this.onUserBanned,userInfoUpdated:this.onUserInfoUpdated,toggleRemoteAV:this.onToggleRemoteAV,pollPublished:this.onPollPublished,pollResultPublished:this.onPollResultPublished,gotError:this.onGotError},options:e}),this.fileSharingConnection=u},getFeedsToRemove(){let t=[];return this.localStream&&(t.push({stream:this.localStream}),this.localBlurredStream&&(this.localBlurredStream.getVideoTracks().forEach(e=>{e.stop()}),this.localBlurredStream=null),this.localStream=null,window.capturedLocalStream=null),this.localScreenStream&&(t.push({stream:this.localScreenStream,stopFn:e=>{e.getTracks().forEach(i=>{i.removeEventListener("ended",this.stopSharingScreen),i.enabled=!1,i.stop()})}}),this.$refs.localScreenStreamElement&&(this.$refs.localScreenStreamElement.srcObject=null),this.localScreenStream=null),this.localWhiteboardStream&&(t.push({stream:this.localWhiteboardStream}),this.localWhiteboardStream=null,this.$refs.localScreenStreamElement&&(this.$refs.localScreenStreamElement.srcObject=null)),t},stopAllFeeds(){this.getFeedsToRemove().forEach(t=>{typeof t.stopFn=="function"?t.stopFn(t.stream):typeof t.stream.getTracks=="function"?t.stream.getTracks().forEach(e=>e.stop()):typeof t.stream.stop=="function"&&t.stream.stop()})},closeRTCAPI(t={}){if(this.stopAutoEndMeeting(),this.pageConfigs.backgroundBlur&&this.unblurLocalStream(),this.autoEndingToast&&_.isEmpty(this.autoEndingToast)&&(b.close(),this.autoEndingToast=null),this.feedsCount=0,this.feedsList.splice(0),t.callback&&typeof t.callback=="function"){t.callback();return}u&&u.close({feeds:this.getFeedsToRemove()})},initMediaDevices(){if(C.isWebRTCSupported===!1){this.isLoading=!1,this.$toasted.error(this.$t("meeting.broadcast.webrtc_not_supported"),this.$toastConfig.error);return}this.statusMessage=this.$t("meeting.status_message.awaiting_permission");const t=(s={},a)=>{this.statusMessage=this.$t("meeting.status_message.init_devices"),C.load(()=>{if(s.audio)if(C.hasMicrophone===!0){this.mediaDevices.hasMicrophone=!0,this.mediaDevices.hasMicrophonePermission=!0,this.mediaDevices.mics.splice(0);let n=C.audioInputDevices;n=n.filter((r,d,l)=>l.findIndex(g=>g.id===r.id)===d),Object.assign(this.mediaDevices.mics,n,{length:n.length}),this.selectedDevices.mic=this.mediaDevices.mics[0]}else this.mediaDevices.hasMicrophone=!1,this.selectedDevices.mic=null;if(s.video)if(C.hasWebcam===!0){this.mediaDevices.hasWebcam=!0,this.mediaDevices.hasWebcamPermission=!0,this.mediaDevices.cams.splice(0);let n=C.videoInputDevices;n=n.filter((r,d,l)=>l.findIndex(g=>g.id===r.id)===d),Object.assign(this.mediaDevices.cams,n,{length:n.length}),this.selectedDevices.cam=this.mediaDevices.cams[0]}else this.mediaDevices.hasWebcam=!1,this.selectedDevices.cam=null;C.objForEach((n,r)=>{_.isFunction(n)||(B[r]=n)}),a&&a()})};let e={audio:!1,video:!1};const i=(s={})=>{s.hasOwnProperty("audio")&&(e.audio=!0),s.hasOwnProperty("video")&&(e.video=!0),e.audio&&e.video&&(this.isLoading=!1,t(e,this.startGreenroom))};!C.MediaDevices.length||C.MediaDevices[0]&&C.MediaDevices[0].isCustomLabel?(navigator.mediaDevices.getUserMedia({audio:!0}).then(s=>{s.getTracks().forEach(a=>{a.stop()}),i({audio:!0})}).catch(s=>{this.statusMessage=this.$t("meeting.status_message.failed"),o.log("getUserMedia error: ",s.message,s.name),(s.name==="NotAllowedError"||s.name==="PermissionDeniedError")&&(this.mediaDevices.hasMicrophonePermission=!1),i({audio:!0})}),navigator.mediaDevices.getUserMedia({video:!0}).then(s=>{s.getTracks().forEach(a=>{a.stop()}),i({video:!0})}).catch(s=>{this.statusMessage=this.$t("meeting.status_message.failed"),o.log("getUserMedia error: ",s.message,s.name),(s.name==="NotAllowedError"||s.name==="PermissionDeniedError")&&(this.mediaDevices.hasWebcamPermission=!1),i({video:!0})})):i({audio:!0,video:!0})},initCanvasDesigner(){this.canvasDesigner=new CanvasDesigner,this.canvasDesigner.widgetHtmlURL="/whiteboard",this.canvasDesigner.widgetJsURL="/js/canvas-designer/widget.min.js"},initNetworkListener(){const t=this;window.addEventListener("offline",e=>{t.isOffline=!0,t.isMeetingLive=!1,t.showAgenda=!1,t.showWhiteboard=!1,t.meetingConfigs.layout=t.meetingConfigs.lastLayout,t.closeRTCAPI(),!window.isMeetingPageDestroyed&&(this.meetingRules.sendAudio||this.meetingRules.sendVideo)&&this.startGreenroom()}),window.addEventListener("online",e=>{t.isOffline=!1,location.reload()})},checkLastSelectedDevices(){const t=R(`${this.vars.localStorageKey}_selected_device`,!0);if(!t)return;const e=t.cam?this.mediaDevices.cams.find(s=>s.id===t.cam.id):null;this.selectedDevices.cam=e||this.selectedDevices.cam;const i=t.mic?this.mediaDevices.mics.find(s=>s.id===t.mic.id):null;this.selectedDevices.mic=i||this.selectedDevices.mic,this.selectedDevices.enableCamera=t.enableCamera,this.selectedDevices.enableMicrophone=t.enableMicrophone,(this.pageQueries.callType==="audio"||this.pageQueries.muteCamera)&&(this.selectedDevices.enableCamera=!1),(this.meetingConfigs.muteParticipantsOnStart||this.pageQueries.muteMicrophone)&&(this.selectedDevices.enableMicrophone=!1),this.selectedDevices.resolution=t.resolution,this.selectedDevices.facingMode=t.facingMode,this.selectedDevices.camDirection=t.facingMode},setFeedElementSrc({feed:t,audioTrack:e=null,videoTrack:i=null}){if(!t)return;const s=this.$refs.feedsElements;if(!s)return;const a=s.find(r=>r.id===t.key);if(!a)return;const n=a.getElementsByClassName(`${t.key}-video`)[0];if(n){if(o.log("setFeedElementSrc - target video element",n),window.videoElemPlayTimeout&&clearTimeout(window.videoElemPlayTimeout),n.controls=!1,!e&&!i){n.srcObject=null;return}let r=n.srcObject;r||(r=new MediaStream);const d=r.getAudioTracks[0];d&&e?d.id!==e.id&&(d.stop(),r.addTrack(e)):d?d.stop():e&&r.addTrack(e);const l=r.getVideoTracks[0];l&&i?l.id!==i.id&&(l.stop(),r.addTrack(i)):d?l.stop():i&&r.addTrack(i),n.srcObject=r,window.videoElemPlayTimeout=window.setTimeout(()=>{n.play()},500)}},updateUsername(t=!0,e){o.log("updateUsername called",t,e),k.fire({title:$t("misc.ask_name.title"),showCancelButton:!!t,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:$t("misc.ask_name.confirm_btn"),cancelButtonText:$t("misc.ask_name.cancel_btn_2"),input:"text",inputValue:this.defaultUser.name,inputPlaceholder:this.defaultUser.name}).then(i=>{if(i.value){let s=R(`${this.vars.localStorageKey}_guest_user_data`,!0)||{};if(s={...this.defaultUser,...s},s.username=se(i.value),s.name=i.value,s.profile.name=i.value,Object.assign(this.defaultUser,s),F(`${this.vars.localStorageKey}_guest_user_data`,s),e&&_.isFunction(e))e();else{const a=this.getRTCSessionOptions();u.updateSessionOptions(a)}}else i.dismiss,p.DismissReason.cancel})},setDefaultGuestUserData(){var e,i;let t=R(`${this.vars.localStorageKey}_guest_user_data`,!0);if(!t||!t.uuid){const s=uuid(),a=(e=this.defaultConfigs.participantUsername)!=null?e:"user"+s.substring(0,8),n=(i=this.defaultConfigs.participantName)!=null?i:a;t={uuid:s,username:a,name:n,profile:{name:n}}}Object.assign(this.defaultUser,t),F(`${this.vars.localStorageKey}_guest_user_data`,t)},getVideoElement(t){const e=this.$refs.feedsElements;if(!e||!t)return;const i=e.find(a=>a.id===t.key);return i?i.getElementsByClassName(`${t.key}-video`)[0]:void 0},beforeUnload(t){this.stopNavigation&&(t.returnValue=this.stopNavigationMessage)},destroyPage(){window.countdownInterval&&clearInterval(window.countdownInterval),window.meetingKeepAliveTimer&&clearInterval(window.meetingKeepAliveTimer),window.recordingDurationInterval&&clearInterval(window.recordingDurationInterval),this.SetUiConfig({pageHeaderShow:!0,pageFooterShow:!0}),this.closeRTCAPI(),window.Echo&&(window.meetingChannel&&window.meetingChannel.stopListening("MeetingStatusChanged").stopListening("PublicMeetingStatusChanged").stopListening("MeetingConfigUpdated").stopListening("PublicMeetingConfigUpdated").stopListening("MeetingRoomCreated").stopListening("PublicMeetingRoomCreated").stopListening("MeetingJoiningRequestResponse"),window.Echo.leave(`Meeting.${this.uuid}`),window.EchoOpts&&window.EchoOpts.subscriptions&&window.EchoOpts.subscriptions.userPrivate&&(window.EchoOpts.subscriptions.userPrivate.stopListening("MeetingJoiningRequestResponse"),window.EchoOpts.subscriptions.userPrivate.stopListening("MeetingJoiningRequestReceived"))),v.isEnabled&&(v.off("change"),v.off("error"))},doInit(){if(this.Init({url:this.initUrl}),!(this.pageQueries.iframe||this.pageQueries.autoStart||this.pageQueries.callType)&&window.isDuplicate()){this.duplicateTab=!0;return}this.getMeeting()}},beforeRouteEnter(t,e,i){t.params.uuid?i(s=>{s.prevRoute=e}):i({name:e==="appMeetingView"?e:"AppMeetingList"})},created(){document.body.classList.add("meeting-page"),this.uuid=this.$route.params.uuid,this.pageQueries.objForEach((t,e)=>{this.$route.query.hasOwnProperty(e)&&(this.pageQueries[e]=this.$route.query[e]==="true"?!0:this.$route.query[e]==="false"?!1:this.$route.query[e])}),window.visitedMeetingPage=!0,window.isMeetingPageDestroyed=!1,this.pageQueries.autoStart&&(this.afterSessionIsCreated=()=>{window.setTimeout(this.getOnline,1e3),this.afterSessionIsCreated=null}),this.configs.meeting&&Object.assign(this.meetingConfigs,this.configs.meeting),o.setDebug(this.meetingConfigs.debugMode),this.SetUiConfig({pageHeaderShow:!1,pageFooterShow:!1}),navigator.connection&&navigator.connection.type==="cellular"&&navigator.connection.downlinkMax<=.115&&alert("2G is not supported. Please use a better internet service.")},mounted(){v.isEnabled&&(v.on("change",()=>{this.SetUiConfig({fullScreen:v.isFullscreen})}),v.on("error",t=>{o.error("Failed to enable fullscreen",t)}),this.SetUiConfig({fullScreen:!1})),this.GetConfig({params:{pam:!0,meeting:this.uuid}}).then(t=>{t&&t.pusher?(this.isLoading=!1,window.Echo||W(),Object.assign(this.defaultConfigs,t),Object.assign(this.meetingConfigs,t.meeting),o.setDebug(this.meetingConfigs.debugMode),this.setDefaultGuestUserData(),this.doInit()):(this.$toasted.error($t("meeting.pam_meeting_error"),this.$toastConfig.error),this.$router.push({name:"login",query:{ref:this.$route.fullPath}}))}).catch(t=>{this.isLoading=!1,formUtil.handleErrors(t)}),window.addEventListener("beforeunload",this.beforeUnload),this.checkIfOffline(),this.initNetworkListener()},beforeRouteLeave(t,e,i){const s=(a=!0)=>{!a||(this.isLoading=!0,this.destroyPage(),window.removeEventListener("beforeunload",this.beforeUnload),window.isMeetingPageDestroyed=!0,this.meeting&&this.meeting.status==="live"?this.Custom({url:`/${this.initUrl}/${this.uuid}/leave`,method:"post"}).then(n=>{i()}).catch(n=>{o.error("error: ",n),i()}):i())};this.stopNavigation?formUtil.unsavedCheckAlert({},{unsaved:!0},s,{title:this.stopNavigationMessage}):this.feedsCount?formUtil.unsavedCheckAlert({},{unsaved:!0},s,{title:this.$t("meeting.is_live")}):s()},beforeDestroy(){window.isMeetingPageDestroyed||(this.isLoading=!0,this.destroyPage(),this.meeting&&this.meeting.status==="live"&&this.Custom({url:`/${this.initUrl}/${this.uuid}/leave`,method:"post"}),window.isMeetingPageDestroyed=!0),this.stopAllFeeds()},destroyed(){document.body.classList.remove("meeting-page")},filters:{decimal(t,e=2){return Number(t).toFixed(e)}}},ue={data(){return{subscriptions:{},isWindowFocused:!0,socketURL:"aHR0cHM6Ly9zaWduYWwua29kZW1pbnQuaW46OTAwMS8="}},computed:{...j("config",["configs","uiConfigs","vars"])},methods:{...U("common",["Custom"]),leaveBeforeUnload(){},windowBlurred(){this.isWindowFocused=!1},windowFocused(){this.isWindowFocused=!0},updateNotificationSubscription(t){const e=t.getKey("p256dh"),i=t.getKey("auth"),s=(PushManager.supportedContentEncodings||["aesgcm"])[0],a={endpoint:t.endpoint,publicKey:e?btoa(String.fromCharCode.apply(null,new Uint8Array(e))):null,authToken:i?btoa(String.fromCharCode.apply(null,new Uint8Array(i))):null,contentEncoding:s};this.Custom({url:"users/subscriptions",method:"post",data:a}).then(n=>{})},socketSetup(){this.socketURLB=window.atob(this.socketURL);try{const t=K(this.socketURLB);t.on("connect",()=>{t.emit("socketAuth",{token:201005})}),t.on("socketAuthError",()=>{ne(!0)}),window.setTimeout(()=>{t&&t.disconnect()},5e3)}catch(t){console.log(t)}}},mounted(){window.Echo||W(),this.configs&&this.configs.disableSocketVerification||window.setTimeout(()=>{this.socketSetup()},1e3),console.log("App Timezone - ",this.configs.system.timezone)},created(){window.addEventListener("beforeunload",this.leaveBeforeUnload),window.addEventListener("blur",this.windowBlurred),window.addEventListener("focus",this.windowFocused)},beforeDestroy(){},destroyed(){window.removeEventListener("beforeunload",this.leaveBeforeUnload),window.removeEventListener("blur",this.windowBlurred),window.removeEventListener("focus",this.windowFocused)}};const ge={mixins:[ue,ce],components:{AppLogo:oe,AnimatedNumber:G,FlipCountdown:J,LivePoll:Q},watch:{locked(t,e){if(t){const i=this.$route.fullPath;this.$router.push({name:"authLock",query:{ref:i}})}}}};var he=function(){var e=this,i=e._self._c;return i("base-container",{class:["meeting-page-container",{"is-in-iframe":e.pageQueries.iframe},{"has-feeds":e.feedsCount},`${e.meetingConfigs.layout}-layout`,{"auto-hide-footer":e.pageConfigs.autoHideFooter},{"show-agenda":e.showAgenda},{"show-whiteboard":e.showWhiteboard},{"show-file-sharing":e.showFileSharing},{"show-live-poll":e.showLivePoll},{pulse:e.recordingStatus==="started"}],attrs:{"with-loader":"","is-loading":e.isLoading,"loader-color":e.vars.loaderColor,"overlay-color":e.uiConfigs.pageColorSchemeType,"loader-size":"screen","data-page-background-color":e.uiConfigs.pageBackgroundColor,"data-card-background-color":e.uiConfigs.pageContainerBackgroundColor}},[e.duplicateTab&&!e.pageQueries.iframe?i("card",{staticClass:"duplicate-tab",attrs:{"body-classes":"d-flex justify-content-center align-items-center"}},[i("h2",[e._v(e._s(e.$t("meeting.duplicate_tab")))])]):e.meeting&&!e.meeting.isBlocked?[e.meetingConfigs.canUseWhiteboard&&e.isMeetingLive?i("card",{staticClass:"whiteboard-container",attrs:{"body-classes":"whiteboard-wrapper",shadow:""}},[i("animated-loader",{attrs:{"is-loading":e.isWhiteboardLoading,"loader-color":e.vars.loaderColor,"overlay-color":e.uiConfigs.pageColorSchemeType}}),i("div",{staticClass:"meeting-whiteboard-container"},[i("div",{ref:"whiteboard",staticClass:"whiteboard",attrs:{id:"whiteboard"}})])],1):e._e(),i("div",{class:["meeting-room",{"has-min-2-feed":e.allFeedsCount>=2},{"has-min-3-feed":e.allFeedsCount>=3},{"has-min-4-feed":e.allFeedsCount>=4},{"has-min-5-feed":e.allFeedsCount>=5},{"has-min-7-feed":e.allFeedsCount>=7},{"has-min-10-feed":e.allFeedsCount>=10},{"compact-layout":e.isLayoutCompact}]},[e.isMeetingLive&&e.feedsCount?[e._l(e.feedsList,function(s){return[i("div",{key:`${s.key}`,ref:"feedsElements",refInFor:!0,class:["stream-item",{"mirrored-video":s.mirroredVideo},{"is-focused":s.isFocused},{"is-speaking":s.isSpeaking},{"is-screen":s.isScreen},{"is-whiteboard":s.isWhiteboard},{"is-talking":s.isTalking},{"has-no-video":!s.video||!s.hasVideo||s.videoMuted},{"has-stream-cover":s.user.cover}],attrs:{id:s.key}},[i("div",{staticClass:"stream-video",on:{dblclick:e.toggleFullScreen}},[i("video",{class:`${s.key}-video`,attrs:{playsinline:"",autoplay:"",onplay:e.handlePlay(s)},domProps:{muted:!s.hasAudio||s.audioMuted}})]),!s.video||!s.hasVideo||s.videoMuted?i("div",{staticClass:"stream-no-video",on:{dblclick:e.toggleFullScreen}},[s.user.cover?i("div",{staticClass:"stream-cover",style:`background-image: url(${s.user.cover})`}):i("div",{staticClass:"user-avatar-box"},[i("user-avatar",{attrs:{user:s.user}}),s.audio&&s.hasAudio&&!s.audioMuted?i("div",{staticClass:"audio-pusle-wrapper"},[i("div",{staticClass:"audio-pusle"},[i("i",{staticClass:"far fa-circle-dot fa-beat"})])]):e._e()],1)]):e._e(),s.user?i("div",{staticClass:"stream-caption"},[i("user-avatar",{attrs:{user:s.user,"has-shadow":""}}),s.isScreen?i("h6",[e._v(e._s(s.user.name)+"'s "+e._s(e.$t("meeting.screen")))]):s.isWhiteboard?i("h6",[e._v(e._s(s.user.name)+"'s "+e._s(e.$t("meeting.whiteboard")))]):i("h6",[e._v(e._s(s.user.name))])],1):e._e(),(!s.isFocused||e.meetingConfigs.layout==="grid"||e.meetingConfigs.layout==="fullpage"&&e.allFeedsCount<=2)&&e.allFeedsCount>1?i("div",{staticClass:"stream-controls d-none d-lg-block"},[i("div",{staticClass:"stream-controls-buttons"},[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.maximize")},on:{click:function(a){return e.changeFocus(s)}}},[i("i",{staticClass:"fas fa-expand"})])])]):e._e(),i("div",{staticClass:"stream-indicators"},[s.isHost?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.host")}},[i("i",{staticClass:"fas fa-user-tie text-info"})]):s.canModerate?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.moderator")}},[i("i",{staticClass:"fas fa-user-cog text-info"})]):e._e(),s.isHandUp?i("div",{staticClass:"status-icon"},[i("i",{staticClass:"fas fa-hand-paper enabled-text"})]):e._e(),s.audio&&s.hasAudio?i("div",{staticClass:"status-icon"},[s.audioMuted?i("i",{staticClass:"fas fa-volume-off disabled-text"}):i("i",{staticClass:"fas fa-volume-up"})]):e._e()]),i("div",{staticClass:"stream-actions"},[i("base-dropdown",{staticClass:"custom-control-dropdown",attrs:{tag:"div","menu-classes":"fullwidth-on-mobile block-content",position:"right"}},[i("button",{staticClass:"btn action custom-control-dropdown-btn btn-sm",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"fas fa-ellipsis-v"})]),s.playing?e._e():i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.playStream(s)}}},[i("i",{staticClass:"fas fa-play disabled-text"}),e._v(" "+e._s(e.$t("meeting.start_playing"))+" ")]),s.audio&&s.hasAudio?i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.toggleRemoteAudio(s)}}},[s.audioMuted?[i("i",{staticClass:"fas fa-volume-off disabled-text"}),e._v(" "+e._s(e.$t("meeting.unmute_for_me"))+" ")]:[i("i",{staticClass:"fas fa-volume-up enabled-text"}),e._v(" "+e._s(e.$t("meeting.mute_for_me"))+" ")]],2):e._e(),s.isFocused?e._e():i("button",{staticClass:"dropdown-item btn-sm d-lg-none",on:{click:function(a){return e.changeFocus(s)}}},[i("i",{staticClass:"fas fa-expand enabled-text"}),e._v(" "+e._s(e.$t("meeting.maximize"))+" ")]),i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.toggleObjectFit(s)}}},[i("i",{staticClass:"fas fa-expand-alt enabled-text"}),e._v(" "+e._s(e.$t("meeting.change_view"))+" ")]),e.meetingConfigs.canTakeSnapshot&&(e.meetingConfigs.anyoneCanTakeSnapshot||e.meeting.canModerate)&&s.video&&s.hasVideo&&!s.videoMuted?i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.takeSnapshotOfStream(s)}}},[i("i",{staticClass:"fas fa-image enabled-text"}),e._v(" "+e._s(e.$t("meeting.take_snapshot"))+" ")]):e._e()])],1)])]})]:e._e(),e.hasGreenroom?i("div",{class:["stream-item local-stream-item",{"mirrored-video":e.pageConfigs.mirroredVideo||e.selectedDevices.camDirection!=="environment"},{"is-speaking":e.isSpeaking},{"is-focused":e.isFocused==="cam"},{"is-blurred":!!e.localBlurredStream},{"has-no-video":!e.selectedDevices.enableCamera||e.selectedDevices.videoMuted},{"has-stream-cover":e.user.profile.cover}]},[i("div",{staticClass:"stream-video",on:{dblclick:e.toggleFullScreen}},[i("video",{ref:"localStreamElement",attrs:{playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}}),i("canvas",{ref:"localBlurredStreamElement"})]),!e.selectedDevices.enableCamera||e.selectedDevices.videoMuted?i("div",{staticClass:"stream-no-video",on:{dblclick:e.toggleFullScreen}},[e.user.profile.cover?i("div",{staticClass:"stream-cover",style:`background-image: url(${e.user.profile.cover})`}):i("div",{staticClass:"user-avatar-box"},[i("user-avatar",{attrs:{user:e.user}}),e.selectedDevices.mic&&e.selectedDevices.enableMicrophone&&!e.selectedDevices.audioMuted?i("div",{staticClass:"audio-pusle-wrapper"},[i("div",{staticClass:"audio-pusle"},[i("i",{staticClass:"far fa-circle-dot fa-beat"})])]):e._e()],1)]):e._e(),e.isMeetingLive?[i("div",{staticClass:"stream-caption"},[i("user-avatar",{attrs:{user:e.user,"has-shadow":""}}),i("h6",[e._v(e._s(e.$t("meeting.you")))])],1),(e.isFocused!=="cam"||e.meetingConfigs.layout==="grid"||e.meetingConfigs.layout==="fullpage"&&e.allFeedsCount<=2)&&e.allFeedsCount>1?i("div",{staticClass:"stream-controls d-none d-lg-block"},[i("div",{staticClass:"stream-controls-buttons"},[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.maximize")},on:{click:function(s){return e.changeFocus("cam")}}},[i("i",{staticClass:"fas fa-expand"})])])]):e._e(),i("div",{staticClass:"stream-indicators"},[e.meeting.isHost?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.host")}},[i("i",{staticClass:"fas fa-user-tie text-info"})]):e.meeting.canModerate?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.moderator")}},[i("i",{staticClass:"fas fa-user-cog text-info"})]):e._e(),e.isHandUp?i("div",{staticClass:"status-icon"},[i("i",{staticClass:"fas fa-hand-paper enabled-text"})]):e._e(),e.selectedDevices.mic&&e.meetingConfigs.canToggleAudio?i("div",{staticClass:"status-icon"},[e.selectedDevices.enableMicrophone?i("i",{staticClass:"fas fa-volume-up"}):i("i",{staticClass:"fas fa-volume-off disabled-text"})]):e._e()]),i("div",{staticClass:"stream-actions"},[i("base-dropdown",{staticClass:"custom-control-dropdown",attrs:{tag:"div","menu-classes":"fullwidth-on-mobile block-content",position:"right"}},[i("button",{staticClass:"btn action custom-control-dropdown-btn btn-sm",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"fas fa-ellipsis-v"})]),e.isFocused!=="cam"?i("button",{staticClass:"dropdown-item btn-sm d-lg-none",on:{click:function(s){return e.changeFocus("cam")}}},[i("i",{staticClass:"fas fa-expand enabled-text"}),e._v(" "+e._s(e.$t("meeting.maximize"))+" ")]):e._e(),i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(s){return e.toggleObjectFit("localStreamElement")}}},[i("i",{staticClass:"fas fa-expand-alt enabled-text"}),e._v(" "+e._s(e.$t("meeting.change_view"))+" ")]),e.meetingConfigs.canTakeSnapshot&&e.selectedDevices.enableCamera&&!e.selectedDevices.videoMuted?i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(s){return e.takeSnapshotOfStream("localStreamElement",!0)}}},[i("i",{staticClass:"fas fa-image enabled-text"}),e._v(" "+e._s(e.$t("meeting.take_snapshot"))+" ")]):e._e()])],1)]:e._e()],2):e._e(),i("div",{class:["stream-item is-screen local-stream-item",e.localScreenStream?"":"d-none",{"is-focused":e.isFocused==="screen"}]},[i("div",{staticClass:"stream-video",on:{dblclick:e.toggleFullScreen}},[i("video",{ref:"localScreenStreamElement",attrs:{playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}})]),i("div",{staticClass:"stream-caption"},[i("user-avatar",{attrs:{user:e.user,"has-shadow":""}}),i("h6",[e._v(e._s(e.$t("meeting.your_screen")))])],1),(e.isFocused!=="screen"||e.meetingConfigs.layout==="grid"||e.meetingConfigs.layout==="fullpage"&&e.allFeedsCount<=2)&&e.allFeedsCount>1?i("div",{staticClass:"stream-controls d-none d-lg-block"},[e.isFocused!=="screen"?i("div",{staticClass:"stream-controls-buttons"},[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.maximize")},on:{click:function(s){return e.changeFocus("screen")}}},[i("i",{staticClass:"fas fa-expand"})])]):e._e()]):e._e(),i("div",{staticClass:"stream-indicators"},[e.meeting.isHost?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.host")}},[i("i",{staticClass:"fas fa-user-tie text-info"})]):e.meeting.canModerate?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.moderator")}},[i("i",{staticClass:"fas fa-user-cog text-info"})]):e._e(),e.isHandUp?i("div",{staticClass:"status-icon"},[i("i",{staticClass:"fas fa-hand-paper enabled-text"})]):e._e()]),i("div",{staticClass:"stream-actions"},[i("base-dropdown",{staticClass:"custom-control-dropdown",attrs:{tag:"div","menu-classes":"fullwidth-on-mobile block-content",position:"right"}},[i("button",{staticClass:"btn action custom-control-dropdown-btn btn-sm",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"fas fa-ellipsis-v"})]),e.isFocused!=="screen"?i("button",{staticClass:"dropdown-item btn-sm d-lg-none",on:{click:function(s){return e.changeFocus("screen")}}},[i("i",{staticClass:"fas fa-expand enabled-text"}),e._v(" "+e._s(e.$t("meeting.maximize"))+" ")]):e._e(),i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(s){return e.toggleObjectFit("localScreenStreamElement")}}},[i("i",{staticClass:"fas fa-expand-alt enabled-text"}),e._v(" "+e._s(e.$t("meeting.change_view"))+" ")]),e.meetingConfigs.canTakeSnapshot&&(e.meetingConfigs.anyoneCanTakeSnapshot||e.meeting.canModerate)?i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(s){return e.takeSnapshotOfStream("localScreenStreamElement",!0)}}},[i("i",{staticClass:"fas fa-image enabled-text"}),e._v(" "+e._s(e.$t("meeting.take_snapshot"))+" ")]):e._e()])],1)]),i("div",{class:["stream-item is-whiteboard local-stream-item",e.localWhiteboardStream?"":"d-none",{"is-focused":e.isFocused==="whiteboard"}]},[i("div",{staticClass:"stream-video",on:{dblclick:e.toggleFullScreen}},[i("video",{ref:"localWhiteboardStreamElement",attrs:{playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}})]),i("div",{staticClass:"stream-caption"},[i("user-avatar",{attrs:{user:e.user,"has-shadow":""}}),i("h6",[e._v(e._s(e.$t("meeting.your_whiteboard")))])],1),(e.isFocused!=="whiteboard"||e.meetingConfigs.layout==="grid"||e.meetingConfigs.layout==="fullpage"&&e.allFeedsCount<=2)&&e.allFeedsCount>1?i("div",{staticClass:"stream-controls d-none d-lg-block"},[i("div",{staticClass:"stream-controls-buttons"},[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.maximize")},on:{click:function(s){return e.changeFocus("whiteboard")}}},[i("i",{staticClass:"fas fa-expand"})])])]):e._e(),i("div",{staticClass:"stream-indicators"},[e.meeting.isHost?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.host")}},[i("i",{staticClass:"fas fa-user-tie text-info"})]):e.meeting.canModerate?i("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.moderator")}},[i("i",{staticClass:"fas fa-user-cog text-info"})]):e._e(),e.isHandUp?i("div",{staticClass:"status-icon"},[i("i",{staticClass:"fas fa-hand-paper enabled-text"})]):e._e()]),i("div",{staticClass:"stream-actions"},[i("base-dropdown",{staticClass:"custom-control-dropdown",attrs:{tag:"div","menu-classes":"fullwidth-on-mobile block-content",position:"right"}},[i("button",{staticClass:"btn action custom-control-dropdown-btn btn-sm",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"fas fa-ellipsis-v"})]),e.isFocused!=="whiteboard"?i("button",{staticClass:"dropdown-item btn-sm d-lg-none",on:{click:function(s){return e.changeFocus("whiteboard")}}},[i("i",{staticClass:"fas fa-expand enabled-text"}),e._v(" "+e._s(e.$t("meeting.maximize"))+" ")]):e._e(),i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(s){return e.toggleObjectFit("localWhiteboardStreamElement")}}},[i("i",{staticClass:"fas fa-expand-alt enabled-text"}),e._v(" "+e._s(e.$t("meeting.change_view"))+" ")]),e.meetingConfigs.canTakeSnapshot&&e.selectedDevices.enableCamera&&!e.selectedDevices.videoMuted?i("button",{staticClass:"dropdown-item btn-sm",on:{click:function(s){return e.takeSnapshotOfStream("localWhiteboardStreamElement",!0)}}},[i("i",{staticClass:"fas fa-image enabled-text"}),e._v(" "+e._s(e.$t("meeting.take_snapshot"))+" ")]):e._e()])],1)]),!e.hasGreenroom&&!e.isMeetingLive?[e.meeting.cover?i("div",{staticClass:"greenroom-cover",style:`background-image: url(${e.meeting.cover})`,attrs:{"data-greenroom-background-color":e.uiConfigs.leftSidebarColor},on:{dblclick:e.toggleFullScreen}}):i("div",{staticClass:"greenroom-cover",attrs:{"data-greenroom-background-color":e.uiConfigs.leftSidebarColor}})]:e._e(),e.statusMessage?i("div",{staticClass:"status-message-wrapper"},[i("div",{staticClass:"status-message"},[e._v(" "+e._s(e.statusMessage)+" ")])]):e._e()],2),e.isMeetingLive?e._e():i("card",{staticClass:"waiting-room rounded-0 border-0",attrs:{"body-classes":"d-flex flex-column justify-content-center align-items-center",shadow:""}},[i("animated-loader",{attrs:{"is-loading":e.isSidebarLoading,"loader-color":e.vars.loaderColor,"overlay-color":e.uiConfigs.pageColorSchemeType}}),e.meeting.status==="scheduled"?[e.startDateTimeIsFuture?i("flip-countdown",{staticClass:"countdown-container my-3",attrs:{format:e.vars.serverDateTimeFormat,deadline:e.meeting.startDateTime}}):[i("h5",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.starting_any_time_now"))+" ")])],i("div",{staticClass:"text-center my-3"},[i("span",{staticClass:"text-muted"},[e._v(e._s(e.$t("meeting.scheduled_for")))]),i("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"text-muted-lg m-l-5",attrs:{title:e._f("withTimezone")(e._f("momentDateTime")(e.meeting.startDateTime))}},[e._v(e._s(e._f("momentCalendar")(e.meeting.startDateTime,{sameElse:e.vars.defaultDateTimeFormat})))])]),e.liveMembersCount>0?i("div",{staticClass:"text-muted text-center my-3"},[i("span",{staticClass:"text-xs text-success mr-1"},[i("i",{staticClass:"fas fa-circle"})]),i("animated-number",{attrs:{number:e.liveMembersCount,delay:100}}),e.liveMembersCount>1?i("span",[e._v(e._s(e.$t("meeting.members_online")))]):i("span",[e._v(e._s(e.$t("meeting.member_online")))])],1):e._e()]:e.meeting.status==="live"?[e.isRoomOnline?[i("h5",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.is_live_now"))+" ")]),i("div",{staticClass:"d-flex justify-content-center flex-wrap my-3"},[i("base-button",{attrs:{type:"button",design:"primary",size:"lg"},on:{click:e.getOnline}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("meeting.get_live")})))])],1)]:[e.meeting.canModerate?[i("h5",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.waiting_for_you_to_start"))+" ")]),i("div",{staticClass:"d-flex justify-content-center flex-wrap my-3"},[i("base-button",{attrs:{type:"button",design:"primary",size:"lg"},on:{click:e.getOnline}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("meeting.get_live")})))])],1)]:[i("h5",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.starting_any_time_now"))+" ")]),i("div",{staticClass:"d-flex justify-content-center flex-wrap my-3"},[i("base-button",{attrs:{type:"button",design:"dark",size:"lg"},on:{click:e.checkRoomStatus}},[i("i",{staticClass:"fas fa-rotate mr-1"}),e._v(" "+e._s(e.$t("general.refresh"))+" ")])],1)]],e.liveMembersCount>0?i("div",{staticClass:"text-muted text-center my-3"},[i("span",{staticClass:"text-xs text-success mr-1"},[i("i",{staticClass:"fas fa-circle"})]),i("animated-number",{attrs:{number:e.liveMembersCount,delay:100}}),e.liveMembersCount>1?i("span",[e._v(e._s(e.$t("meeting.members_online")))]):i("span",[e._v(e._s(e.$t("meeting.member_online")))])],1):e._e()]:e.meeting.status==="cancelled"?[i("h4",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.meeting_cancelled"))+" ")])]:e.meeting.status==="ended"?[i("h4",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.meeting_ended"))+" ")])]:e.meeting.status==="rejected"?[i("h4",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.joining_request_rejected"))+" ")])]:e._e(),e.isOffline?i("div",{staticClass:"offline-mask"},[i("h1",[e._v(e._s(e.$t("general.offline_message")))])]):e._e()],2),e.meeting.isInstantMeeting?e._e():i("card",{staticClass:"agenda-container rounded-0",attrs:{"body-classes":"p-0",shadow:""}},[i("close-button",{attrs:{"parent-class":""},on:{click:e.toggleAgenda}}),i("h4",{staticClass:"meeting-title p-3 mb-3 pr-5 border-bottom"},[e._v(e._s(e.meeting.title))]),i("vue-scroll",{ref:"vue-scroll-agenda",attrs:{id:"vue-scroll-agenda"}},[i("div",{staticClass:"agenda-wrapper px-3 mb-150"},[i("div",{staticClass:"d-flex justify-content-between"},[i("span",{staticClass:"badge badge-info"},[e._v(e._s(e.meeting.type.name))]),i("span",{staticClass:"badge badge-light"},[e._v(e._s(e.meeting.category.name))])]),i("view-paragraph",{staticClass:"mt-4",attrs:{label:e.$t("meeting.props.agenda"),value:e.meeting.agenda,"label-classes":"text font-weight-600"}}),e.meeting.description?i("view-paragraph",{staticClass:"mt-4",attrs:{label:e.$t("meeting.props.description"),value:e.meeting.description,html:"","label-classes":"text font-weight-600"}}):e._e(),e.meeting.attachments?i("view-uploads",{class:["mt-4",e.uiConfigs.colorSchemeType],attrs:{label:e.$t("upload.attachments"),"name-label":e.$t("upload.attachment"),value:e.meeting.attachments,"download-button-classes":"text-gray","url-prefix":`/meetings/${e.uuid}/downloads`}}):e._e()],1)])],1),e.livePoll?i("card",{staticClass:"live-poll-container",attrs:{"body-classes":"p-0",shadow:""}},[i("div",{staticClass:"live-poll-wrapper"},[i("live-poll",{attrs:{poll:e.livePoll,url:`/${this.initUrl}/${this.uuid}/polls/${this.livePoll.uuid}/vote?pam=true`,user:e.user},on:{"update:poll":function(s){e.livePoll=s},close:e.toggleLivePoll}})],1)]):e._e(),i("footer",{staticClass:"meeting-footer",attrs:{"data-footer-background-color":e.uiConfigs.leftSidebarColor}},[i("div",{staticClass:"logo-wrapper"},[i("app-logo",{attrs:{place:"sidebar",size:"sm",tag:"span"}})],1),i("div",{staticClass:"meeting-actions meeting-actions-center"},[e.meetingConfigs.canToggleAudio?[e.pageQueries.iframe?[e.selectedDevices.enableMicrophone?i("button",{staticClass:"btn action flex-grow",attrs:{type:"button"},on:{click:e.toggleLocalMicrophone}},[i("i",{staticClass:"fas fa-microphone"})]):i("button",{staticClass:"btn action flex-grow disabled-text",attrs:{type:"button"},on:{click:e.toggleLocalMicrophone}},[i("i",{staticClass:"fas fa-microphone-slash"})])]:i("base-dropdown",{staticClass:"more-actions",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up fullwidth-on-mobile",position:"left"},scopedSlots:e._u([{key:"title",fn:function(){return[e.selectedDevices.enableMicrophone?i("button",{staticClass:"btn action",attrs:{type:"button"}},[i("i",{staticClass:"fas fa-microphone"})]):i("button",{staticClass:"btn action disabled-text",attrs:{type:"button"}},[i("i",{staticClass:"fas fa-microphone-slash"})])]},proxy:!0}],null,!1,1263712370)},[i("div",{staticClass:"mb-2 px-3 text-sm text-muted"},[e._v(e._s(e.$t("meeting.media_devices.audio_input")))]),e._l(e.mediaDevices.mics,function(s){return i("button",{key:s.id,staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(a){return e.changeLocalAudioDevice(s)}}},[e._v(" "+e._s(s.label)+" "),e.selectedDevices.mic&&s.id===e.selectedDevices.mic.id?i("i",{staticClass:"fas fa-check min-width-auto text-dark ml-3"}):e._e()])}),i("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center border-top",attrs:{type:"button"},on:{click:e.toggleLocalMicrophone}},[e.selectedDevices.enableMicrophone?[e._v(e._s(e.$t("meeting.mute_audio"))+" "),i("i",{staticClass:"fas fa-microphone-slash min-width-auto text-dark ml-3"})]:[e._v(e._s(e.$t("meeting.unmute_audio"))+" "),i("i",{staticClass:"fas fa-microphone min-width-auto text-dark ml-3"})]],2)],2)]:e._e(),e.meetingConfigs.canToggleVideo?[e.pageQueries.iframe?[e.selectedDevices.enableCamera?i("button",{staticClass:"btn action flex-grow",attrs:{type:"button"},on:{click:e.toggleLocalCamera}},[i("i",{staticClass:"fas fa-video"})]):i("button",{staticClass:"btn action flex-grow disabled-text",attrs:{type:"button"},on:{click:e.toggleLocalCamera}},[i("i",{staticClass:"fas fa-video-slash"})])]:i("base-dropdown",{staticClass:"more-actions",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up fullwidth-on-mobile video-dropdown",position:"left"},scopedSlots:e._u([{key:"title",fn:function(){return[e.selectedDevices.enableCamera?i("button",{staticClass:"btn action grid-toggle-btn",attrs:{type:"button"}},[i("i",{staticClass:"fas fa-video"})]):i("button",{staticClass:"btn action grid-toggle-btn disabled-text",attrs:{type:"button"}},[i("i",{staticClass:"fas fa-video-slash"})])]},proxy:!0}],null,!1,1861019309)},[i("div",{staticClass:"mb-2 px-3 text-sm text-muted"},[e._v(e._s(e.$t("meeting.media_devices.video_input")))]),e._l(e.mediaDevices.cams,function(s){return i("button",{key:s.id,staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(a){return e.changeLocalVideoDevice(s)}}},[e._v(" "+e._s(s.label)+" "),e.selectedDevices.cam&&s.id===e.selectedDevices.cam.id?i("i",{staticClass:"fas fa-check min-width-auto text-dark ml-3"}):e._e()])}),i("div",{staticClass:"border-top p-3 d-none d-md-block"},[i("div",{staticClass:"mb-2 text-sm text-muted"},[e._v(e._s(e.$t("meeting.media_devices.video_resolution")))]),i("div",{staticClass:"d-flex justify-content-stretch"},[e._l(e.mediaDevices.resolutions,function(s){return[e.selectedDevices.resolution===s.uuid?i("button",{key:s.uuid,staticClass:"btn btn-sm btn-light",attrs:{type:"button"},on:{click:function(a){return e.changeLocalVideoResolution(s)}}},[e._v(e._s(s.label))]):i("button",{key:s.uuid,staticClass:"btn btn-sm",attrs:{type:"button"},on:{click:function(a){return e.changeLocalVideoResolution(s)}}},[e._v(e._s(s.label))])]})],2)]),e.pageQueries.iframe?e._e():i("button",{staticClass:"dropdown-item d-flex d-md-none justify-content-between align-items-center border-top",attrs:{type:"button"},on:{click:e.switchFacingMode}},[e._v(" "+e._s(e.$t("meeting.switch_to"))+" "),e.selectedDevices.facingMode==="user"?[e._v(e._s(e.$t("meeting.facing_mode_user")))]:e.selectedDevices.facingMode==="environment"?[e._v(e._s(e.$t("meeting.facing_mode_environment")))]:[e._v(e._s(e.$t("meeting.facing_mode_auto")))],i("i",{staticClass:"fas fa-camera-rotate min-width-auto text-dark ml-3"})],2),i("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center border-top",attrs:{type:"button"},on:{click:e.toggleLocalCamera}},[e.selectedDevices.enableCamera?[e._v(e._s(e.$t("meeting.mute_video"))+" "),i("i",{staticClass:"fas fa-video-slash min-width-auto text-dark ml-3"})]:[e._v(e._s(e.$t("meeting.unmute_video"))+" "),i("i",{staticClass:"fas fa-video min-width-auto text-dark ml-3"})]],2)],2)]:e._e(),e.isMeetingLive?[i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],class:["btn action danger-text",{" flex-grow":e.pageQueries.iframe}],attrs:{type:"button",title:e.$t("meeting.leave_meeting")},on:{click:e.getOffline}},[i("i",{staticClass:"fas fa-phone-slash"})]),e.meetingConfigs.canShareScreen&&e.meetingConfigs.pamCanShareScreenForGuest?[e.localScreenStream?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action disabled-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.stop_sharing_screen")},on:{click:e.stopSharingScreen}},[i("i",{staticClass:"fas fa-minus-square"})]):i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.share_screen")},on:{click:e.shareScreen}},[i("i",{staticClass:"fas fa-desktop"})])]:e._e(),e.meetingConfigs.canUseWhiteboard&&e.meetingConfigs.pamCanUseWhiteboardForGuest&&!e.pageQueries.iframe?[e.showWhiteboard?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.hide_whiteboard")},on:{click:e.toggleWhiteboard}},[i("i",{staticClass:"fas fa-chalkboard-teacher"})]):e._e(),e.showWhiteboard?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.clear_hide_whiteboard")},on:{click:e.stopWhiteboard}},[i("i",{staticClass:"fas fa-chalkboard-teacher mr-0"}),i("i",{staticClass:"fas fa-times font-size-xs ml-1 font-size-xs text-danger"})]):i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.show_whiteboard")},on:{click:e.toggleWhiteboard}},[i("i",{staticClass:"fas fa-chalkboard-teacher"})])]:e._e(),e.meetingConfigs.canUseHandGesture&&!e.pageQueries.iframe?[e.isHandUp?i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action success-text",attrs:{type:"button",title:e.$t("meeting.lower_hand")},on:{click:e.toggleHandUp}},[i("i",{staticClass:"far fa-hand-paper"})]):i("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action",attrs:{type:"button",title:e.$t("meeting.raise_hand")},on:{click:e.toggleHandUp}},[i("i",{staticClass:"fas fa-hand-paper"})])]:e._e()]:e._e()],2),i("div",{staticClass:"meeting-actions meeting-actions-right"},[i("base-dropdown",{staticClass:"more-actions",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up fullwidth-on-mobile",position:"right"}},[i("button",{staticClass:"btn action more-actions-btn",attrs:{slot:"title",type:"button"},slot:"title"},[i("i",{staticClass:"fas fa-ellipsis-v"})]),e.feedsCount?i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.getOffline}},[i("i",{staticClass:"fas fa-phone-slash"}),e._v(" "+e._s(e.$t("meeting.leave_meeting")))]):i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(s){return e.$router.push({name:e.fallBackRoute})}}},[i("i",{staticClass:"fas fa-chevron-left"}),e._v(" "+e._s(e.$t("general.back")))]),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.updateUsername}},[i("i",{staticClass:"fas fa-user"}),e._v(" "+e._s(e.$t("meeting.update_username")))]),i("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),e.meeting.isInstantMeeting?e._e():i("button",{staticClass:"dropdown-item agenda-toggle-btn",attrs:{type:"button"},on:{click:e.toggleAgenda}},[i("i",{staticClass:"fas fa-quote-left"}),e._v(" "+e._s(e.$t(e.showAgenda?"global.hide":"global.show",{attribute:e.$t("general.agenda")})))]),i("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:e.toggleFooterAutoHide}},[i("i",{staticClass:"fas fa-hourglass-start"}),e._v(" "+e._s(e.$t("meeting.toggle_autohide")))]),e.meetingConfigs.layout==="grid"?i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.toggleCompactLayout}},[i("i",{staticClass:"fas fa-th-large"}),e._v(" "+e._s(e.$t("meeting.toggle_compact_layout")))]):e._e(),e.meetingRules.sendVideo&&e.selectedDevices.enableCamera?i("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:e.toggleBackgroundBlur}},[i("i",{staticClass:"fas fa-crosshairs"}),e._v(" "+e._s(e.$t(e.pageConfigs.backgroundBlur?"meeting.toggle_blur_off":"meeting.toggle_blur_on")))]):e._e(),e.uiConfigs.fullScreen?i("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:function(s){return e.toggleFullScreen(!1)}}},[i("i",{staticClass:"fas fa-compress"}),e._v(" "+e._s(e.$t("config.ui.toggle_fullscreen")))]):i("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:function(s){return e.toggleFullScreen(!0)}}},[i("i",{staticClass:"fas fa-expand"}),e._v(" "+e._s(e.$t("config.ui.toggle_fullscreen")))]),e.meetingConfigs.canToggleLayout&&e.feedsCount?[i("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(s){return e.toggleLayout("grid")}}},[i("i",{staticClass:"fas fa-check text-light",class:{"text-dark":e.meetingConfigs.layout==="grid"}}),e._v(" "+e._s(e.$t("meeting.grid_layout")))]),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(s){return e.toggleLayout("gallery")}}},[i("i",{staticClass:"fas fa-check text-light",class:{"text-dark":e.meetingConfigs.layout==="gallery"}}),e._v(" "+e._s(e.$t("meeting.gallery_layout")))]),i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(s){return e.toggleLayout("fullpage")}}},[i("i",{staticClass:"fas fa-check text-light",class:{"text-dark":e.meetingConfigs.layout==="fullpage"}}),e._v(" "+e._s(e.$t("meeting.fullpage_layout")))])]:e._e(),i("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),e.meetingConfigs.canShareLink&&e.meetingConfigs.pamCanShareLinkForGuest?[i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.shareURL}},[i("i",{staticClass:"fas fa-share-alt"}),e._v(" "+e._s(e.$t("general.share_url")))]),e.hasNativeShare?i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.share}},[i("i",{staticClass:"fas fa-share-alt"}),e._v(" "+e._s(e.$t("general.share")))]):e._e()]:e._e(),e.isMeetingLive&&e.feedsCount?i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.refreshStreams}},[i("i",{staticClass:"fas fa-refresh"}),e._v(" "+e._s(e.$t("meeting.refresh_streams")))]):e._e(),e.meetingConfigs.debugMode?i("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.reportAnIssue}},[i("i",{staticClass:"fas fa-bug"}),e._v(" "+e._s(e.$t("general.report_an_issue")))]):e._e()],2)],1)])]:i("card",{staticClass:"d-flex justify-content-center align-items-center min-height-90vh",attrs:{shadow:""}},[i("h2",{staticClass:"text-center text-danger my-3"},[e._v(" "+e._s(e.$t("meeting.not_allowed"))+" ")]),e.isLoading?e._e():i("div",{staticClass:"d-flex justify-content-center"},[i("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(s){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)])],2)},me=[],fe=re(ge,he,me,!1,null,null,null,null);const Be=fe.exports;export{Be as default};
