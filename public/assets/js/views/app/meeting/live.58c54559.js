import{u as N}from"../../../user-dropdown.0d279254.js";import{m as j,i as E,d as P}from"../../../vendor/vendor-core.3574f8d9.js";import{g as q}from"../../../meeting-configs.8da2e942.js";import{s as p}from"../../../vendor/vendor-screenfull.9a79c0ca.js";import{u as H,R as M,g as G,l as Q,d as J,A as K,F as Y,L as X}from"../../../live-poll.20e74c5f.js";import"../../../vendor/vendor-pusher-js.7eab09ad.js";import{a as A,S as v,q as b,t as S,d as U,v as Z,b as x,w as ee,x as I,g as B,f as te,e as se,h as ie,y as O}from"../../../app.a373aa59.js";import{g as ae,c as F,p as ne,s as oe}from"../../../media.60d422e2.js";import"../../../vendor/vendor-essential.91b5cfa2.js";import{n as $,d as k}from"../../../momentz.ae4aeebe.js";import{J as C}from"../../../vendor/vendor-others.c8ba1624.js";import{u as V}from"../../../uploader.da0c2632.js";import{L as z}from"../../../logger.45fb8d96.js";import{l as re}from"../../../live.c8d50a92.js";import{A as le}from"../../../AppLogo.91541531.js";import{n as R}from"../../../_plugin-vue2_normalizer.7b9a2fe2.js";import{b as de}from"../../../vendor/vendor-bootstrap-vue.17129278.js";import{f as ce}from"../../../form.90751a24.js";import{E as ue}from"../../../edit-config.6bf5b017.js";import"../../../vendor/vendor-vue-avatar.c0747b65.js";import"../../../vendor/vendor-vue-gtag.f8884558.js";import"../../../index.d951cdc8.js";import"../../../vendor/vendor-laravel-echo.aae8cf55.js";import"../../../event-bus.6a5776a8.js";import"../../../index.d9f9f0a3.js";import"../../../FileUploader.78ddb8c0.js";import"../../../vendor/vendor-vue-emoji-picker.16de4f23.js";import"../../../config-form.362d01c5.js";import"../../../header.43f859fb.js";const o=new z,ge=H(),W={},me={width:{max:3840,ideal:1280,min:320},height:{max:2160,ideal:720,min:180}};let u=null,L=null;const he={components:{},data(){return{initUrl:"meetings",fallBackRoute:"appMeetingList",statusMessage:"",recordingStatus:"",requestAccessStatus:"",uuid:null,prevRoute:null,meeting:{type:{},category:{},config:{},user:{},attachments:[],uuid:null,title:null,identifier:null,isHost:!1,isInstantMeeting:!1,isMeetingRoom:!1,accessibleViaLink:!1,isPam:!1,isPaid:!1,keepAlive:!1,hasEvent:!1,eventUuid:null,shouldRemind:!1,agenda:null,cover:null,description:null,startDateTime:null,period:null,plannedStartDateTime:null,hasSnapshots:!1,hasRecordings:!1,hasChunkRecordings:!1,hasTranscripts:!1,maxParticipantCount:1e3,accessibleToMembers:!1,delayed:!1,status:"scheduled",cancellationReason:null,startedAt:null,endedAt:null,estimatedEndTime:null,canModerate:!1,isBlocked:!1},meetingBackup:{},preRequisites:{},eventHandlerFns:{},pageConfigs:{autoHideFooter:!1,backgroundBlur:!1,mirroredVideo:!1},pageQueries:{callType:"",autoStart:!1,muteCamera:!1,muteMicrophone:!1,iframe:!1},meetingConfigs:{...q(),debugMode:!1,forceTurn:!1,canToggleAudio:!0,canToggleVideo:!0,lastLayout:"fullpage",recordingFormatAudio:"audio/webm",recordingFormatVideo:"video/webm",recordingTimeSlice:5e3,endTimeSnoozePeriod:1},meetingConfigsFormData:{},meetingConfigsPreRequisite:{rtcLibraries:[{uuid:"rtcmc",label:"RTCMC"}],visibilityOptions:[{uuid:"everyone",label:$t("meeting.config.everyone")},{uuid:"meeting_group_and_participants",label:$t("meeting.config.meeting_group_and_participants")},{uuid:"meeting_group",label:$t("meeting.config.meeting_group")}]},meetingRules:{sendAudio:!0,sendVideo:!0,receiveAudio:!0,receiveVideo:!0},mediaConstraints:{audio:!0,video:!0},mediaDevices:{cams:[],mics:[],speakers:[],camsLoaded:!1,micsLoaded:!1,hasWebcam:!1,hasMicrophone:!1,hasSpeaker:!1,hasWebcamPermission:!1,hasMicrophonePermission:!1,resolutions:[{uuid:"ld180p",label:"180p",constraints:{width:320,height:180,aspectRatio:1.7777777778}},{uuid:"ld240p",label:"QVGA",constraints:{width:320,height:240}},{uuid:"sd360p",label:"360p",constraints:{width:640,height:360,aspectRatio:1.7777777778}},{uuid:"sd480p",label:"VGA",constraints:{width:640,height:480}},{uuid:"sd600p",label:"SVGA",constraints:{width:800,height:600}},{uuid:"hd720p",label:"HD",constraints:{width:1280,height:720,aspectRatio:1.7777777778}},{uuid:"fhd1080p",label:"FHD",constraints:{width:1920,height:1080,aspectRatio:1.7777777778}},{uuid:"4k",label:"4K",constraints:{width:3840,height:2160,aspectRatio:1.7777777778}}]},selectedDevices:{cam:null,mic:null,speaker:null,enableCamera:!0,enableMicrophone:!0,videoMuted:!1,audioMuted:!1,facingMode:null,camDirection:"user",resolution:null},recordingConfigs:{type:"video",mimeType:"video/webm",timeSlice:5e3,disableLogs:!1},feedsList:[],membersLive:[],liveParticipants:[],polls:[],recordedFilesToUpload:[],snoozeOpts:[{uuid:5,name:5,type:"m"},{uuid:10,name:10,type:"m"},{uuid:15,name:15,type:"m"},{uuid:30,name:30,type:"m"},{uuid:60,name:1,type:"h"}],joiningRequests:[],joiningRequestsApproved:[],feedsCount:0,participantsCount:0,numberOfBroadcastViewers:0,recordingDuration:0,meetingDuration:0,isLoading:!1,isSidebarLoading:!1,isWhiteboardLoading:!1,isSilentLoading:!1,isMeetingConfigsLoading:!1,isPollsLoading:!1,isRoomOnline:!1,isMeetingLive:!1,isHandUp:!1,isSpeaking:!1,isFocused:!1,isLayoutCompact:!1,isOffline:!1,hasGreenroom:!0,greenroomStarted:!1,showParticipantsList:!1,showPollsList:!1,showPollForm:!1,showLivePoll:!1,showBulkActions:!1,showFileSharing:!1,showWhiteboard:!1,showMeetingInfo:!1,showMeetingConfigs:!1,showAgenda:!1,showFlipClock:!0,localStream:null,localBlurredStream:null,localScreenStream:null,localWhiteboardStream:null,canvasDesigner:null,autoEndingToast:null,fileSharingConnection:null,recorder:null,selectedPoll:null,livePoll:null,afterSessionIsCreated:null,canvasDesignerFilesLoaded:!1,duplicateTab:!1,hasNativeShare:!!navigator.share,stopNavigation:!1,stopNavigationMessage:""}},computed:{...j("config",["configs","uiConfigs","vars"]),user(){return{uuid:this.userUuid,username:this.username,name:this.profile.name,profile:this.profile}},startDateTimeIsFuture(){const s=this.meeting&&this.showFlipClock&&this.isStartDateTimeInFuture();return s?this.startCountDown():window.countdownInterval&&clearInterval(window.countdownInterval),s},liveMembersCount(){return this.membersLive.length-1},allFeedsCount(){const s=this.localStream?1:this.meeting.type.uuid==="webinar"||this.meeting.type.uuid==="podcast"?0:1;return this.feedsCount+s+(this.localScreenStream?1:0)+(this.localWhiteboardStream?1:0)}},watch:{},methods:{...E("config",["SetUiConfig","GetConfig"]),...E("common",["Init","Get","Custom","GetPreRequisite"]),configPageUrl(){return this.$router.resolve({name:"appMeetingSingleConfig",params:{subUuid:this.uuid}}).href},snapshotsPageUrl(){return this.$router.resolve({name:"appMeetingSnapshots",params:{uuid:this.uuid}}).href},recordingsPageUrl(){return this.$router.resolve({name:"appMeetingRecordings",params:{uuid:this.uuid}}).href},toggleFullScreen(){p.isEnabled&&(p.isFullscreen?p.exit():p.request())},toggleFooterAutoHide(){this.pageConfigs.autoHideFooter=!this.pageConfigs.autoHideFooter,this.$gaEvent("engagement","toggleAutoHideFooter")},toggleBackgroundBlur(){this.$gaEvent("engagement","toggleBackgroundBlur"),this.pageConfigs.backgroundBlur?this.unblurLocalStream():this.blurLocalStream()},toggleLayout(s){this.meetingConfigs.layout=s||this.meetingConfigs.layout,this.meetingConfigs.lastLayout=this.meetingConfigs.layout,this.meetingConfigs.layout!=="grid"&&(this.isLayoutCompact=!1,this.changeFocus()),A(`${this.vars.localStorageKey}_selected_layout`,this.meetingConfigs.layout),this.$gaEvent("engagement","toggleLayout",s)},toggleAllSidebarFalse(){this.showAgenda=!1,this.showBulkActions=!1,this.showParticipantsList=!1,this.showFileSharing=!1,this.showPollsList=!1},toggleFileSharing(){const s=this.showFileSharing;this.toggleAllSidebarFalse(),this.showFileSharing=!s,this.$gaEvent("engagement","toggleFileSharing")},toggleAgenda(){const s=this.showAgenda;this.toggleAllSidebarFalse(),this.showAgenda=!s,this.$gaEvent("engagement","toggleAgenda")},toggleMeetingConfig(){const s=this.showMeetingConfigs;this.toggleAllSidebarFalse(),s?(this.showMeetingConfigs=!1,Object.assign(this.meetingConfigsFormData,this.meetingConfigs)):(this.isMeetingConfigsLoading=!0,Object.assign(this.meetingConfigsFormData,this.meetingConfigs),this.$nextTick(()=>{this.showMeetingConfigs=!0}),window.setTimeout(()=>{this.isMeetingConfigsLoading=!1},1e3)),this.$gaEvent("engagement","toggleMeetingConfig")},toggleBulkActions(){const s=this.showBulkActions;this.toggleAllSidebarFalse(),this.showBulkActions=!s,this.$gaEvent("engagement","toggleBulkActions")},toggleParticipantsList(){const s=this.showParticipantsList;this.toggleAllSidebarFalse(),this.showParticipantsList=!s,this.$gaEvent("engagement","toggleParticipantsList")},togglePollsList(){const s=this.showPollsList;this.toggleAllSidebarFalse(),this.showPollsList=!s,this.showPollsList&&this.getPolls(),this.$gaEvent("engagement","togglePollsList")},toggleLivePoll(s){if(o.log("toggleLivePoll called",s),window.showLivePollTimer&&(clearTimeout(window.showLivePollTimer),window.showLivePollTimer=null),this.toggleAllSidebarFalse(),this.$gaEvent("engagement","toggleLivePoll"),s&&s.isResult){this.livePoll=s,window.setTimeout(()=>{this.showLivePoll=!0},1e3);return}if(s=this.isPollLive(s),this.showLivePoll||!s){this.showLivePoll=!1,window.setTimeout(()=>{this.livePoll=null},1e3);return}this.livePoll=s,window.setTimeout(()=>{const e=moment.utc(s.endAt,this.vars.serverDateTimeFormat),t=$({moment:!0,format:this.vars.serverDateTimeFormat}),i=((e.valueOf()-t.valueOf())/1e3).toFixed(0);if(i<=0){this.showLivePoll=!1,this.livePoll=null;return}this.showLivePoll=!0,o.log("Live poll will be closed in (seconds)",i),window.showLivePollTimer=window.setTimeout(()=>{this.toggleLivePoll()},1e3*i)},1e3)},toggleMeetingInfo(){this.showMeetingInfo=!this.showMeetingInfo,this.$gaEvent("engagement","toggleMeetingInfo")},toggleCompactLayout(){this.isLayoutCompact=!this.isLayoutCompact,this.$gaEvent("engagement","toggleCompactLayout")},toggleWhiteboard(){this.$gaEvent("engagement","toggleWhiteboard"),this.showWhiteboard?(this.meetingConfigs.layout=this.meetingConfigs.lastLayout,this.showWhiteboard=!1):(this.canvasDesigner||this.captureWhiteboardStream(),this.meetingConfigs.lastLayout=this.meetingConfigs.layout,this.meetingConfigs.layout="grid",this.showWhiteboard=!0)},stopWhiteboard(){formUtil.confirmAction().then(s=>{s.value?(this.meetingConfigs.layout=this.meetingConfigs.lastLayout,this.showWhiteboard=!1,this.destroyWhiteboard()):(s.dismiss,v.DismissReason.cancel)})},toggleBackgroundSize(s){const e=s.target;e.classList.contains("background-size-contain")?e.classList.remove("background-size-contain"):e.classList.add("background-size-contain")},toggleObjectFit(s){let e=null;if(s==="localStreamElement"&&this.$refs.localStreamElement){e=this.$refs.localStreamElement.parentElement,Array.from(e.children).forEach(t=>{t.classList.contains("object-fit-contain")?t.classList.remove("object-fit-contain"):t.classList.add("object-fit-contain")});return}else if(s==="localScreenStreamElement"&&this.$refs.localScreenStreamElement)e=this.$refs.localScreenStreamElement;else if(s==="localWhiteboardStreamElement"&&this.$refs.localWhiteboardStreamElement)e=this.$refs.localWhiteboardStreamElement;else if(this.feedsList.length&&s&&_.isObject(s)){const t=this.$refs.feedsElements.find(a=>a.id===s.key);if(!t)return;const i=t.getElementsByClassName(`${s.key}-video`)[0];if(!i)return;e=i}e&&(e.classList.contains("object-fit-contain")?e.classList.remove("object-fit-contain"):e.classList.add("object-fit-contain"))},changeFocus(s){if(o.log("on changeFocus",s),!!this.feedsList.length)if(this.isFocused=!1,this.feedsList.forEach(e=>{e.isFocused=!1}),s)if(this.meetingConfigs.layout==="grid"&&(this.meetingConfigs.layout="gallery"),_.isObject(s)){const e=this.feedsList.findIndex(t=>t.key===s.key);this.feedsList[e].isFocused=!0}else this.isFocused=s;else this.feedsList[0].isFocused=!0},share(){this.shareURL(null,!0)},shareURL(s,e=!1){if(!this.meeting)return;this.isLoading=!0,this.$gaEvent("engagement","shareURL","Shown");let t=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");t=t+(this.meeting.identifier?`/m/${this.meeting.identifier}`:`/app/live/meetings/${this.meeting.uuid}`);const i=this.meeting.identifier?`<span class="text-nowrap">${$t("meeting.meeting_code")}:</span> <strong class="ml-2 text-wrap-pre-line text-word-break-all"> ${this.meeting.identifier}</strong>`:null,a=(n=`${$t("misc.share_alert.text")}<br><small class='text-muted'>${t}</small><br>`,r)=>{oe({title:$t("meeting.user_inviting_msg",{attribute:this.user.name}),file:r?{dataUrl:r,name:"meeting.png"}:null,alertTitle:i,alertHtml:n,url:t},()=>{this.$gaEvent("engagement","shareURL","Copied"),this.$toasted.success($t("meeting.url_has_been_copied"),this.$toastConfig)},e)};ae({data:t,icon:this.configs.assets.iconMaskable,success:n=>{!this.isLoading||(this.isLoading=!1,window.shareShownConfirmTimer&&(clearTimeout(window.shareShownConfirmTimer),window.shareShownConfirmTimer=null),a(`<img class='img-thumbnail' src='${n}'/><br><br>${$t("misc.share_alert.text")}<br><small class='text-muted'>${t}</small><br>`,n))},error:()=>{!this.isLoading||(this.isLoading=!1,window.shareShownConfirmTimer&&(clearTimeout(window.shareShownConfirmTimer),window.shareShownConfirmTimer=null),a())}}),window.shareShownConfirmTimer=window.setTimeout(()=>{this.isLoading&&(this.isLoading=!1,a())},5e3)},toggleHandUp(){this.$gaEvent("engagement","toggleHandUp"),window.lowerHandTimer&&(clearTimeout(window.lowerHandTimer),window.lowerHandTimer=null),(this.meetingRules.sendAudio||this.meetingRules.sendVideo)&&(this.isHandUp=!this.isHandUp,u.sendMessage({event:"remoteHandToggled",data:{id:this.localStream?this.localStream.id:null,userUuid:this.user.uuid,isHandUp:this.isHandUp}}),this.isHandUp&&(window.lowerHandTimer=window.setTimeout(()=>{this.toggleHandUp()},3e4)))},takeSnapshotOfStream(s,e=!1){if(!this.meetingConfigs.canTakeSnapshot)return;this.$gaEvent("engagement","takeSnapshot");let t=null,i=`${this.user.username} stream by self`,a=!1;if(e){if(t=this.$refs[s],!t)return;a=s==="localScreenStreamElement"||s==="localWhiteboardStreamElement"?!1:this.pageConfigs.mirroredVideo}else{const r=this.$refs.feedsElements.find(d=>d.id===s.key);if(!r)return;t=r.getElementsByClassName(`${s.key}-video`)[0],i=`${s.user.username} stream by ${this.user.username}`,a=s.mirroredVideo}const n=this.takeSnapshot(t,a);if(F(),this.meeting.canModerate||this.meetingConfigs.anyoneCanTakeSnapshot)this.meetingAction({action:"snapshots",loaderVar:"isSilentLoading",method:"post",data:{image:n,name:i},callback:r=>{this.$toasted.info($t("meeting.snapshot_taken"),{...this.$toastConfig.info,duration:1e4,icon:{name:"fa-download"},action:{text:"View / Download",href:r.fullUrl,target:"_blank"}}),this.isSilentLoading=!1}}),this.informAboutSnapshot(s);else if(e){const r=new Image;r.src=n,window.open("").document.write(r.outerHTML)}},takeSnapshot(s,e){let t=document.createElement("canvas");t.id="snapshotCanvas";let i=null,a=t.getContext("2d");const n=()=>{const r=(s.videoWidth||s.clientWidth)/(s.videoHeight||s.clientHeight),d=s.videoWidth-100,l=parseInt(d/r,10);t.width=d*2,t.height=l*2,e&&(a.translate(t.width,0),a.scale(-1,1))};return n(),a.drawImage(s,0,0,t.width,t.height),i=t.toDataURL("image/png"),s.srcObject,this.eventHandlerFns.loadedmetadataFn=()=>{n(),a.drawImage(s,0,0,t.width,t.height),i=t.toDataURL("image/png")},s.addEventListener("loadedmetadata",this.eventHandlerFns.loadedmetadataFn),window.setTimeout(()=>{s.removeEventListener("loadedmetadata",this.eventHandlerFns.loadedmetadataFn),this.eventHandlerFns.loadedmetadataFn=null,t=null},1e3),i},banRemoteUser(s){!this.feedsList.length||!s||(formUtil.confirmAction().then(e=>{e.value?this.feedsList.find(i=>i.key===s.key)&&(u.sendMessage({event:"userBanned",data:s}),this.Custom({url:`/${this.initUrl}/${this.uuid}/invitees/${s.user.uuid}/block`,method:"post"}).then(i=>{this.$toasted.success(i.message,this.$toastConfig)}).catch(i=>{o.error("error: ",i),formUtil.handleErrors(i)})):(e.dismiss,v.DismissReason.cancel)}),_.isObject(s)?this.feedsList[selectedIndex].isFocused=!0:this.isFocused=s)},toggleRemoteAVSource(s,e="audio",t="temporary",i=!1){if(!this.feedsList.length||!e)return;if(!s){this.showBulkActions=!1,t==="permanent"&&((!e||e==="both"||e==="audio")&&this.feedsList.forEach(n=>{n.canToggleAudio=i}),(!e||e==="both"||e==="video")&&this.feedsList.forEach(n=>{n.canToggleVideo=i})),u.sendMessage({event:"toggleRemoteAV",data:{userUuid:"all",target:e,type:t,enable:i},callback:()=>{this.$toasted.success($t("meeting.action_successful"),this.$toastConfig)}});return}const a=this.feedsList.findIndex(n=>n.key===s.key);a!==-1&&(t==="permanent"&&((!e||e==="both"||e==="audio")&&(this.feedsList[a].canToggleAudio=i),(!e||e==="both"||e==="video")&&(this.feedsList[a].canToggleVideo=i)),u.sendMessage({event:"toggleRemoteAV",data:{userUuid:s.user.uuid,target:e,type:t,enable:i},callback:()=>{this.$toasted.success($t("meeting.action_successful"),this.$toastConfig)}}))},informAboutSnapshot(s){this.meetingConfigs.enableSnapshotAlert&&u.sendMessage({event:"snapshotTaken",data:{byUser:this.user,ofUser:s.extra,item:s}})},informAboutMeetingUpdate(s){!this.meeting.canModerate||u.sendMessage({event:"meetingUpdated",data:s})},isStartDateTimeInFuture(){var s;return!!(((s=this.meeting)==null?void 0:s.startDateTime)&&moment.utc(this.meeting.startDateTime,this.vars.serverDateTimeFormat).isAfter($({moment:!0,format:this.vars.serverDateTimeFormat})))},startCountDown(){window.countdownInterval&&clearInterval(window.countdownInterval),window.countdownInterval=window.setInterval(()=>{this.isStartDateTimeInFuture()?this.showFlipClock=!0:(this.showFlipClock&&!document.hasFocus()&&ne(),this.showFlipClock=!1)},1e3)},stopKeepAlivePolling(){window.meetingKeepAliveTimer&&(clearInterval(window.meetingKeepAliveTimer),window.meetingKeepAliveTimer=null)},startKeepAlivePolling(){window.meetingKeepAliveTimer&&(clearInterval(window.meetingKeepAliveTimer),window.meetingKeepAliveTimer=null),!(!this.meeting||this.meeting.status!=="live")&&(window.meetingKeepAliveTimer=setInterval(()=>{this.meetingAction({action:"keep-alive",loaderVar:"isSilentLoading",silent:!0})},3e5))},stopAutoEndMeeting(){window.autoEndMeetingTimeout&&(clearTimeout(window.autoEndMeetingTimeout),window.autoEndMeetingTimeout=null),this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(b.close(),this.autoEndingToast=null)},startAutoEndMeeting(s=300){window.autoEndMeetingTimeout&&(clearTimeout(window.autoEndMeetingTimeout),window.autoEndMeetingTimeout=null),window.autoEndMeetingTimeout=window.setTimeout(()=>{this.meeting.canModerate?this.endMeeting(!1):this.getOffline(!1)},1e3*s)},startMeetingTimer(){if(window.meetingDurationInterval&&(this.meetingDuration=null,clearInterval(window.meetingDurationInterval)),!this.meeting||this.meeting.status!=="live")return;const s=()=>{if(!this.meeting||this.meeting.status!=="live"){this.stopAutoEndMeeting(),this.stopMeetingTimer();return}if(this.meetingConfigs.autoEndMeeting&&this.meeting.estimatedEndTime){const t=this.meetingConfigs.alertBeforeAutoEndTime||5,i=moment.utc(this.meeting.estimatedEndTime,this.vars.serverDateTimeFormat),a=$({moment:!0,format:this.vars.serverDateTimeFormat}),n=((i.valueOf()-a.valueOf())/1e3).toFixed(0);if(n<=0)window.autoEndMeetingTimeout&&(clearInterval(window.autoEndMeetingTimeout),window.autoEndMeetingTimeout=null),this.meeting.canModerate?this.endMeeting(!1):this.getOffline(!1);else if(n<=t*60){let r=S(n)+" "+$t("list.general.durations.seconds");if(n>=60?r=S(n)+" "+$t("list.general.durations.minutes"):n>=3600&&(r=S(n)+" "+$t("list.general.durations.hours")),this.meetingConfigs.alertBeforeAutoEnd)if(window.autoEndMeetingTimeout&&this.autoEndingToast&&v.isVisible()&&v.isTimerRunning())b.update({title:$t("meeting.auto_ending_msg",{attribute:r})});else{if(!this.autoEndingToast&&v.isVisible())return;if(this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(b.close(),this.autoEndingToast=null),this.meeting.canModerate){let d={iconHtml:'<i class="far fa-clock"></i>',title:$t("meeting.auto_ending_msg",{attribute:r}),timer:n*1e3,showConfirmButton:!1,showDenyButton:!1,position:"bottom"};this.meetingConfigs.canSnoozeAutoEnd&&(d.showConfirmButton=!0,d.confirmButtonText=$t("meeting.snooze")),this.meetingConfigs.canCancelAutoEnd&&(d.showDenyButton=!0,d.denyButtonText=$t("meeting.keep_meeting_live")),this.autoEndingToast=b.fire(d).then(l=>{l.isConfirmed&&this.meetingConfigs.canSnoozeAutoEnd?(this.stopAutoEndMeeting(),this.meeting.estimatedEndTime=moment.utc(this.meeting.estimatedEndTime,this.vars.serverDateTimeFormat).add(10,"minutes").format(this.vars.serverDateTimeFormat),this.meetingAction("snooze-end-time",{period:this.meetingConfigs.endTimeSnoozePeriod||5},{alert:!1,inform:{endTimeSnoozed:!0}}),b.close(),this.autoEndingToast=null):l.isDenied&&this.meetingConfigs.canCancelAutoEnd&&(this.stopAutoEndMeeting(),this.meetingConfigs.autoEndMeeting=!1,this.meetingAction("cancel-auto-end",null,{alert:!1,inform:{autoEndCancelled:!0}}),b.close(),this.autoEndingToast=null)})}else this.autoEndingToast=b.fire({iconHtml:'<i class="far fa-clock"></i>',title:$t("meeting.auto_ending_msg",{attribute:r}),timer:n*1e3,showConfirmButton:!1,position:"bottom"})}window.autoEndMeetingTimeout&&this.autoEndingToast||(this.stopAutoEndMeeting(),this.startAutoEndMeeting(n))}else n>t*60?this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(b.close(),this.autoEndingToast=null):this.stopAutoEndMeeting()}},e=moment.utc(this.meeting.startedAt,this.vars.serverDateTimeFormat).valueOf();window.meetingDurationInterval=window.setInterval(()=>{const t=$({moment:!0,format:this.vars.serverDateTimeFormat}).valueOf();this.meetingDuration=S((t-e)/1e3),this.pageQueries.iframe||this.pageQueries.autoStart||this.pageQueries.callType||s()},1e3)},stopMeetingTimer(){window.meetingDurationInterval&&(this.meetingDuration=null,clearInterval(window.meetingDurationInterval))},reportAnIssue(){const s={meeting:this.meeting,meetingRules:this.meetingRules,meetingConfigs:this.meetingConfigs,pageConfigs:this.pageConfigs,mediaConstraints:this.mediaConstraints,mediaDevices:this.mediaDevices,selectedDevices:this.selectedDevices,feedsList:this.feedsList,DetectRTC:W};this.meeting.canModerate?(o.log(s),U('"'+JSON.stringify(s)+'"')):U('"'+window.btoa(JSON.stringify(s))+'"'),this.$toasted.success($t("general.report_an_issue_success"),this.$toastConfig)},editPoll(s){this.selectedPoll=s,this.showPollForm=!0},closePollForm(){this.showPollForm=!1,this.selectedPoll=null,this.getPolls()},isPollLive(s){return s&&s.isPublished&&s.startAt&&(s.startAt=k(s.startAt,this.vars.serverDateTimeFormat),s.endAt=s.endAt?k(s.endAt,this.vars.serverDateTimeFormat):k(moment(s.startAt,this.vars.serverDateTimeFormat).add(s.duration,"seconds"),this.vars.serverDateTimeFormat),!!moment.utc(s.endAt,this.vars.serverDateTimeFormat).isAfter($({moment:!0,format:this.vars.serverDateTimeFormat})))?s:!1},anyLivePoll(){o.log("anyLivePoll called",this.polls);const s=this.polls[0];s&&s.isPublished&&!s.isResult&&this.toggleLivePoll(s)},showPollResult(s){!s||(s.options.forEach((e,t)=>{if(s.result){const i=s.result.find(a=>a.uuid===e.uuid);Object.assign(s.options[t],i)}s.correctAnswer&&e.uuid===s.correctAnswer.uuid&&(s.options[t].selected=!0),s.submittedAnswer&&e.uuid===s.submittedAnswer.uuid&&(s.options[t].answered=!0)}),this.toggleLivePoll(s))},autoOpenChat(){!(this.pageQueries.iframe||this.pageQueries.autoStart||this.pageQueries.callType)||this.meetingConfigs&&this.meetingConfigs.enableChat&&this.meetingConfigs.autoOpenChat&&this.configs.chat&&this.configs.chat.enabled&&window.setTimeout(()=>{this.toggleChatBox()},1500)},addStreamToRecord(s){if(!(this.meetingConfigs.canRecord&&this.meeting.canModerate&&this.recordingStatus==="started"&&s)||this.meetingConfigs.rtcLibrary==="janus")return;const e=this.recorder;if(e){const t=e.getInternalRecorder();t&&t.addStreams(s)}},startRecording(s,e=null){if(this.$gaEvent("engagement","startRecording"),!(this.meetingConfigs.canRecord&&this.meeting.canModerate))return;this.recordingStatus="started",this.recordingConfigs.disableLogs=!this.meetingConfigs.debugMode;const t=()=>{const l=new Date().getTime();window.recordingDurationInterval&&(this.recordingDuration=null,clearInterval(window.recordingDurationInterval)),window.recordingDurationInterval=window.setInterval(()=>{this.recordingDuration=S((new Date().getTime()-l)/1e3)},1e3)};if(this.meetingConfigs.rtcLibrary==="janus")return;let i=this.recorder;if(i)return;let a=[],n=[];const r=uuid();u.getAllStreams().forEach(l=>{a.push(l.stream)});const d=this.getLocalStreamToPublish();d.stream&&a.push(d.stream),this.localScreenStream&&a.push(this.localScreenStream),this.localWhiteboardStream&&a.push(this.localWhiteboardStream),this.meetingConfigs.autoUploadRecording&&(this.recordingConfigs.ondataavailable=l=>{n.push(l),this.uploadRecording({uuid:r,chunk:!0,blob:l,order:n.length})}),i=M(a,this.recordingConfigs),this.recorder=i,i.startRecording(),t()},pauseRecording(){if(this.$gaEvent("engagement","pauseRecording"),this.meetingConfigs.rtcLibrary==="janus")return;const s=this.recorder;if(!s){this.$toasted.error("No recorder found!",this.$toastConfig.error);return}this.recordingStatus="paused",s.pauseRecording(),window.recordingDurationInterval&&clearInterval(window.recordingDurationInterval)},resumeRecording(){this.$gaEvent("engagement","resumeRecording");const s=this.recorder;if(!s){this.$toasted.error("No recorder found!",this.$toastConfig.error);return}this.recordingStatus="started",s.resumeRecording();const e=new Date().getTime(),t=Z(this.recordingDuration||"00:00");window.recordingDurationInterval&&clearInterval(window.recordingDurationInterval),window.recordingDurationInterval=window.setInterval(()=>{this.recordingDuration=S(t+(new Date().getTime()-e)/1e3)},1e3)},stopRecording(){if(this.$gaEvent("engagement","stopRecording"),this.meetingConfigs.rtcLibrary==="janus")return;this.checkPendingUploads();const s=this.recorder;if(!s){this.$toasted.error("No recorder found!",this.$toastConfig.error);return}this.recordingStatus="ended",s.stopRecording(()=>{window.recordingDurationInterval&&(this.recordingDuration=null,clearInterval(window.recordingDurationInterval),window.recordingDurationInterval=null);const e=($t("meeting.meeting_recording")+"-"+$({moment:!0,format:this.vars.serverDateTimeFormat}).unix()).kebabCase()+".webm";M.getSeekableBlob(s.getBlob(),t=>{this.checkPendingUploads(),this.meetingConfigs.autoUploadRecording?(s.reset(),this.recorder=null):this.meetingConfigs.autoUploadRecorded?this.uploadRecorded(t,s,e):x.fire({title:$t("meeting.recorded_meeting"),allowOutsideClick:!1,allowEscapeKey:!1,position:"bottom",showDenyButton:!0,showCancelButton:!0,confirmButtonText:`<i class="fas fa-download"></i> ${$t("general.download")}`,denyButtonText:`<i class="fas fa-upload"></i> ${$t("general.upload")}`,cancelButtonText:`${$t("general.cancel")}`,customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger",denyButton:"btn btn-primary"}}).then(i=>{if(i.isConfirmed){const a=URL.createObjectURL(t),n=document.createElement("a");M.invokeSaveAsDialog(t,e),n.style.display="none",n.href=a,n.download=e,document.body.appendChild(n),window.setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(n),this.recordingStatus=""},100),s.reset(),this.recorder=null,this.checkPendingUploads()}else if(i.isDenied)this.uploadRecorded(t,s,e),this.checkPendingUploads();else{i.dismiss,v.DismissReason.cancel,s.reset(),this.recorder=null,this.checkPendingUploads();return}}),this.checkPendingUploads()})})},checkPendingUploads:_.throttle(function(){this.recordedFilesToUpload.filter(e=>e.status==="waiting"||e.status==="uploading").length?(this.stopNavigation=!0,this.stopNavigationMessage=$t("meeting.uploads_pending_message")):(this.stopNavigation=!1,this.stopNavigationMessage=""),this.uploadRecording()},500,{leading:!0,trailing:!1}),uploadRecording(s){const e=_.throttle(()=>{const i=this.recordedFilesToUpload.filter(n=>n.status==="waiting"&&n.chunk),a=this.recordedFilesToUpload.filter(n=>n.status==="uploading"&&n.chunk);if(i.length){let n=[];const r=P.CancelToken;let l=5-a.length;for(let g=this.recordedFilesToUpload.length-1;g>=0&&l>0;g--){const c=this.recordedFilesToUpload[g];if(n[g]=m=>{c.progress=Math.round(m.loaded*100/m.total)},c.status==="waiting"){l=l-1;let m=new FormData;m.append("file",c.blob),m.append("mime",c.mime),m.append("request_uuid",c.requestUuid),m.append("order",c.order),m.append("chunk",c.chunk),c.status="uploading";let h=new r(f=>{c.cancel=f});V({url:`/${this.initUrl}/${this.uuid}/recordings`,data:m,silent:!0},n[g],h).then(f=>{c.status="uploaded",delete c.cancel,this.checkPendingUploads(),window.setTimeout(()=>{delete this.recordedFilesToUpload.splice(this.recordedFilesToUpload.findIndex(y=>y.uuid===c.uuid),1),this.checkPendingUploads()},3e3)}).catch(f=>{if(f.response&&f.response.data){const y=f.response.data||{},w=y.errors?formUtil.assignErrors(y.errors):{};c.error=w.message,c.status="error"}else c.status="cancelled";this.checkPendingUploads()})}}}},1e3,{leading:!0,trailing:!1});if(!s||!s.uuid){e();return}const t=($t("meeting.meeting_recording")+"-"+$({moment:!0,format:this.vars.serverDateTimeFormat}).unix()).kebabCase()+".webm";this.recordedFilesToUpload||(this.recordedFilesToUpload=[]),this.recordedFilesToUpload.unshift({uuid:uuid(),chunk:s.chunk,blob:s.blob,mime:s.blob.type,requestUuid:s.uuid,order:s.order,status:"waiting",name:t,progress:0,error:null,download:null}),e(),this.checkPendingUploads()},uploadRecorded(s,e,t){const i=()=>{if(this.recordedFilesToUpload.filter(l=>l.status==="waiting"&&!l.chunk).length){let l=[];const g=P.CancelToken;this.recordedFilesToUpload.forEach((c,m)=>{const h=this.recordedFilesToUpload[m];if(h.download=a,l[m]=f=>{h.progress=Math.round(f.loaded*100/f.total)},h.status==="waiting"){let f=new FormData;f.append("file",h.file),f.append("mime",h.file.type),f.append("request_uuid",h.uuid),h.status="uploading";let y=new g(w=>{h.cancel=w});V({url:`/${this.initUrl}/${this.uuid}/recordings`,data:f,silent:!0},l[m],y).then(w=>{h.status="uploaded",delete h.cancel,this.checkPendingUploads(),window.setTimeout(()=>{delete this.recordedFilesToUpload.splice(this.recordedFilesToUpload.findIndex(T=>T.uuid===h.uuid),1),this.checkPendingUploads()},3e3)}).catch(w=>{if(w.response&&w.response.data){const T=w.response.data||{},D=T.errors?formUtil.assignErrors(T.errors):{};h.error=D.message,h.status="error",this.$toasted.error(D.message,this.$toastConfig.error)}else h.status="cancelled";this.checkPendingUploads()})}})}},a=d=>{const l=URL.createObjectURL(d),g=document.createElement("a");M.invokeSaveAsDialog(d,t),g.style.display="none",g.href=l,g.download=t,document.body.appendChild(g),window.setTimeout(()=>{document.body.removeChild(g),window.URL.revokeObjectURL(g),this.recorded=!1},100)},n=this.recordingConfigs&&this.recordingConfigs.mimeType?this.recordingConfigs.mimeType:"video/webm",r=new File([s],t,{type:n});r.size>this.configs.system.postMaxSize?this.$toasted.error(this.$t("global.file_too_large",{attribute:r.name}),this.$toastConfig.error):(this.recordedFilesToUpload||(this.recordedFilesToUpload=[]),this.recordedFilesToUpload.unshift({uuid:uuid(),chunk:!1,blob:s,file:r,status:"waiting",progress:0,error:null}),i()),this.checkPendingUploads(),e.reset(),this.recorder=null},stopStream(s){if(!!s)try{s.getTracks().forEach(e=>{e.enabled=!1,e.stop()})}catch(e){o.error(e)}},captureLocalStream({success:s,failed:e}){var n,r,d;if(A(`${this.vars.localStorageKey}_selected_device`,this.selectedDevices),this.meetingRules.sendVideo||(this.selectedDevices.enableCamera=!1),this.meetingRules.sendAudio||(this.selectedDevices.enableMicrophone=!1),this.mediaConstraints.video=this.selectedDevices.enableCamera,this.mediaConstraints.audio=this.selectedDevices.enableMicrophone,!this.mediaConstraints.video&&!this.mediaConstraints.audio){this.stopStream(this.localStream||((n=this.$refs.localStreamElement)==null?void 0:n.srcObject)),this.localStream=null,this.$refs.localStreamElement&&(this.$refs.localStreamElement.srcObject=null),_.isFunction(s)&&s();return}const t=(r=this.selectedDevices.mic)==null?void 0:r.deviceId,i=(d=this.selectedDevices.cam)==null?void 0:d.deviceId;let a={};if(this.mediaConstraints.audio&&(a.audio={deviceId:t?{exact:t}:void 0}),this.mediaConstraints.video){if(a.video={...me},this.selectedDevices.resolution){const l=this.mediaDevices.resolutions.find(g=>g.uuid===this.selectedDevices.resolution);l&&(a.video.width={exact:l.constraints.width},a.video.height={exact:l.constraints.height})}this.selectedDevices.facingMode?a.video.facingMode={exact:this.selectedDevices.facingMode}:a.video.deviceId=i?{exact:i}:void 0}o.log("captureLocalStream gumConstraints",a),navigator.mediaDevices.getUserMedia(a).then(l=>{var c;const g=this.localStream||((c=this.$refs.localStreamElement)==null?void 0:c.srcObject);return this.localStream=l,window.capturedLocalStream=l,this.$refs.localStreamElement&&(this.$refs.localStreamElement.srcObject=l,this.$refs.localStreamElement.controls=!1),window.setTimeout(()=>{this.stopStream(g)},3e3),_.isFunction(s)&&s(l),l}).catch(l=>{_.isFunction(s)&&e(l),o.error("getUserMedia error: ",l.message,l.name),l.name==="NotFoundError"||l.name==="NotReadableError"?this.$toasted.error($t("meeting.media_devices.not_found_or_unreadable"),this.$toastConfig.error):l.name==="OverconstrainedError"?(this.$toasted.error($t("meeting.media_devices.reset_and_try_again"),this.$toastConfig.error),this.selectedDevices.resolution=null):l.name==="NotAllowedError"||l.name==="PermissionDeniedError"?this.$toasted.error($t("meeting.media_devices.permission_denied"),this.$toastConfig.error):this.$toasted.error($t("meeting.media_devices.unknown_error"),this.$toastConfig.error),ee(`${this.vars.localStorageKey}_selected_device`)})},startGreenroom(s={}){o.log("StartGreenroom called!"),this.statusMessage=this.$t("meeting.status_message.connecting"),this.greenroomStarted||this.checkLastSelectedDevices(),this.captureLocalStream({success:(e=null)=>{this.greenroomStarted=!0,this.statusMessage=this.$t("meeting.status_message.ready"),_.isFunction(s.callback)&&s.callback(e)},failed:e=>{o.error(e),this.statusMessage=this.$t("meeting.status_message.failed")}})},updateGreenroom(){this.startGreenroom({callback:(s=null)=>{!this.isMeetingLive||this.localBlurredStream||(this.statusMessage=$t("meeting.status_message.live"),this.updatePublishedFeed({stream:this.localStream,info:{from:"cam",mirroredVideo:this.pageConfigs.mirroredVideo},mediaConstraints:this.mediaConstraints}))}})},toggleLocalCamera(s,e){this.statusMessage=this.$t("meeting.status_message.connecting"),this.localBlurredStream&&!e&&this.unblurLocalStream(),this.selectedDevices.enableCamera=e!=null?e:!this.selectedDevices.enableCamera,this.updateGreenroom()},toggleLocalMicrophone(s,e){this.statusMessage=this.$t("meeting.status_message.connecting"),this.selectedDevices.enableMicrophone=e!=null?e:!this.selectedDevices.enableMicrophone,this.updateGreenroom()},changeLocalVideoDevice(s=null){this.statusMessage=this.$t("meeting.status_message.changing_device"),this.selectedDevices.cam=s,this.selectedDevices.enableCamera=!0,this.selectedDevices.facingMode=null,s.label&&(this.selectedDevices.camDirection=/front/i.test(s.label)?"user":/rear/i.test(s.label)||/back/i.test(s.label)?"environment":null),this.updateGreenroom()},changeLocalVideoResolution(s=null){this.statusMessage=this.$t("meeting.status_message.changing_device"),this.selectedDevices.resolution=this.selectedDevices.resolution===s.uuid?null:s.uuid,this.selectedDevices.enableCamera=!0,this.updateGreenroom()},changeLocalAudioDevice(s=null){this.statusMessage=this.$t("meeting.status_message.changing_device"),this.selectedDevices.mic=s,this.selectedDevices.enableMicrophone=!0,this.updateGreenroom()},switchFacingMode(){this.statusMessage=this.$t("meeting.status_message.changing_device"),this.selectedDevices.cam&&this.selectedDevices.cam.label&&(this.selectedDevices.facingMode=/front/i.test(device.label)?"user":/rear/i.test(device.label)||/back/i.test(device.label)?"environment":null),this.selectedDevices.facingMode=this.selectedDevices.facingMode==="user"?"environment":"user",this.selectedDevices.camDirection=this.selectedDevices.facingMode,this.selectedDevices.cam=null,this.selectedDevices.resolution=null,this.selectedDevices.enableCamera=!0,this.updateGreenroom()},blurLocalStream(){const s=this,e=this.$refs.localStreamElement,t=this.$refs.localBlurredStreamElement;let i=!0;const a=t.getContext("2d");this.pageConfigs.backgroundBlur=!0,(()=>{const c=e.videoWidth||e.clientWidth,m=e.videoHeight||e.clientHeight;e.width=c,e.height=m,t.width=c,t.height=m})(),a.fillStyle="black",a.fillRect(0,0,t.width,t.height),e.addEventListener("playing",c=>{i=!0}),e.addEventListener("emptied",c=>{i=!1}),e.addEventListener("suspend",c=>{i=!1}),e.addEventListener("ended",c=>{o.log("videoElement: ended",c)}),e.addEventListener("pause",c=>{o.log("videoElement: pause",c)}),e.addEventListener("play",c=>{o.log("videoElement: play",c)}),e.addEventListener("waiting",c=>{o.log("videoElement: waiting",c)});const r=async()=>{try{G(),L=await Q({architecture:"MobileNetV1",multiplier:.75,outputStride:16,quantBytes:2}),this.localBlurredStream=t.captureStream();const c=this.localStream.getAudioTracks()[0];this.localBlurredStream&&c&&(o.log("blurLocalStream - Audio Track added!"),this.localBlurredStream.addTrack(c.clone())),this.isMeetingLive&&this.updatePublishedFeed({stream:this.localBlurredStream,info:{from:"cam",mirroredVideo:!1},mediaConstraints:this.mediaConstraints,action:"blur"}),g(L)}catch(c){o.error(c)}},d=10,l=3,g=async c=>{for(;s.pageConfigs.backgroundBlur&&c&&s.selectedDevices.enableCamera&&i;){const m=await c.segmentPerson(e,{flipHorizontal:!1,internalResolution:"medium",segmentationThreshold:.7,maxDetections:3,scoreThreshold:.2,nmsRadius:20,minKeypointScore:.3,refineSteps:10});J(t,e,m,d,l,s.pageConfigs.mirroredVideo)}s.pageConfigs.backgroundBlur&&c&&s.selectedDevices.enableCamera?window.setTimeout(()=>{g(c)},1e3):this.unblurLocalStream()};r()},unblurLocalStream(){if(this.pageConfigs.backgroundBlur=!1,L&&(L.dispose(),L=null),this.localBlurredStream){const s=this.localBlurredStream;this.localBlurredStream=null,this.isMeetingLive&&this.updateGreenroom(),window.setTimeout(()=>{s.getVideoTracks().forEach(e=>{e.enabled=!1,e.stop()})},1e3)}},captureScreenStream({constraints:s,success:e,failed:t}){this.stopSharingScreen();let i=s||{video:{cursor:"always"},audio:!1};navigator.mediaDevices.getDisplayMedia(i).then(a=>{this.localScreenStream=a,this.$refs.localScreenStreamElement&&(this.$refs.localScreenStreamElement.srcObject=a,this.$refs.localScreenStreamElement.controls=!1),_.isFunction(e)&&e(a)}).catch(a=>{_.isFunction(e)&&t(a),o.log("getDisplayMedia error: ",a.message,a.name)})},shareScreen(){this.captureScreenStream({success:s=>{s.getTracks().forEach(e=>{e.addEventListener("ended",this.stopSharingScreen)}),this.publishFeed({stream:this.localScreenStream,info:{from:"screen",mirroredVideo:!1},callback:()=>{this.addStreamToRecord(this.localScreenStream)}})},failed:s=>{this.statusMessage=this.$t("meeting.status_message.failed")}})},stopSharingScreen(){var e;o.log("stopSharingScreen called");const s=this.localScreenStream||((e=this.$refs.localScreenStreamElement)==null?void 0:e.srcObject);!s||(this.updatePublishedFeed({stream:!1,info:{from:"screen",mirroredVideo:!1},action:"remove"}),window.setTimeout(()=>{try{s.getTracks().forEach(t=>{o.log("stopSharingScreen called - screenStream tracks stopping"),t.removeEventListener("ended",this.stopSharingScreen),t.enabled=!1,t.stop()})}catch(t){o.error(t)}},1e3),this.localScreenStream=null,this.$refs.localScreenStreamElement&&(this.$refs.localScreenStreamElement.srcObject=null))},captureWhiteboardStream(){this.isWhiteboardLoading=!0,this.canvasDesigner||this.initCanvasDesigner();const s=(i="main-canvas")=>{const a=this.canvasDesigner.iframe;if(!a)return;const n=a.contentDocument?a.contentDocument:a.contentWindow.document;return n?n.getElementById(i):void 0},e=(i=!1)=>{const a=d=>{!d||d.getContext("2d")},n=s();a(n);const r=s("temp-canvas");a(r)},t=i=>{!i||(this.localWhiteboardStream=i,this.$refs.localWhiteboardStreamElement&&(this.$refs.localWhiteboardStreamElement.srcObject=i,this.$refs.localWhiteboardStreamElement.controls=!1),this.meetingConfigs.rtcLibrary==="janus"&&this.localWhiteboardStream.getTracks().forEach(a=>{a.addEventListener("mute",n=>{e(!0)})}),e(),this.publishFeed({stream:this.localWhiteboardStream,info:{from:"whiteboard",mirroredVideo:!1},callback:()=>{window.setTimeout(()=>{e()},2e3),this.addStreamToRecord(this.localWhiteboardStream)}}))};if(!this.$refs.whiteboard||!CanvasDesigner){this.isWhiteboardLoading=!1;return}this.meetingConfigs.whiteboardCollaboration&&this.canvasDesigner.addSyncListener(i=>{u.sendMessage({type:"whiteboard",data:i})}),this.canvasDesigner.setSelected("pencil"),this.canvasDesigner.setTools({pencil:!0,text:!0,image:!0,pdf:!0,eraser:!0,line:!0,arrow:!0,dragSingle:!0,dragMultiple:!0,arc:!0,rectangle:!0,quadratic:!0,bezier:!1,marker:!0,zoom:!1,lineWidth:!0,colorsPicker:!0,extraOptions:!1,code:!1,undo:!0}),this.canvasDesigner.iframe?this.isWhiteboardLoading=!1:this.canvasDesigner.appendTo(this.$refs.whiteboard,()=>{if(e(),this.meetingConfigs.whiteboardCollaboration){if(!this.feedsList.find(a=>a.isWhiteboard)){const a=s();t(a.captureStream(30))}window.setTimeout(()=>{o.log("sync-canvas-points"),u.sendMessage({type:"whiteboard",data:"sync-canvas-points"}),this.isWhiteboardLoading=!1},3e3)}else{const i=s();t(i.captureStream(30)),this.isWhiteboardLoading=!1}})},destroyWhiteboard(){var e;this.canvasDesigner&&(this.canvasDesigner.destroy(),this.canvasDesigner=null);const s=this.localWhiteboardStream||((e=this.$refs.localWhiteboardStreamElement)==null?void 0:e.srcObject);!s||(this.updatePublishedFeed({stream:!1,info:{from:"whiteboard",mirroredVideo:!1},action:"remove"}),this.stopStream(s),this.localWhiteboardStream=null,this.$refs.localWhiteboardStreamElement&&(this.$refs.localWhiteboardStreamElement.srcObject=null))},handlePlay(s){if(!this.feedsList.length||!s)return;const e=this.feedsList.findIndex(t=>t.key===s.key);this.feedsList[e].playing=!0},playStream(s){if(!this.feedsList.length||!s)return;const e=this.feedsList.findIndex(n=>n.key===s.key);this.feedsList[e].playing=!this.feedsList[e].playing;const t=this.$refs.feedsElements;if(!t)return;const i=t.find(n=>n.id===s.key);if(!i)return;const a=i.getElementsByClassName(`${s.key}-video`)[0];a&&a.play()},refreshStreams(){if(!this.feedsList.length)return;this.isLoading=!0;const s=_.cloneDeep(this.feedsList);this.feedsList.splice(0),window.setTimeout(()=>{this.isLoading=!1,s&&s.length&&s.forEach(e=>{this.feedsList.push(e);const t=_.cloneDeep(e);this.$nextTick(()=>{window.setTimeout(()=>{this.setFeedElementSrc({feed:t,audioTrack:t.audio,videoTrack:t.video})},500)})})},1e3)},toggleRemoteAudio(s){if(!this.feedsList.length||!s)return;const e=this.feedsList.findIndex(n=>n.key===s.key);this.feedsList[e].audioMuted=!this.feedsList[e].audioMuted;const t=this.$refs.feedsElements;if(!t)return;const i=t.find(n=>n.id===s.key);if(!i)return;const a=i.getElementsByClassName(`${s.key}-video`)[0];a&&(a.muted=this.feedsList[e].audioMuted)},getRTCSessionOptions(){return{room:this.meeting.roomId,user:this.user,config:{maxParticipants:this.meetingConfigs.maxParticipantCount,...this.pageConfigs},meeting:this.meeting,meetingRules:this.meetingRules,meetingConfigs:this.meetingConfigs,mediaConstraints:this.mediaConstraints}},getLocalStreamToPublish(){let s=this.localStream,e=this.pageConfigs.mirroredVideo;return this.pageConfigs.backgroundBlur&&this.localBlurredStream&&(s=this.localBlurredStream,e=!1),{stream:s,mirroredVideo:e}},startMeeting(){const s=this.getRTCSessionOptions();u.startMeeting(s)},joinMeeting(){const s=this.getRTCSessionOptions();u.joinMeeting(s),this.startKeepAlivePolling(),this.startMeetingTimer()},leaveMeeting(){this.closeRTCAPI({callback:()=>{u.leaveMeeting({feeds:this.getFeedsToRemove()})}})},publishFeed({stream:s,info:e=null,callback:t}){try{u.publishFeed({stream:s,info:e}),t&&t()}catch(i){o.error("error: ",i),formUtil.handleErrors(i)}},updatePublishedFeed({stream:s,info:e=null,mediaConstraints:t=null,action:i,callback:a}){try{u.updatePublishedFeed({stream:s,info:e,mediaConstraints:t,action:i}),a&&a()}catch(n){o.error("error: ",n),formUtil.handleErrors(n)}},checkRoomStatus(s={}){if(!u){this.isRoomOnline=!1,window.setTimeout(()=>{this.checkRoomStatus()},1e3);return}u.roomExists({room:this.meeting.roomId,yes:()=>{this.isRoomOnline=!0,s.onYes&&s.onYes()},no:()=>{this.isRoomOnline=!1,s.onNo&&s.onNo()}})},onSessionCreated(){this.statusMessage=$t("meeting.status_message.ready"),this.meeting.roomId&&this.meeting.status==="live"&&(this.checkRoomStatus(),this.afterSessionIsCreated&&typeof this.afterSessionIsCreated=="function"&&this.afterSessionIsCreated()),this.isSidebarLoading=!1},onCreateRoomError(s){this.isLoading=!1,this.isSidebarLoading=!1,formUtil.handleErrors(s)},onSessionCreateError(s){this.isLoading=!1,this.isSidebarLoading=!1,formUtil.handleErrors(s)},onRoomCreated(s){this.isMeetingLive=!0,this.toggleLayout(this.meetingConfigs.lastLayout),this.statusMessage=$t("meeting.status_message.going_live"),this.updatePage(!0),this.autoOpenChat(),this.whisperChannel(window.meetingChannel,"MeetingRoomCreated",{roomId:s}),this.meetingAction({action:"alert",loaderVar:"isSidebarLoading",data:{type:"MeetingRoomCreated",data:{roomId:s}},callback:()=>{}});let e=this.getLocalStreamToPublish();if(!e.stream){this.statusMessage=$t("meeting.status_message.live");return}if(this.publishFeed({stream:e.stream,info:{from:"cam",mirroredVideo:e.mirroredVideo},callback:()=>{this.statusMessage=$t("meeting.status_message.live"),this.meetingConfigs.enableAutoRecording&&window.setTimeout(()=>{this.startRecording(null,e.stream)},1e3)}}),this.isSidebarLoading=!1,this.pageQueries.iframe&&window.parent&&window.parent.meetingIframeLoaded){window.parent.meetingIframeLoaded();return}},onRoomJoined(s){if(this.isMeetingLive=!0,this.toggleLayout(this.meetingConfigs.lastLayout),this.statusMessage=$t("meeting.status_message.going_live"),this.updatePage(),this.autoOpenChat(),this.setupLiveParticipantsFeeds(),this.getPolls(this.anyLivePoll),this.meeting.canModerate&&(this.whisperChannel(window.meetingChannel,"MeetingRoomCreated",{roomId:s}),this.meetingAction({action:"alert",loaderVar:"isSidebarLoading",data:{type:"MeetingRoomCreated",data:{roomId:s}},callback:()=>{}})),this.meetingRules.sendAudio||this.meetingRules.sendVideo){let e=this.getLocalStreamToPublish();if(!e.stream){this.statusMessage=$t("meeting.status_message.live");return}this.publishFeed({stream:e.stream,info:{from:"cam",mirroredVideo:e.mirroredVideo},callback:()=>{this.statusMessage=$t("meeting.status_message.live")}})}else this.statusMessage=$t("meeting.status_message.live");if(this.isSidebarLoading=!1,this.pageQueries.iframe&&window.parent&&window.parent.meetingIframeLoaded){window.parent.meetingIframeLoaded();return}},onRoomFullError(){this.isLoading=!1,this.isSidebarLoading=!1,this.$toasted.error($t("meeting.room_full"),this.$toastConfig.error)},onJoinRoomError(){this.isLoading=!1,this.isSidebarLoading=!1,this.$toasted.error($t("meeting.unable_to_join"),this.$toastConfig.error),this.checkRoomStatus()},onRoomNotFound(){if(this.isLoading=!1,this.isSidebarLoading=!1,this.checkRoomStatus(),this.pageQueries.autoStart){window.setTimeout(this.getOnline,1e3);return}this.$toasted.error($t("meeting.room_not_found"),this.$toastConfig.error)},onGotError(s){this.isLoading=!1,this.isSidebarLoading=!1,this.statusMessage=$t("meeting.status_message.ready"),s&&formUtil.handleErrors(s)},onStreamAdded(s){o.log("onStreamAdded",s);let e=null;o.log("onStreamAdded feedsList",[...this.feedsList]),this.feedsList.length&&(e=this.feedsList.find(d=>d.key===s.key&&d.isScreen===s.isScreen&&d.isWhiteboard===s.isWhiteboard));const t={id:s.id,user:s.user,canModerate:!!s.canModerate,canToggleAudio:!!s.canToggleAudio,canToggleVideo:!!s.canToggleVideo,canHaveStream:!!s.canHaveStream,isHost:!!s.isHost,isInitiator:!!s.isInitiator,mirroredVideo:!!s.mirroredVideo,isScreen:!!s.isScreen,isWhiteboard:!!s.isWhiteboard,isHandUp:!!s.isHandUp,isTalking:!!s.isTalking,audioMid:s.audioMid,videoMid:s.videoMid,simulcast:s.simulcast};C.browser.name.match(/safari/i)&&(t.playing=!1);const i=s.stream.getAudioTracks()[0];let a=null;(!s.kind||s.kind==="audio")&&i&&(t.hasAudio=i.enabled);const n=s.stream.getVideoTracks()[0];let r=null;if((!s.kind||s.kind==="video")&&n&&(t.hasVideo=n.enabled),e)o.log("onStreamAdded - existingFeed",e),Object.assign(e,t),e.audio=i||e.audio,e.video=n||e.video,a=e.audio,r=e.video;else{if(this.meetingConfigs.whiteboardCollaboration&&s.isWhiteboard&&(this.feedsList.find(g=>g.isWhiteboard)||this.localWhiteboardStream))return;const d={key:s.key,userId:s.userId,userUuid:s.user.uuid,isFocused:!this.feedsCount,audioMuted:!1,videoMuted:!1,hasAudio:!1,hasVideo:!1,...t};d.audio=i,d.video=n,a=d.audio,r=d.video,this.feedsList.push(d),o.log("onStreamAdded - New Feed Added",d),this.feedsCount=this.feedsCount+1}this.addStreamToRecord(s.stream),window.setTimeout(()=>{this.setFeedElementSrc({feed:s,audioTrack:a,videoTrack:r})},500)},onStreamRemoved(s){o.log("onStreamRemoved",s);let e=-1;if(this.feedsList.length&&(e=this.feedsList.findIndex(i=>i.key===s.key&&i.isScreen===s.isScreen&&i.isWhiteboard===s.isWhiteboard)),e===-1){o.log("onStreamRemoved - Feed not found",{...s});return}const t=this.feedsList[e];if((!s.kind||s.kind==="audio")&&(t.hasAudio=!1),(!s.kind||s.kind==="video")&&(t.hasVideo=!1),!t.hasAudio&&!t.hasVideo&&(t.isScreen||t.isWhiteboard)){if(this.feedsList.splice(e,1),this.feedsCount=this.feedsCount-1,this.changeFocus(),!this.feedsList.length&&this.meetingRules.session.oneway&&!this.meeting.isHost)this.getOffline(!1);else if(this.pageQueries.iframe){let i=0;const a=()=>{window.setTimeout(()=>{i++,this.checkRoomStatus({onNo:()=>{i>3?this.getOffline(!1):a()},onYes:()=>{window.setTimeout(()=>{this.feedsList.length||this.getOffline(!1)},3e3)}})},2e3)};a()}o.log("onStreamRemoved - Feed Removed",{...t});return}this.setFeedElementSrc({feed:s,audioTrack:t.hasAudio?t.audio:null,videoTrack:t.hasVideo?t.video:null}),o.log("onStreamRemoved - Stream Removed",{...t})},onStreamUpdated(s){o.log("onStreamUpdated",s);let e=-1;if(this.feedsList.length&&(s.type==="meta-updated"&&!s.key&&(s.userUuid||s.userId)?e=this.feedsList.findIndex(i=>s.userUuid&&i.userUuid===s.userUuid||s.userId&&i.userId===s.userId):e=this.feedsList.findIndex(i=>i.key===s.key)),e===-1){o.log("onStreamUpdated - Feed not found",{...s});return}const t=this.feedsList[e];if(s.info&&s.info.hasOwnProperty("mirroredVideo")&&(t.mirroredVideo=s.info.mirroredVideo),t.paused=!1,s.type==="paused")t.paused=!0,t.hasAudio=!s.kind||s.kind==="audio"?!1:t.hasAudio,t.hasVideo=!s.kind||s.kind==="video"?!1:t.hasVideo,this.setFeedElementSrc({feed:t,audioTrack:null,videoTrack:null}),o.log("onStreamUpdated - Feed paused",{...t});else if(s.type==="meta-updated"){if(!s.data)return;_.isObject(s.data)&&s.data.key?t[s.data.key]=s.data.value:Array.isArray(s.data)&&s.data.length&&s.data.forEach(i=>{t[i.key]=i.value}),o.log("onStreamUpdated - Feed meta updated",{...t})}else(!s.kind||s.kind==="audio")&&(t.hasAudio=!!t.audio),(!s.kind||s.kind==="video")&&(t.hasVideo=!!t.video),this.setFeedElementSrc({feed:t,audioTrack:t.audio,videoTrack:t.video}),o.log("onStreamUpdated - Feed updated",{...t})},onFeedRemoved(s){if(o.log("onFeedRemoved",s),!(this.feedsList.length&&(s.id||s.key||s.userId||s.userUuid))){o.log("onFeedRemoved - Insufficient data",s);return}const e=this.feedsList.filter(t=>s.id&&t.id==s.id||s.key&&t.key===s.key||s.userUuid&&t.userUuid===s.userUuid||s.userId&&t.userId===s.userId);this.removeFeeds(e)},onParticipantLeft(s){if(o.log("onParticipantLeft",s),!(this.feedsList.length&&(s.userId||s.userUuid)))return;const e=this.feedsList.filter(t=>s.userUuid&&t.userUuid===s.userUuid||s.userId&&t.userId===s.userId);this.removeFeeds(e)},onParticipantJoined(s){o.log("onParticipantJoined",s),s&&this.setupLiveParticipantFeed({...s})},onParticipantsCountChecked(s=[]){if(Array.isArray(s)?(this.participantsCount=s.length,this.liveParticipants=s):(this.participantsCount=s,this.liveParticipants.splice(0)),this.meetingConfigs.rtcLibrary==="janus"?this.numberOfBroadcastViewers=this.participantsCount:this.participantsCount=this.participantsCount+1,o.log("Checking if there are feeds which needs to be removed",this.feedsList),this.feedsList.length){const e=this.feedsList.filter(t=>{const i=t.user&&t.user.uuid?t.user.uuid:null;return i?!(this.liveParticipants.length&&this.liveParticipants.findIndex(n=>n.user&&n.user.uuid===i)!==-1):!0});this.removeFeeds(e)}},onNumberOfBroadcastViewersUpdated(s){this.numberOfBroadcastViewers=s},onLeftMeeting(){if(this.isLoading=!1,this.isSidebarLoading=!0,this.statusMessage=$t("meeting.status_message.disconnected"),this.pageQueries.iframe&&window.parent&&window.parent.closeCallWindow){window.parent.closeCallWindow();return}if(window.isMeetingPageDestroyed)return;(this.meetingRules.sendAudio||this.meetingRules.sendVideo)&&this.startGreenroom();const s=this.getRTCSessionOptions();u.initSession(s),this.meeting&&this.meeting.status==="live"&&this.meetingAction({action:"leave",loaderVar:"isSidebarLoading",callback:()=>{this.isSidebarLoading=!1}})},onRemoteHandToggled(s){o.log("onRemoteHandToggled",s);const e=this.feedsList.findIndex(i=>i.key===s.key);if(e===-1)return;const t=this.feedsList[e];t.isHandUp=!!s.isHandUp,t.isHandUp&&this.$toasted.info($t("meeting.handup_notification",{attribute:t.user.name}),this.$toastConfig.info)},onDataChannelOpened(s){o.log("onDataChannelOpened",s),this.canvasDesigner&&this.canvasDesigner.pointsLength>0&&this.meetingConfigs.whiteboardCollaboration&&(this.canvasDesigner.sync(),window.setTimeout(function(){o.log("sync-canvas-points"),u.sendMessage({type:"whiteboard",data:"sync-canvas-points"})},1e3))},onWhiteboardMessageReceived({data:s}){if(o.log("onWhiteboardMessageReceived",s),!!this.canvasDesigner){if(s==="sync-canvas-points"&&this.meetingConfigs.whiteboardCollaboration){this.canvasDesigner.sync();return}this.canvasDesigner.syncData(s)}},onMeetingUpdated(s){if(s.dateUpdated){const e=t=>k(t,this.vars.serverDateTimeFormat);this.updateMeetingBackup(s),this.meeting.status=s.status,this.meeting.startDateTime=e(s.startDateTime),s.plannedStartDateTime&&(this.meeting.plannedStartDateTime=e(s.plannedStartDateTime)),s.startedAt&&(this.meeting.startedAt=e(s.startedAt)),s.estimatedEndTime&&(this.meeting.estimatedEndTime=e(s.estimatedEndTime)),s.endedAt&&(this.meeting.endedAt=e(s.endedAt))}else if(s.configUpdated){Object.assign(this.meetingConfigs,s.config),this.updatePage();const e=this.getRTCSessionOptions();u.initSession(e);return}s.endTimeSnoozed&&this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(this.stopAutoEndMeeting(),b.close(),this.autoEndingToast=null),s.autoEndCancelled&&this.autoEndingToast&&this.autoEndingToast.close&&_.isFunction(this.autoEndingToast.close)&&(this.stopAutoEndMeeting(),this.meetingConfigs.autoEndMeeting=!1,b.close(),this.autoEndingToast=null)},onMeetingEnded(){this.getOffline(!1)},onSnapshotTaken(s){o.log("onSnapshotTaken",s),this.meetingConfigs.enableSnapshotAlert&&s&&s.byUser&&s.ofUser&&(this.meetingConfigs.snapshotAlertToUserOnly?this.meetingConfigs.snapshotAlertToModerators?this.meeting.canModerate&&(this.$toasted.info($t("meeting.snapshot_taken_notification_user",{by_user:s.byUser.name,of_user:s.ofUser.name}),this.$toastConfig.info),F()):this.userUuid===s.ofUser.uuid&&(this.$toasted.info($t("meeting.snapshot_taken_notification_your",{by_user:s.byUser.name}),this.$toastConfig.info),F()):(this.userUuid===s.ofUser.uuid?this.$toasted.info($t("meeting.snapshot_taken_notification_your",{by_user:s.byUser.name}),this.$toastConfig.info):this.$toasted.info($t("meeting.snapshot_taken_notification_user",{by_user:s.byUser.name,of_user:s.ofUser.name}),this.$toastConfig.info),F()))},onUserBanned(s){if(o.log("on onUserBanned",s),!(feedItem&&(s.userId||s.userUuid)))return;if(s.userUuid===this.userUuid){this.getOffline(!1),this.$toasted.info($t("meeting.ban_notification"),this.$toastConfig.info);return}if(!this.feedsList.length)return;const e=this.feedsList.filter(t=>s.userUuid&&t.userUuid===s.userUuid||s.userId&&t.userId===s.userId);this.removeFeeds(e)},onUserInfoUpdated(s={}){o.log("on onUserInfoUpdated",s),this.feedsList.length&&s.user&&(s.userId||s.userUuid)&&this.feedsList.forEach((e,t)=>{(s.userId&&e.userId===s.userId||s.userUuid&&e.userUuid===s.userUuid)&&Object.assign(this.feedsList[t].user,s.user)})},onToggleRemoteAV(s){o.log("on onToggleRemoteAV",s),!(s.userUuid!=="all"&&s.userUuid!==this.userUuid)&&(this.unblurLocalStream(),window.setTimeout(()=>{(!s.target||s.target==="both"||s.target==="audio")&&this.configs.meeting.canToggleAudio&&(this.toggleLocalMicrophone(null,!!s.enable),this.$toasted.info(s.enable?$t("meeting.audio_unmuted_by_moderator"):$t("meeting.audio_muted_by_moderator"),this.$toastConfig.info)),(!s.target||s.target==="both"||s.target==="video")&&this.configs.meeting.canToggleVideo&&(this.toggleLocalCamera(null,!!s.enable),this.$toasted.info(s.enable?$t("meeting.video_unmuted_by_moderator"):$t("meeting.video_muted_by_moderator"),this.$toastConfig.info)),(!s.type||s.type==="permanent")&&((!s.target||s.target==="both"||s.target==="audio")&&this.configs.meeting.canToggleAudio&&(this.meetingConfigs.canToggleAudio=!!s.enable),(!s.target||s.target==="both"||s.target==="video")&&this.configs.meeting.canToggleAudio&&(this.meetingConfigs.canToggleVideo=!!s.enable))},1e3))},onPollPublished(s){o.log("on onPollPublished",s),this.isMeetingLive&&this.toggleLivePoll(s)},onPollResultPublished(s){o.log("on onPollResultPublished",s),!(!s||!this.isMeetingLive)&&this.showPollResult(s)},updateMeetingRules(){let s={};this.meeting.type.uuid==="video_conference"?(s={sendAudio:!0,sendVideo:!0,receiveAudio:!0,receiveVideo:!0,session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1}},this.hasGreenroom=!0):this.meeting.type.uuid==="audio_conference"?(s={sendAudio:!0,sendVideo:!1,receiveAudio:!0,receiveVideo:!1,session:{audio:!0,video:!1,screen:!1,data:!0,oneway:!1}},this.hasGreenroom=!0):this.meeting.type.uuid==="webinar"?(s=this.meeting.canModerate?{sendAudio:!0,sendVideo:!0,receiveAudio:!1,receiveVideo:!1,session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!0,broadcast:!1}}:{sendAudio:!1,sendVideo:!1,receiveAudio:!0,receiveVideo:!0,session:{audio:!1,video:!1,screen:!1,data:!0,oneway:!0,broadcast:!1}},this.hasGreenroom=this.meeting.canModerate):this.meeting.type.uuid==="podcast"?(s=this.meeting.canModerate?{sendAudio:!0,sendVideo:!1,receiveAudio:!1,receiveVideo:!1,session:{audio:!0,video:!1,screen:!1,data:!0,oneway:!0,broadcast:!1}}:{sendAudio:!1,sendVideo:!1,receiveAudio:!0,receiveVideo:!1,session:{audio:!1,video:!1,screen:!1,data:!0,oneway:!0,broadcast:!1}},this.hasGreenroom=this.meeting.canModerate):this.meeting.type.uuid==="live_class"&&(s={sendAudio:!0,sendVideo:!0,receiveAudio:!0,receiveVideo:!0,session:{audio:!0,video:!0,screen:!1,data:!0,oneway:!1,broadcast:!0}},this.hasGreenroom=!0),Object.assign(this.meetingRules,s)},updateMeetingTimezone(s){const e=t=>k(t,this.vars.serverDateTimeFormat);return this.updateMeetingBackup(s),s.startDateTime=e(s.startDateTime),s.plannedStartDateTime&&(s.plannedStartDateTime=e(s.plannedStartDateTime)),s.startedAt&&(s.startedAt=e(s.startedAt)),s.estimatedEndTime&&(s.estimatedEndTime=e(s.estimatedEndTime)),s},updateMeetingBackup(s){const e=_.cloneDeep(s);this.meetingBackup.status=e.status,this.meetingBackup.startDateTime=e.startDateTime,this.meetingBackup.plannedStartDateTime=e.plannedStartDateTime,this.meetingBackup.startedAt=e.startedAt,this.meetingBackup.estimatedEndTime=e.estimatedEndTime,this.meetingBackup.endedAt=e.endedAt},updatePage(s=!1){const e=this.meetingConfigs.recordingFormatAudio||"audio/webm",t=this.meetingConfigs.recordingFormatVideo||"video/webm";let i=this.recordingConfigs.type,a=this.recordingConfigs.mimeType;this.meeting.type.uuid==="video_conference"?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!0,this.meetingConfigs.layout=this.pageQueries.iframe?"fullpage":"grid",i="video",a=t):this.meeting.type.uuid==="audio_conference"?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!1,this.meetingConfigs.layout="grid",i="audio",a=e):this.meeting.type.uuid==="webinar"?(this.meetingConfigs.layout="fullpage",s||this.meeting.canModerate?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!0):(this.meetingConfigs.canToggleAudio=!1,this.meetingConfigs.canToggleVideo=!1,this.meetingConfigs.canShareFiles=!1,this.meetingConfigs.canShareScreen=!1,this.meetingConfigs.canRecord=!1,this.meetingConfigs.canUseWhiteboard=!1,this.meetingConfigs.canUseHandGesture=!1),i="video",a=t):this.meeting.type.uuid==="live_class"?(s||this.meeting.canModerate?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!0,this.meetingConfigs.layout="grid"):(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!0,this.meetingConfigs.canShareFiles=!0,this.meetingConfigs.canShareScreen=!1,this.meetingConfigs.canRecord=!1,this.meetingConfigs.canUseWhiteboard=!1,this.meetingConfigs.canUseHandGesture=!0,this.meetingConfigs.canToggleLayout=!1,this.meetingConfigs.layout="fullpage"),i="video",a=t):this.meeting.type.uuid==="podcast"&&(this.meetingConfigs.layout="fullpage",s||this.meeting.canModerate?(this.meetingConfigs.canToggleAudio=!0,this.meetingConfigs.canToggleVideo=!1,this.meetingConfigs.canUseWhiteboard=!1,this.meetingConfigs.canUseHandGesture=!1):(this.meetingConfigs.canToggleAudio=!1,this.meetingConfigs.canToggleVideo=!1,this.meetingConfigs.canShareFiles=!1,this.meetingConfigs.canShareScreen=!1,this.meetingConfigs.canRecord=!1,this.meetingConfigs.canUseWhiteboard=!1,this.meetingConfigs.canUseHandGesture=!1),i="audio",a=e),this.recordingConfigs.type=i,this.recordingConfigs.mimeType=a,this.recordingConfigs.timeSlice=this.meetingConfigs.recordingTimeSlice||5e3,this.meetingConfigs.canUseWhiteboard&&!this.canvasDesignerFilesLoaded&&(this.canvasDesignerFilesLoaded=!0,I("/js/canvas-designer/webrtc-handler.js"),I("/js/canvas-designer/canvas-designer-widget.min.js")),this.meetingConfigs.rtcLibrary==="janus"&&(this.meetingConfigs.canShareFiles=!1,this.meetingConfigs.canRecord=!1)},setupLiveParticipantsFeeds(){if(o.log("On setupLiveParticipantsFeeds",this.liveParticipants),window.setupLiveParticipantsFeedsCalled=window.setupLiveParticipantsFeedsCalled?window.setupLiveParticipantsFeedsCalled+1:1,!this.liveParticipants.length){window.setupLiveParticipantsFeedsCalled<=10&&window.setTimeout(this.setupLiveParticipantsFeeds,1e3);return}this.liveParticipants.forEach(s=>{this.setupLiveParticipantFeed({...s})})},setupLiveParticipantFeed(s){if(o.log("On setupLiveParticipantFeed",{...s}),!(s&&s.user&&s.user.uuid)){o.log("On setupLiveParticipantFeed - not enough data");return}if(this.meeting.type.uuid==="live_class"&&!(s.isInitiator||s.isHost)&&!this.meeting.isHost){o.log("On setupLiveParticipantFeed - participant is not host! Dont show!");return}const e={...s.user},t=e.uuid;if(t&&t===this.user.uuid){o.log("On setupLiveParticipantFeed - Participant is current user",{...s});return}if(this.feedsList.findIndex(n=>n.key===t||n.userUuid===t||n.user&&n.user.uuid===t)!==-1){o.log("On setupLiveParticipantFeed - Participant exists",{...s});return}const a={id:null,key:t,userId:s.userId,userUuid:t,user:e,isFocused:!this.feedsCount,canModerate:!!s.canModerate,canToggleAudio:!!s.canToggleAudio,canToggleVideo:!!s.canToggleVideo,canHaveStream:!!s.canHaveStream,isHost:!!s.isHost,isInitiator:!!s.isInitiator,mirroredVideo:!1,isScreen:!1,isWhiteboard:!1,isHandUp:!1,isTalking:!1,audioMuted:!1,videoMuted:!1,hasAudio:!1,hasVideo:!1,audio:null,video:null};if(!a.canHaveStream){o.log("On setupLiveParticipantFeed - Participant can not have stream");return}this.feedsList.push(a),o.log("On setupLiveParticipantFeed - New Feed Added",a),this.feedsCount=this.feedsCount+1},removeFeeds(s=[]){if(o.log("removeFeeds",s),s.length&&(s.forEach(e=>{const t=this.feedsList.findIndex(i=>i.key===e.key);this.feedsList.splice(t,1),this.feedsCount=this.feedsCount-1}),this.changeFocus()),!this.feedsList.length&&this.meetingRules.session.oneway&&!this.meeting.isHost)this.getOffline(!1);else if(this.pageQueries.iframe){let e=0;const t=()=>{window.setTimeout(()=>{e++,this.checkRoomStatus({onNo:()=>{e>3?this.getOffline(!1):t()},onYes:()=>{window.setTimeout(()=>{this.feedsList.length||this.getOffline(!1)},3e3)}})},2e3)};t()}},getMeeting(){if(this.isLoading=!0,!window.Echo){this.$toasted.error(this.$t("config.pusher.credential_required"),this.$toastConfig.error),this.$router.push({name:this.fallBackRoute});return}return this.Get({uuid:this.uuid}).then(s=>{var t,i;if(s.isMeetingRoom&&(this.fallBackRoute="appRoomList"),s.identifier&&s.isPam&&!(this.$route.query&&this.$route.query.identifier&&this.$route.query.identifier===s.identifier)&&this.$router.replace({name:this.$route.name,params:this.$route.params,query:{...this.$route.query,identifier:s.identifier}}),s.isPaid&&!s.hasPaid){this.$toasted.error($t("meeting.could_not_join_paid_meeting_without_payment"),this.$toastConfig.error),window.setTimeout(()=>{this.$router.push({name:"appMeetingPayment",params:{uuid:s.uuid},query:{join:!0}})},1e3);return}Object.assign(this.meetingConfigs,s.config);const e=B(`${this.vars.localStorageKey}_selected_layout`,!1);return this.meetingConfigs.lastLayout=e||this.meetingConfigs.layout,this.meetingConfigs.enableChat=!!(this.meetingConfigs.enableChat&&((t=this.configs.chat)==null?void 0:t.enabled)&&((i=this.subscriptions)==null?void 0:i.userPrivate)),this.isSidebarLoading=!0,s=this.updateMeetingTimezone(s),Object.assign(this.meeting,s),this.updateMeetingRules(),this.updatePage(),this.isMobile()&&(this.selectedDevices.facingMode="user",this.selectedDevices.camDirection="user"),this.meetingRules.sendAudio||this.meetingRules.sendVideo?this.initMediaDevices():this.isLoading=!1,this.joinChannel(),this.initRTCAPI(),s}).catch(s=>(o.error(s),this.isLoading=!1,this.isSidebarLoading=!1,formUtil.handleErrors(s),s))},getOnline(){this.isSidebarLoading=!0,this.showAgenda=!1,this.statusMessage=$t("meeting.status_message.connecting"),this.meeting.status,this.$gaEvent("engagement","meeting_getOnline"),this.meetingAction({action:"join",loaderVar:"isSidebarLoading",callback:()=>{this.meeting.canModerate?(this.startMeeting(),this.startKeepAlivePolling(),this.startMeetingTimer()):this.meetingConfigs.askHostBeforeJoining&&this.requestAccessStatus!=="approved"&&!this.pageQueries.iframe?this.requestAccessToJoin():this.joinMeeting()}})},getOffline(s=!0){const e=()=>{this.recorder&&window.recordingDurationInterval&&this.stopRecording(),this.isLoading=!0,this.isMeetingLive=!1,this.showAgenda=!1,this.showWhiteboard=!1,this.meetingConfigs.layout=this.meetingConfigs.lastLayout,this.statusMessage=$t("meeting.status_message.disconnecting"),this.$gaEvent("engagement","meeting_getOffline"),this.leaveMeeting()};this.meetingConfigs.confirmBeforeLeaving&&s?formUtil.confirmAction().then(t=>{t.value?e():(this.isLoading=!1,t.dismiss,v.DismissReason.cancel)}):e()},endMeeting(s=!0){const e=()=>{this.isLoading=!0,this.isMeetingLive=!1,this.showAgenda=!1,this.showWhiteboard=!1,this.statusMessage=$t("meeting.status_message.disconnecting"),this.$gaEvent("engagement","meeting_endMeeting"),this.meetingConfigs.layout=this.meetingConfigs.lastLayout,this.leaveMeeting()};this.meeting&&this.meeting.status==="live"?this.meetingAction({action:"end",loaderVar:"isSidebarLoading",alert:s?"confirm":null,callback:t=>{e(),t&&t.meeting&&u.sendMessage({event:"meetingEnded",data:{status:t.meeting.status}})}}):(e(),u.sendMessage({event:"meetingEnded",data:{status:"ended"}}))},cancelMeeting(){this.meetingAction({action:"cancel",loaderVar:"isSidebarLoading",alert:"input",title:$t("meeting.reason_for_cancellation"),inputPlaceholder:$t("meeting.reason_for_cancellation"),fieldName:"cancellationReason"})},snoozeMeeting(s){this.meetingAction({action:"snooze",loaderVar:"isSidebarLoading",data:{period:s},alert:"confirm"})},meetingAction(s={}){const e=s.loaderVar||"isLoading";if(!s.action){this[e]=!1;return}const t=i=>{this[e]=!0;const a=i||s.data;s.action==="end"&&!(this.meeting&&this.meeting.status==="live")||this.Custom({url:`/${this.initUrl}/${this.uuid}/${s.action}`,method:s.method||"post",data:a,silent:!!s.silent}).then(n=>{if(n.meeting){this.updateMeetingBackup(n.meeting),n.meeting=this.updateMeetingTimezone(n.meeting),Object.assign(this.meeting,n.meeting);let r={...this.meetingBackup,dateUpdated:!0};s.inform&&(r={...r,...s.inform}),this.informAboutMeetingUpdate(r)}s.callback?s.callback(n):this[e]=!1}).catch(n=>{o.error(n),s.callback&&s.sameCallbackIfError?s.callback(n):this[e]=!1,formUtil.handleErrors(n)})};s.alert==="confirm"||s.alert===!0?formUtil.confirmAction().then(i=>{i.value?t():(this[e]=!1,i.dismiss,v.DismissReason.cancel)}):s.alert==="input"?x.fire({title:s.title,input:"text",inputPlaceholder:s.inputPlaceholder,showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:$t("general.proceed"),cancelButtonText:$t("general.go_back")}).then(i=>{if(i.value){let a={};a[s.fieldName]=i.value,t(a)}else this[e]=!1,i.dismiss,v.DismissReason.cancel}):t()},deletePoll(s){!s||!this.meeting.canModerate||(this.isPollsLoading=!0,this.Custom({url:`/${this.initUrl}/${this.uuid}/polls/${s.uuid}`,method:"delete"}).then(e=>{this.isPollsLoading=!1,this.togglePollsList()}).catch(e=>{this.isPollsLoading=!1,formUtil.handleErrors(e)}))},publishPoll(s){!s||!this.meeting.canModerate||(this.isPollsLoading=!0,this.Custom({url:`/${this.initUrl}/${this.uuid}/polls/${s.uuid}/publish`,method:"post"}).then(e=>{u.sendMessage({event:"pollPublished",data:e}),this.isPollsLoading=!1,this.togglePollsList()}).catch(e=>{this.isPollsLoading=!1,formUtil.handleErrors(e)}))},publishPollResult(s){if(!(!s||!this.meeting.canModerate)){if(this.isPollLive(s)){this.$toasted.error($t("meeting.poll.could_not_publish_result_live_poll"),this.$toastConfig.error);return}if(this.isPollsLoading=!0,s.isResultPublished){u.sendMessage({event:"pollResultPublished",data:s}),this.isPollsLoading=!1,this.togglePollsList();return}this.Custom({url:`/${this.initUrl}/${this.uuid}/polls/${s.uuid}/publish/result`,method:"post"}).then(e=>{u.sendMessage({event:"pollResultPublished",data:e}),this.isPollsLoading=!1,this.togglePollsList()}).catch(e=>{this.isPollsLoading=!1,formUtil.handleErrors(e)})}},getPolls(s){o.log("getPolls called"),this.meetingConfigs.enablePoll&&(this.isPollsLoading=!0,this.Custom({url:`/${this.initUrl}/${this.uuid}/polls`}).then(e=>{o.log("getPolls - response",e),this.polls.splice(0),this.polls.push(...e.data),this.isPollsLoading=!1,s&&_.isFunction(s)&&s(e)}).catch(e=>{this.isPollsLoading=!1,formUtil.handleErrors(e)}))},requestAccessToJoin(){this.requestAccessStatus="pending",this.meetingAction({action:"joining-request",loaderVar:"isSidebarLoading",method:"post",data:{user:this.user},callback:s=>{}})},respondToJoiningRequest(s){this.meetingAction({action:"joining-request-response",loaderVar:"isSilentLoading",method:"post",data:s,silent:!0})},changeMeetingConfigsFormData(s={}){Object.assign(this.meetingConfigsFormData,s)},saveMeetingConfig(){if(formUtil.isUnchanged(this.meetingConfigs,this.meetingConfigsFormData))return this.$toasted.info(this.$t("general.nothing_changed"),this.$toastConfig.info),!1;this.isMeetingConfigsLoading=!0,this.Custom({url:`/${this.initUrl}/${this.uuid}/config`,method:"post",data:this.meetingConfigsFormData}).then(s=>{if(this.GetConfig().then(e=>{}).catch(e=>{this.isMeetingConfigsLoading=!1,formUtil.handleErrors(e)}),s.meeting&&s.meeting.config){if(this.meetingConfigs.rtcLibrary!==s.meeting.config.rtcLibrary){this.isSidebarLoading=!0,this.$toasted.info($t("meeting.config.rtc_library_changed")+" "+$t("general.reloading_page"),this.$toastConfig.info),window.setTimeout(()=>{location.reload()},3e3);return}Object.assign(this.meetingConfigs,s.meeting.config),this.updatePage();const e=this.getRTCSessionOptions();u.initSession(e)}this.toggleMeetingConfig(),this.isMeetingConfigsLoading=!1,this.$toasted.success(s.message,this.$toastConfig)}).catch(s=>{this.isMeetingConfigsLoading=!1,formUtil.handleErrors(s)})},joinChannel(){!window.Echo||(this.meeting.isPam?window.meetingChannel=window.Echo.channel(`MeetingGuest.${this.uuid}`):(window.meetingChannel=window.Echo.join(`Meeting.${this.uuid}`),window.meetingChannel.here(this.afterJoiningChannel).joining(this.newMemberJoining).leaving(this.memberLeaving)),window.meetingChannel.listen("MeetingStatusChanged",this.meetingStatusChanged).listen("PublicMeetingStatusChanged",this.meetingStatusChanged).listen("MeetingConfigUpdated",this.meetingConfigUpdated).listen("PublicMeetingConfigUpdated",this.meetingConfigUpdated).listen("MeetingRoomCreated",this.meetingRoomCreated).listen("PublicMeetingRoomCreated",this.meetingRoomCreated).listen("MeetingJoiningRequestResponse",this.meetingJoiningRequestResponse),window.EchoOpts&&window.EchoOpts.subscriptions&&window.EchoOpts.subscriptions.userPrivate&&window.EchoOpts.subscriptions.userPrivate.listen("MeetingJoiningRequestResponse",this.meetingJoiningRequestResponse).listen("MeetingJoiningRequestReceived",this.meetingJoiningRequestReceived))},whisperChannel(s,e,t={}){!(s&&s.whisper&&e)||s.whisper(e,t)},afterJoiningChannel(s){this.membersLive=s},newMemberJoining(s){this.membersLive.push(s)},memberLeaving(s){this.membersLive=this.membersLive.filter(e=>e.uuid!==s.uuid)},meetingStatusChanged(s){const e=t=>k(t,this.vars.serverDateTimeFormat);if(s.uuid===this.meeting.uuid){if(this.meeting.status===s.status&&!s.delayed&&!s.updated||(s.updated&&this.stopAutoEndMeeting(),this.updateMeetingBackup(s),this.meeting.status=s.status,this.meeting.startDateTime=e(s.startDateTime),this.meeting.plannedStartDateTime&&(this.meeting.plannedStartDateTime=e(s.plannedStartDateTime)),this.meeting.startedAt&&(this.meeting.startedAt=e(s.startedAt)),this.meeting.estimatedEndTime&&(this.meeting.estimatedEndTime=e(s.estimatedEndTime)),this.meeting.status===s.status&&!s.delayed))return;let t=s.status;t==="scheduled"&&s.delayed&&(t="delayed");const i={live:"meeting.is_live_now",delayed:"meeting.meeting_delayed",cancelled:"meeting.meeting_cancelled",ended:"meeting.meeting_ended"};this.$toasted.success($t(i[t]),this.$toastConfig)}},meetingConfigUpdated(s){if(s.uuid===this.meeting.uuid&&s.config){const e=te(s.config);if(this.isMeetingLive){const t=$t("meeting.meeting_updated")+" "+$t("general.reload_page_now");x.fire({title:t,showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:$t("general.yes"),cancelButtonText:$t("general.no")}).then(i=>{i.value?location.reload():(i.dismiss,v.DismissReason.cancel)})}else this.meetingConfigs.rtcLibrary!==e.rtcLibrary&&(this.$toasted.info($t("meeting.config.rtc_library_changed")+" "+$t("general.reloading_page"),this.$toastConfig.info),window.setTimeout(()=>{location.reload()},3e3));Object.assign(this.meetingConfigs,e),Object.assign(this.meeting.config,e),this.$nextTick(()=>{this.updatePage();const t=this.getRTCSessionOptions();u.initSession(t)})}},meetingRoomCreated(s){if(!s)return;const e=s.data?s.data:s;this.meeting.roomId=e.roomId,this.checkRoomStatus()},meetingJoiningRequestReceived(s){const e=s&&s.data?s.data:s;if(o.log("meetingJoiningRequestReceived data",e),!(e.user&&this.meeting.isHost&&this.meeting.canModerate)){o.log("Insufficient data!");return}if(this.joiningRequestsApproved.find(i=>i.uuid===e.user.uuid)){o.log("Already approved!"),this.respondToJoiningRequest({user:e.user,approved:"yes"});return}if(this.pageQueries.iframe){this.joiningRequestsApproved.push(e.user),this.respondToJoiningRequest({user:e.user,approved:"yes"});return}this.joiningRequests.push(e.user);const t=()=>{if(!this.joiningRequests.length)return;const i={...this.joiningRequests[0]};x.fire({title:$t("meeting.user_trying_to_join",{attribute:i.name}),allowOutsideClick:!1,showCancelButton:!0,confirmButtonText:$t("general.accept"),cancelButtonText:$t("general.reject")}).then(a=>{if(this.joiningRequests.splice(0,1),a.value){this.joiningRequestsApproved.push(i),this.respondToJoiningRequest({user:i,approved:"yes"}),t();return}else{this.respondToJoiningRequest({user:i,approved:"no"}),a.dismiss,v.DismissReason.cancel,t();return}})};window.setTimeout(t,300)},meetingJoiningRequestResponse(s){const e=s&&s.data?s.data:s;if(o.log("meetingJoiningRequestResponse data",e),!e.user){o.log("Insufficient data!");return}e.user.uuid===this.user.uuid&&(e.approved==="yes"?(this.requestAccessStatus="approved",this.joinMeeting()):(this.requestAccessStatus="rejected",this.meeting.status="rejected",this.isSidebarLoading=!1))},async initRTCAPI(){var i;const s=this.meetingConfigs.rtcLibrary||"rtcmc",e=await this.getRTCSessionOptions();let t=[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}];this.configs.iceServers.length&&(t=[...this.configs.iceServers]),u=await ge.init({library:s,config:{debug:this.meetingConfigs.debugMode,signalServer:(i=this.configs.signalServers)==null?void 0:i.url,iceServers:t,mediaServers:this.configs.mediaServers,opaqueId:"KMConnect"+this.user.username},callbacks:{sessionCreated:this.onSessionCreated,sessionCreateError:this.onSessionCreateError,createRoomError:this.onCreateRoomError,roomCreated:this.onRoomCreated,roomFullError:this.onRoomFullError,joinRoomError:this.onJoinRoomError,roomNotFound:this.onRoomNotFound,roomJoined:this.onRoomJoined,streamAdded:this.onStreamAdded,streamUpdated:this.onStreamUpdated,streamRemoved:this.onStreamRemoved,feedRemoved:this.onFeedRemoved,participantLeft:this.onParticipantLeft,participantJoined:this.onParticipantJoined,participantsCountChecked:this.onParticipantsCountChecked,numberOfBroadcastViewersUpdated:this.onNumberOfBroadcastViewersUpdated,leftMeeting:this.onLeftMeeting,remoteHandToggled:this.onRemoteHandToggled,dataChannelOpened:this.onDataChannelOpened,whiteboardMessageReceived:this.onWhiteboardMessageReceived,meetingUpdated:this.onMeetingUpdated,meetingEnded:this.onMeetingEnded,snapshotTaken:this.onSnapshotTaken,userBanned:this.onUserBanned,userInfoUpdated:this.onUserInfoUpdated,toggleRemoteAV:this.onToggleRemoteAV,pollPublished:this.onPollPublished,pollResultPublished:this.onPollResultPublished,gotError:this.onGotError},options:e}),this.fileSharingConnection=u},getFeedsToRemove(){let s=[];return this.localStream&&(s.push({stream:this.localStream}),this.localBlurredStream&&(this.localBlurredStream.getVideoTracks().forEach(e=>{e.stop()}),this.localBlurredStream=null),this.localStream=null,window.capturedLocalStream=null),this.localScreenStream&&(s.push({stream:this.localScreenStream,stopFn:e=>{e.getTracks().forEach(t=>{t.removeEventListener("ended",this.stopSharingScreen),t.enabled=!1,t.stop()})}}),this.$refs.localScreenStreamElement&&(this.$refs.localScreenStreamElement.srcObject=null),this.localScreenStream=null),this.localWhiteboardStream&&(s.push({stream:this.localWhiteboardStream}),this.localWhiteboardStream=null,this.$refs.localScreenStreamElement&&(this.$refs.localScreenStreamElement.srcObject=null)),s},stopAllFeeds(){this.getFeedsToRemove().forEach(s=>{typeof s.stopFn=="function"?s.stopFn(s.stream):typeof s.stream.getTracks=="function"?s.stream.getTracks().forEach(e=>e.stop()):typeof s.stream.stop=="function"&&s.stream.stop()})},closeRTCAPI(s={}){if(this.stopKeepAlivePolling(),this.stopAutoEndMeeting(),this.pageConfigs.backgroundBlur&&this.unblurLocalStream(),this.autoEndingToast&&_.isEmpty(this.autoEndingToast)&&(b.close(),this.autoEndingToast=null),this.feedsCount=0,this.feedsList.splice(0),s.callback&&typeof s.callback=="function"){s.callback();return}u&&u.close({feeds:this.getFeedsToRemove()})},initMediaDevices(){if(C.isWebRTCSupported===!1){this.isLoading=!1,this.$toasted.error(this.$t("meeting.broadcast.webrtc_not_supported"),this.$toastConfig.error);return}this.statusMessage=this.$t("meeting.status_message.awaiting_permission");const s=(i={},a)=>{this.statusMessage=this.$t("meeting.status_message.init_devices"),C.load(()=>{if(i.audio)if(C.hasMicrophone===!0){this.mediaDevices.hasMicrophone=!0,this.mediaDevices.hasMicrophonePermission=!0,this.mediaDevices.mics.splice(0);let n=C.audioInputDevices;n=n.filter((r,d,l)=>l.findIndex(g=>g.id===r.id)===d),Object.assign(this.mediaDevices.mics,n,{length:n.length}),this.selectedDevices.mic=this.mediaDevices.mics[0]}else this.mediaDevices.hasMicrophone=!1,this.selectedDevices.mic=null;if(i.video)if(C.hasWebcam===!0){this.mediaDevices.hasWebcam=!0,this.mediaDevices.hasWebcamPermission=!0,this.mediaDevices.cams.splice(0);let n=C.videoInputDevices;n=n.filter((r,d,l)=>l.findIndex(g=>g.id===r.id)===d),Object.assign(this.mediaDevices.cams,n,{length:n.length}),this.selectedDevices.cam=this.mediaDevices.cams[0]}else this.mediaDevices.hasWebcam=!1,this.selectedDevices.cam=null;C.objForEach((n,r)=>{_.isFunction(n)||(W[r]=n)}),a&&a()})};let e={audio:!1,video:!1};const t=(i={})=>{i.hasOwnProperty("audio")&&(e.audio=!0),i.hasOwnProperty("video")&&(e.video=!0),e.audio&&e.video&&(this.isLoading=!1,s(e,this.startGreenroom))};!C.MediaDevices.length||C.MediaDevices[0]&&C.MediaDevices[0].isCustomLabel?(navigator.mediaDevices.getUserMedia({audio:!0}).then(i=>{i.getTracks().forEach(a=>{a.stop()}),t({audio:!0})}).catch(i=>{this.statusMessage=this.$t("meeting.status_message.failed"),o.log("getUserMedia error: ",i.message,i.name),(i.name==="NotAllowedError"||i.name==="PermissionDeniedError")&&(this.mediaDevices.hasMicrophonePermission=!1),t({audio:!0})}),navigator.mediaDevices.getUserMedia({video:!0}).then(i=>{i.getTracks().forEach(a=>{a.stop()}),t({video:!0})}).catch(i=>{this.statusMessage=this.$t("meeting.status_message.failed"),o.log("getUserMedia error: ",i.message,i.name),(i.name==="NotAllowedError"||i.name==="PermissionDeniedError")&&(this.mediaDevices.hasWebcamPermission=!1),t({video:!0})})):t({audio:!0,video:!0})},initCanvasDesigner(){this.canvasDesigner=new CanvasDesigner,this.canvasDesigner.widgetHtmlURL="/whiteboard",this.canvasDesigner.widgetJsURL="/js/canvas-designer/widget.min.js"},initNetworkListener(){const s=this;window.addEventListener("offline",e=>{s.isOffline=!0,s.isMeetingLive=!1,s.showAgenda=!1,s.showWhiteboard=!1,s.meetingConfigs.layout=s.meetingConfigs.lastLayout,s.closeRTCAPI(),!window.isMeetingPageDestroyed&&(this.meetingRules.sendAudio||this.meetingRules.sendVideo)&&this.startGreenroom()}),window.addEventListener("online",e=>{s.isOffline=!1,location.reload()})},checkLastSelectedDevices(){const s=B(`${this.vars.localStorageKey}_selected_device`,!0);if(!s)return;const e=s.cam?this.mediaDevices.cams.find(i=>i.id===s.cam.id):null;this.selectedDevices.cam=e||this.selectedDevices.cam;const t=s.mic?this.mediaDevices.mics.find(i=>i.id===s.mic.id):null;this.selectedDevices.mic=t||this.selectedDevices.mic,this.selectedDevices.enableCamera=s.enableCamera,this.selectedDevices.enableMicrophone=s.enableMicrophone,(this.pageQueries.callType==="audio"||this.pageQueries.muteCamera)&&(this.selectedDevices.enableCamera=!1),(this.meetingConfigs.muteParticipantsOnStart||this.pageQueries.muteMicrophone)&&(this.selectedDevices.enableMicrophone=!1),this.selectedDevices.resolution=s.resolution,this.selectedDevices.facingMode=s.facingMode,this.selectedDevices.camDirection=s.facingMode},setFeedElementSrc({feed:s,audioTrack:e=null,videoTrack:t=null}){if(o.log("setFeedElementSrc",{...s},e,t),!s)return;const i=this.$refs.feedsElements;if(!i)return;const a=i.find(r=>r.id===s.key);if(!a)return;const n=a.getElementsByClassName(`${s.key}-video`)[0];if(n){if(o.log("setFeedElementSrc - target video element",n),window.videoElemPlayTimeout&&clearTimeout(window.videoElemPlayTimeout),n.controls=!1,!e&&!t){n.srcObject=null;return}let r=n.srcObject;r||(r=new MediaStream);const d=r.getAudioTracks[0];d&&e?d.id!==e.id&&(d.stop(),r.addTrack(e)):d?d.stop():e&&r.addTrack(e);const l=r.getVideoTracks[0];l&&t?l.id!==t.id&&(l.stop(),r.addTrack(t)):d?l.stop():t&&r.addTrack(t),n.srcObject=r,window.videoElemPlayTimeout=window.setTimeout(()=>{n.play()},500)}},getVideoElement(s){const e=this.$refs.feedsElements;if(!e||!s)return;const t=e.find(a=>a.id===s.key);if(!t)return;const i=t.getElementsByClassName(`${s.key}-video`)[0];return console.log(i),i},beforeUnload(s){this.stopNavigation&&(s.returnValue=this.stopNavigationMessage)},destroyPage(){window.countdownInterval&&clearInterval(window.countdownInterval),window.meetingKeepAliveTimer&&clearInterval(window.meetingKeepAliveTimer),window.recordingDurationInterval&&clearInterval(window.recordingDurationInterval),this.SetUiConfig({pageHeaderShow:!0,pageFooterShow:!0}),this.closeRTCAPI(),window.Echo&&(window.meetingChannel&&window.meetingChannel.stopListening("MeetingStatusChanged").stopListening("PublicMeetingStatusChanged").stopListening("MeetingConfigUpdated").stopListening("PublicMeetingConfigUpdated").stopListening("MeetingRoomCreated").stopListening("PublicMeetingRoomCreated").stopListening("MeetingJoiningRequestResponse"),window.Echo.leave(`Meeting.${this.uuid}`),window.EchoOpts&&window.EchoOpts.subscriptions&&window.EchoOpts.subscriptions.userPrivate&&(window.EchoOpts.subscriptions.userPrivate.stopListening("MeetingJoiningRequestResponse"),window.EchoOpts.subscriptions.userPrivate.stopListening("MeetingJoiningRequestReceived"))),p.isEnabled&&(p.off("change"),p.off("error"))},doInit(){if(this.Init({url:this.initUrl}),!(this.pageQueries.iframe||this.pageQueries.autoStart||this.pageQueries.callType)&&window.isDuplicate()){this.duplicateTab=!0;return}this.getMeeting()}},beforeRouteEnter(s,e,t){s.params.uuid?t(i=>{i.prevRoute=e}):t({name:e==="appMeetingView"?e:"AppMeetingList"})},created(){document.body.classList.add("meeting-page"),this.uuid=this.$route.params.uuid,this.pageQueries.objForEach((s,e)=>{this.$route.query.hasOwnProperty(e)&&(this.pageQueries[e]=this.$route.query[e]==="true"?!0:this.$route.query[e]==="false"?!1:this.$route.query[e])}),window.visitedMeetingPage=!0,window.isMeetingPageDestroyed=!1,this.pageQueries.autoStart&&(this.afterSessionIsCreated=()=>{window.setTimeout(this.getOnline,1e3),this.afterSessionIsCreated=null}),this.configs.meeting&&Object.assign(this.meetingConfigs,this.configs.meeting),o.setDebug(this.meetingConfigs.debugMode),this.SetUiConfig({pageHeaderShow:!1,pageFooterShow:!1}),navigator.connection&&navigator.connection.type==="cellular"&&navigator.connection.downlinkMax<=.115&&alert("2G is not supported. Please use a better internet service.")},mounted(){p.isEnabled&&(p.on("change",()=>{this.SetUiConfig({fullScreen:p.isFullscreen})}),p.on("error",s=>{o.error("Failed to enable fullscreen",s)}),this.SetUiConfig({fullScreen:!1})),this.doInit(),window.addEventListener("beforeunload",this.beforeUnload),this.checkIfOffline(),this.initNetworkListener()},beforeRouteLeave(s,e,t){const i=(a=!0)=>{!a||(this.isLoading=!0,this.destroyPage(),window.removeEventListener("beforeunload",this.beforeUnload),window.isMeetingPageDestroyed=!0,this.meeting&&this.meeting.status==="live"?this.Custom({url:`/${this.initUrl}/${this.uuid}/leave`,method:"post"}).then(n=>{t()}).catch(n=>{o.error("error: ",n),t()}):t())};this.stopNavigation?formUtil.unsavedCheckAlert({},{unsaved:!0},i,{title:this.stopNavigationMessage}):this.feedsCount?formUtil.unsavedCheckAlert({},{unsaved:!0},i,{title:this.$t("meeting.is_live")}):i()},beforeDestroy(){window.isMeetingPageDestroyed||(this.isLoading=!0,this.destroyPage(),this.meeting&&this.meeting.status==="live"&&this.Custom({url:`/${this.initUrl}/${this.uuid}/leave`,method:"post"}),window.isMeetingPageDestroyed=!0),this.stopAllFeeds()},destroyed(){document.body.classList.remove("meeting-page")},filters:{decimal(s,e=2){return Number(s).toFixed(e)}}},fe=new z,pe={name:"file-sharer",components:{BProgress:de},props:{connection:{default:null},allowSharing:{default:!0},actionLabel:{type:String,default:"global.choose"},nameLabel:{type:String,default:"upload.file"},namesLabel:{type:String,default:"upload.files"},closeButtonLabel:{type:String,default:"upload.close"},clearButtonLabel:{type:String,default:"upload.clear"},buttonWrapperClasses:{type:String,default:""},buttonClasses:{type:String,default:""},closeButtonClasses:{type:String,default:"btn-light"},clearButtonClasses:{type:String,default:"btn-light"},buttonIcon:{type:String,default:"fas fa-upload"},buttonDesign:{type:String,default:"primary"},options:{type:Object,default(){return{allowedExtensions:["jpg","png","jpeg","pdf","doc","docx","xls","xlsx","txt"],maxNoOfFiles:20,allowedMaxFileSize:null}}},multiple:{type:Boolean,default:!1},hideButtonLabel:{type:Boolean,default:!1},showCloseButton:{type:Boolean,default:!0},autoSend:{type:Boolean,default:!0}},data(){return{icons:se,mimeTypes:ie,sharingFiles:[],fileReceived:{},usersList:{},lastSelectedFile:null,currentUserInfo:{},instanceUserId:null,incomingRequest:{show:!1,sender:null,fileId:null}}},computed:{...j("config",["configs","vars"])},watch:{connection(s,e){s&&e===null&&this.doInit()}},methods:{getFileIcon(s){return this.icons[s]||"fa-file-alt"},getFileNameIcon(s){return this.icons[s]||"fa-file-alt"},clearFileSharing(){this.sharingFiles.splice(0);for(const s in this.filesReceived)delete this.filesReceived[s];this.lastSelectedFile=null,this.$refs.filesInput.value=""},generateFilesList(s){let e=null;const t=this.$refs.filesInput.files;if(this.options.allowedExtensions&&(_.isArray(this.options.allowedExtensions)||(this.options.allowedExtensions=this.options.allowedExtensions.split(",")),e=new RegExp("(."+this.options.allowedExtensions.join("|.")+")$")),this.options.maxNoOfFiles&&t.length>this.options.maxNoOfFiles){this.$toasted.error(this.$t("upload.max_file_limit_crossed",{number:this.options.maxNoOfFiles}),this.$toastConfig.error);return}for(let i=0;i<t.length;i++){const a=`${t[i].size}-${t[i].name}`,n=this.sharingFiles.findIndex(r=>r.fileId===a);if(e&&!e.test(t[i].name))this.$toasted.error(this.$t("global.file_not_supported",{attribute:t[i].name.split(".").pop()}),this.$toastConfig.error);else if(this.options.allowedMaxFileSize&&t[i].size>this.options.allowedMaxFileSize)this.$toasted.error(this.$t("global.file_too_large",{attribute:t[i].name}),this.$toastConfig.error);else if(n===-1){const r={uuid:"",name:t[i].name,size:t[i].size,type:t[i].type,humanSize:O(t[i].size),fileId:a,url:"",sendingTo:[],progress:{value:0,max:0,percent:0,status:"starting"}};this.sharingFiles.unshift(r),this.lastSelectedFile=t[i]}}this.autoSend&&this.connection.sendMessage({type:"file-sharing",data:{doYouWannaReceiveThisFile:!0,sender:this.currentUserInfo,fileId:`${this.lastSelectedFile.size}-${this.lastSelectedFile.name}`}})},rejectIncomingFile(){this.incomingRequest.show=!1,this.connection.sendMessage({type:"file-sharing",data:{noIDoNotWannaReceive:!0,sender:this.currentUserInfo,fileId:this.incomingRequest.fileId}}),this.incomingRequest.sender=null,this.incomingRequest.fileId=null},acceptIncomingFile(){this.incomingRequest.show=!1,this.connection.sendMessage({type:"file-sharing",data:{yesIWannaReceive:!0,sender:this.currentUserInfo,fileId:this.incomingRequest.fileId}}),this.incomingRequest.sender=null,this.incomingRequest.fileId=null},updateProgress(s,e=!0){if(!s.value||s.value===-1)return s.percent=0,s;const t=parseInt((s.value/s.max*100).toFixed(0));return e?s.status=t>100?"sent":"sending - "+t+"%":s.status=t>100?"received":"receiving - "+t+"%",s.percent=t>100?100:t,s},onFileSharingMessageReceived({userId:s,data:e,user:t}){fe.log("onFileSharingMessageReceived",e),s&&t&&(this.usersList[s]=t),e.doYouWannaReceiveThisFile?this.fileReceived[e.fileId]||(this.incomingRequest.fileId=e.fileId,this.incomingRequest.sender=e.sender,this.incomingRequest.show=!0,this.$emit("show")):e.yesIWannaReceive&&!!this.lastSelectedFile?this.connection.shareFile({file:this.lastSelectedFile,sendTo:s}):e.noIDoNotWannaReceive&&this.lastSelectedFile},onFileReceivingStart({file:s}){const e=`${s.size}-${s.name}`;if(this.fileReceived[e])return;s.userid!==this.instanceUserId&&(this.sharingFiles.unshift({uuid:"",name:s.name,size:s.size,type:s.type,humanSize:O(s.size),fileId:e,url:"",receivingFrom:null,progress:{value:0,max:0,percent:0,status:"starting"}}),this.$emit("show"));const t=this.sharingFiles.findIndex(a=>a.fileId===e);if(t===-1)return;let i=this.sharingFiles[t];if(i.uuid=s.uuid,i.userid=s.userid,s.userid===this.instanceUserId){if(i.sendingTo||(i.sendingTo=[]),i.sendingTo.length>0&&i.sendingTo.findIndex(a=>a.userid===s.remoteUserId)!==-1)return;i.sendingTo.unshift({userid:s.remoteUserId,user:this.usersList[s.remoteUserId],progress:{value:0,percent:0,max:s.maxChunks,status:"starting"}})}else i.receiveAgain=!0,i.receivingFrom={userid:s.userid,user:this.usersList[s.userid]},i.progress.max=s.maxChunks,i.progress.status="starting"},onFileReceivingProgress({chunk:s}){const e=`${s.size}-${s.name}`;if(this.fileReceived[e])return;const t=this.sharingFiles.findIndex(a=>a.uuid===s.uuid);if(t===-1)return;let i=this.sharingFiles[t];if(s.remoteUserId&&i.sendingTo){const a=i.sendingTo.findIndex(r=>r.userid===s.remoteUserId),n=i.sendingTo[a];if(!n)return;n.progress.value=s.currentPosition,n.progress=this.updateProgress(n.progress,!0)}else i.progress.value=s.currentPosition,i.progress=this.updateProgress(i.progress,!1)},onFileReceivingEnd({file:s}){const e=`${s.size}-${s.name}`;if(this.fileReceived[e])return;s.remoteUserId===this.instanceUserId&&(this.fileReceived[e]=s);const t=this.sharingFiles.findIndex(a=>a.fileId===e);if(t===-1)return;let i=this.sharingFiles[t];if(i.url=s.url,s.remoteUserId&&i.sendingTo){const a=i.sendingTo.findIndex(n=>n.userid===s.remoteUserId);i.sendingTo[a].progress.status="sent"}else i.progress.status="received"},doInit(){this.connection.setupFileSharing({callbacks:{fileSharingMessageReceived:this.onFileSharingMessageReceived,fileReceivingStart:this.onFileReceivingStart,fileReceivingProgress:this.onFileReceivingProgress,fileReceivingEnd:this.onFileReceivingEnd}}),this.currentUserInfo=this.connection.getUserInfo(),this.instanceUserId=this.connection.getInstanceUserId()}},mounted(){this.options.allowedMaxFileSize=this.options.allowedMaxFileSize?this.options.allowedMaxFileSize:this.configs.system&&this.configs.system.postMaxSize?this.configs.system.postMaxSize:null,this.options.allowedExtensions=this.options.allowedExtensions?this.options.allowedExtensions:this.configs.system&&this.configs.system.allowedFileExtensions?this.configs.system.allowedFileExtensions:null,this.connection&&this.doInit()}};var ve=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sm-uploader file-uploader file-sharer"},[t("div",{class:["files-list-wrapper"]},[e.incomingRequest.show?t("div",{staticClass:"file-incoming-request"},[t("div",{staticClass:"alert fade show alert-white"},[t("div",{staticClass:"alert-content"},[t("h6",[t("strong",[e._v(e._s(e.incomingRequest.sender.name))]),t("span",{staticClass:"text-muted mx-1"},[e._v(e._s(e.$t("upload.wants_to_share_file")))]),t("strong",[e._v(e._s(e.incomingRequest.fileId))])])]),t("div",{staticClass:"d-flex justify-content-end mt-3"},[t("button",{staticClass:"btn btn-danger flex-grow",attrs:{type:"button"},on:{click:e.rejectIncomingFile}},[e._v(e._s(e.$t("upload.reject")))]),t("button",{staticClass:"btn btn-success flex-grow",attrs:{type:"button"},on:{click:e.acceptIncomingFile}},[e._v(e._s(e.$t("upload.accept")))])])])]):e._e(),e.sharingFiles.length?t("ul",{staticClass:"files-list"},e._l(e.sharingFiles,function(i){return t("li",{key:i.fileId,staticClass:"file-details-row"},[t("div",{staticClass:"file-details-wrapper"},[t("div",{staticClass:"file-icon"},[t("span",[t("i",{class:["far",e.getFileIcon(i.type)]})])]),t("div",{staticClass:"file-details"},[t("h6",[e._v(e._s(i.name))]),t("p",[t("span",[t("span",{staticClass:"font-weight-700"},[e._v(e._s(e.$t("upload.type")))]),e._v(": "+e._s(e.mimeTypes[i.type]||"Unknown"))]),t("span",{staticClass:"ml-1"},[t("span",{staticClass:"font-weight-700"},[e._v(e._s(e.$t("upload.size")))]),e._v(": "+e._s(i.humanSize))])]),i.sendingTo?t("div",{staticClass:"sharing-details-wrapper"},e._l(i.sendingTo,function(a){return t("div",{key:a.userid,staticClass:"sharing-row mt-2"},[t("div",{staticClass:"sharing-details small"},[t("div",{staticClass:"flex-grow text-muted"},[e._v(" Sending to: "+e._s(a.user.name)+" ")]),t("div",[t("span",{class:["badge badge-sm badge-pill",{"badge-success":a.progress.status==="sent"},{"badge-info":a.progress.status!=="sent"}]},[e._v(e._s(a.progress.status))])])]),t("b-progress",{staticClass:"mt-2 mb-0",attrs:{value:a.progress.percent,max:100}})],1)}),0):i.receivingFrom?t("div",{staticClass:"sharing-row mt-2"},[t("div",{staticClass:"sharing-details small"},[t("div",{staticClass:"flex-grow text-muted"},[e._v(" Receiving From: "+e._s(i.receivingFrom.user.name)+" ")]),t("div",[t("span",{class:["badge badge-sm badge-pill",{"badge-success":i.progress.status==="received"},{"badge-info":i.progress.status!=="received"}]},[e._v(e._s(i.progress.status))])])]),t("b-progress",{staticClass:"mt-2 mb-0",attrs:{value:i.progress.percent,max:100}})],1):e._e()]),t("div",{staticClass:"status-wrapper"},[!i.receivingFrom||i.progress.status==="received"?t("a",{staticClass:"status-action",attrs:{href:i.url,target:"_blank",download:i.name}},[e._m(0,!0)]):e._e()])])])}),0):e._e()]),t("div",{staticClass:"file-uploader-form p-3"},[t("div",{staticClass:"d-flex flex-column"},[e.allowSharing?[t("div",{class:["file-selector d-flex my-2",e.buttonWrapperClasses]},[t("label",{class:["btn btn-lg flex-grow",`btn-${e.buttonDesign}`,e.buttonClasses]},[t("input",{ref:"filesInput",staticClass:"selector-input",attrs:{name:"filesInput",type:"file",id:"filesInput",multiple:e.multiple},on:{change:e.generateFilesList}}),t("span",{staticClass:"button-icon"},[t("i",{class:e.buttonIcon})]),e._v(" "),e.hideButtonLabel?e._e():t("span",{staticClass:"button-label"},[e._v(e._s(e.$t(e.actionLabel,{attribute:e.$t(e.namesLabel)})))])])])]:e._e(),t("div",{staticClass:"d-flex justify-content-between"},[t("button",{class:["btn flex-grow",e.clearButtonClasses],attrs:{type:"button"},on:{click:e.clearFileSharing}},[e._m(1),e._v(" "),t("span",{staticClass:"button-label"},[e._v(e._s(e.$t(e.clearButtonLabel)))])]),e.showCloseButton?t("button",{class:["btn flex-grow",e.closeButtonClasses],attrs:{type:"button"},on:{click:function(i){return e.$emit("hide")}}},[e._m(2),e._v(" "),t("span",{staticClass:"button-label"},[e._v(e._s(e.$t(e.closeButtonLabel)))])]):e._e()])],2)])])},be=[function(){var s=this,e=s._self._c;return e("span",[e("i",{staticClass:"fas fa-download"})])},function(){var s=this,e=s._self._c;return e("span",{staticClass:"button-icon"},[e("i",{staticClass:"fas fa-clear"})])},function(){var s=this,e=s._self._c;return e("span",{staticClass:"button-icon"},[e("i",{staticClass:"fas fa-times"})])}],Ce=R(pe,ve,be,!1,null,null,null,null);const _e=Ce.exports,we={extends:ce,props:{poll:{type:Object},url:{type:String,required:!0}},data(){return{formData:{uuid:null,duration:60,options:[],config:{position:"bottom-center",isClosable:!1,showResultAfter:!1}},correctOption:null,newRowObj:{uuid:"",title:""}}},computed:{formUrl(){return this.poll?`${this.url}/${this.poll.uuid}`:this.url}},watch:{correctOption:{deep:!0,handler(s,e){if(this.formData.options.forEach((i,a)=>{this.formData.options[a].hasOwnProperty("selected")&&delete this.formData.options[a].selected}),!s)return this.formData.config.showResultAfter=!1,null;const t=this.formData.options.findIndex(i=>i.uuid===s.uuid);this.formData.options[t].selected=!0}}},methods:{savePoll(){this.isLoading=!1,this.Custom({url:this.formUrl,method:this.poll?"patch":"post",data:this.formData}).then(s=>{this.close(),this.isLoading=!1}).catch(s=>{this.isLoading=!1,this.formErrors=Object.assign({},this.formErrors,formUtil.handleErrors(s))})},close(){this.formData=Object.assign({},this.formData,_.cloneDeep(this.initialFormData)),this.$emit("close")},addNewRow(){const s=_.cloneDeep(this.newRowObj);s.uuid=uuid(),this.formData.options.push(s)},removeRow(s){formUtil.confirmAction().then(e=>{e.value&&(this.formData.options.splice(s,1),this.addNewRowIfNone())})},addNewRowIfNone(){this.initianLength=this.formData.options.length,this.formData.options.length<1&&this.addNewRow()}},mounted(){if(this.isLoading=!0,this.poll){const s=this.poll.config?this.poll.config:this.formData.config;Object.assign(this.formData,{...this.poll,config:s});const e=this.formData.options.find(t=>t.selected);this.correctOption=e}this.addNewRowIfNone(),this.isLoading=!1}};var $e=function(){var e=this,t=e._self._c;return t("form",{staticClass:"p-3",on:{submit:function(i){return i.preventDefault(),e.savePoll.apply(null,arguments)}}},[t("animated-loader",{attrs:{"is-loading":e.isLoading||e.isFetching,"loader-color":e.vars.loaderColor}}),t("div",{staticClass:"mb-4"},[t("base-textarea",{attrs:{"auto-focus":"",rows:"4",label:e.$t("meeting.poll.props.question"),error:e.formErrors.question},on:{"update:error":function(i){return e.$set(e.formErrors,"question",i)}},model:{value:e.formData.question,callback:function(i){e.$set(e.formData,"question",i)},expression:"formData.question"}})],1),t("div",{staticClass:"d-flex justify-content-between pb-3 mb-0 border-bottom"},[t("h5",{staticClass:"mb-0"},[e._v(e._s(e.$t("meeting.poll.props.options")))]),t("base-button",{attrs:{type:"button",design:"light",size:"sm"},on:{click:e.addNewRow}},[e._v(e._s(e.$t("general.add_new")))])],1),t("ul",{staticClass:"poll-options-list list-unstyled mb-4"},e._l(e.formData.options,function(i,a){return t("li",{key:i.uuid,staticClass:"poll-option"},[t("div",{staticClass:"mt-4 d-flex justify-content-between"},[t("div",{staticClass:"flex-grow mr-2"},[t("base-input",{attrs:{type:"text",label:`${e.$t("meeting.poll.props.option")} ${a+1}`,"wrapper-classes":"mb-0"},model:{value:i.title,callback:function(n){e.$set(i,"title",n)},expression:"option.title"}})],1),t("base-button",{staticClass:"px-2",attrs:{type:"button",design:"light"},on:{click:function(n){return e.removeRow(a)}}},[t("i",{staticClass:"fas fa-times"})])],1)])}),0),t("div",{staticClass:"mb-4"},[t("base-select",{attrs:{options:e.formData.options,label:e.$t("meeting.poll.props.correct_option"),showBy:"title"},model:{value:e.correctOption,callback:function(i){e.correctOption=i},expression:"correctOption"}})],1),t("div",{staticClass:"mb-4"},[t("base-input",{attrs:{type:"number",step:1,min:5,label:e.$t("meeting.poll.props.duration"),error:e.formErrors.duration},on:{"update:error":function(i){return e.$set(e.formErrors,"duration",i)}},model:{value:e.formData.duration,callback:function(i){e.$set(e.formData,"duration",i)},expression:"formData.duration"}})],1),t("h5",{staticClass:"pb-3 mb-3 border-bottom"},[e._v(e._s(e.$t("config.configuration")))]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-md-6 mb-3"},[t("base-checkbox",{staticClass:"ml-3 mt-2",model:{value:e.formData.config.isClosable,callback:function(i){e.$set(e.formData.config,"isClosable",i)},expression:"formData.config.isClosable"}},[e._v(" "+e._s(e.$t("meeting.poll.props.is_closable"))+" ")])],1),e.correctOption?t("div",{staticClass:"col-12 col-md-6 mb-3"},[t("base-checkbox",{staticClass:"ml-3 mt-2",model:{value:e.formData.config.showResultAfter,callback:function(i){e.$set(e.formData.config,"showResultAfter",i)},expression:"formData.config.showResultAfter"}},[e._v(" "+e._s(e.$t("meeting.poll.props.show_result_after"))+" ")])],1):e._e()]),e.formHasErrors?t("div",{staticClass:"alert alert-danger my-3",attrs:{role:"alert"}},[t("h6",{staticClass:"m-0"},[e._v(e._s(e.$t("general.form_has_errors")))]),t("div",{staticClass:"m-0",domProps:{innerHTML:e._s(e.formHasErrors)}})]):e._e(),t("div",{staticClass:"form-footer mt-4"},[t("div",{staticClass:"left-side"},[t("base-button",{attrs:{type:"button",design:"light",tabindex:"-1"},on:{click:e.close}},[t("i",{staticClass:"fas fa-times"}),e._v(" "+e._s(e.$t("general.cancel")))])],1),t("div",{staticClass:"right-side"},[t("base-button",{attrs:{type:"submit",design:"primary"}},[t("i",{staticClass:"fas fa-save"}),e._v(" "+e._s(e.$t("global.save",{attribute:e.$t("meeting.poll.poll")})))])],1)])],1)},ye=[],Se=R(we,$e,ye,!1,null,null,null,null);const ke=Se.exports;const Le={mixins:[re,he,N],components:{AppLogo:le,AnimatedNumber:K,FlipCountdown:Y,FileSharer:_e,PollForm:ke,LivePoll:X,EditConfig:ue},computed:{fileSharerOptions(){return{allowedExtensions:this.configs.system.allowedFileExtensions,maxNoOfFiles:20,allowedMaxFileSize:null}}},watch:{locked(s,e){if(s){const t=this.$route.fullPath;this.$router.push({name:"authLock",query:{ref:t}})}}},mounted(){}};var Te=function(){var e=this,t=e._self._c;return t("base-container",{class:["meeting-page-container",{"is-in-iframe":e.pageQueries.iframe},{"has-feeds":e.feedsCount},`${e.meetingConfigs.layout}-layout`,{"auto-hide-footer":e.pageConfigs.autoHideFooter},{"show-agenda":e.showAgenda},{"show-whiteboard":e.showWhiteboard},{"show-file-sharing":e.showFileSharing},{"show-meeting-config":e.showMeetingConfigs},{"show-bulk-actions":e.showBulkActions},{"show-participants-list":e.showParticipantsList},{"show-polls-list":e.showPollsList},{"show-live-poll":e.showLivePoll},{pulse:e.recordingStatus==="started"}],attrs:{"with-loader":"","is-loading":e.isLoading,"loader-color":e.vars.loaderColor,"overlay-color":e.uiConfigs.pageColorSchemeType,"loader-size":"screen","data-page-background-color":e.uiConfigs.pageBackgroundColor,"data-card-background-color":e.uiConfigs.pageContainerBackgroundColor}},[e.duplicateTab&&!e.pageQueries.iframe?t("card",{staticClass:"duplicate-tab",attrs:{"body-classes":"d-flex justify-content-center align-items-center"}},[t("h2",[e._v(e._s(e.$t("meeting.duplicate_tab")))])]):e.meeting&&!e.meeting.isBlocked?[e.meetingConfigs.canUseWhiteboard&&e.isMeetingLive?t("card",{staticClass:"whiteboard-container",attrs:{"body-classes":"whiteboard-wrapper",shadow:""}},[t("animated-loader",{attrs:{"is-loading":e.isWhiteboardLoading,"loader-color":e.vars.loaderColor,"overlay-color":e.uiConfigs.pageColorSchemeType}}),t("div",{staticClass:"meeting-whiteboard-container"},[t("div",{ref:"whiteboard",staticClass:"whiteboard",attrs:{id:"whiteboard"}})])],1):e._e(),t("div",{class:["meeting-room",{"has-min-2-feed":e.allFeedsCount>=2},{"has-min-3-feed":e.allFeedsCount>=3},{"has-min-4-feed":e.allFeedsCount>=4},{"has-min-5-feed":e.allFeedsCount>=5},{"has-min-7-feed":e.allFeedsCount>=7},{"has-min-10-feed":e.allFeedsCount>=10},{"compact-layout":e.isLayoutCompact}]},[e.isMeetingLive&&e.feedsCount?[e._l(e.feedsList,function(i){return[t("div",{key:i.key,ref:"feedsElements",refInFor:!0,class:["stream-item",{"mirrored-video":i.mirroredVideo},{"is-focused":i.isFocused},{"is-speaking":i.isSpeaking},{"is-screen":i.isScreen},{"is-whiteboard":i.isWhiteboard},{"is-talking":i.isTalking},{"has-no-video":!i.video||!i.hasVideo||i.videoMuted},{"has-stream-cover":i.user.cover}],attrs:{id:i.key}},[t("div",{staticClass:"stream-video",on:{dblclick:e.toggleFullScreen}},[t("video",{class:`${i.key}-video`,attrs:{playsinline:"",autoplay:"",onplay:e.handlePlay(i)},domProps:{muted:!i.hasAudio||i.audioMuted}})]),!i.video||!i.hasVideo||i.videoMuted?t("div",{staticClass:"stream-no-video",on:{dblclick:e.toggleFullScreen}},[i.user.cover?t("div",{staticClass:"stream-cover",style:`background-image: url(${i.user.cover})`}):t("div",{staticClass:"user-avatar-box"},[t("user-avatar",{attrs:{user:i.user}}),i.audio&&i.hasAudio&&!i.audioMuted?t("div",{staticClass:"audio-pusle-wrapper"},[t("div",{staticClass:"audio-pusle"},[t("i",{staticClass:"far fa-circle-dot fa-beat"})])]):e._e()],1)]):e._e(),i.user?t("div",{staticClass:"stream-caption"},[t("user-avatar",{attrs:{user:i.user,"has-shadow":""}}),i.isScreen?t("h6",[e._v(e._s(i.user.name)+"'s "+e._s(e.$t("meeting.screen")))]):i.isWhiteboard?t("h6",[e._v(e._s(i.user.name)+"'s "+e._s(e.$t("meeting.whiteboard")))]):t("h6",[e._v(e._s(i.user.name))])],1):e._e(),(!i.isFocused||e.meetingConfigs.layout==="grid"||e.meetingConfigs.layout==="fullpage"&&e.allFeedsCount<=2)&&e.allFeedsCount>1?t("div",{staticClass:"stream-controls d-none d-lg-block"},[t("div",{staticClass:"stream-controls-buttons"},[t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.maximize")},on:{click:function(a){return e.changeFocus(i)}}},[t("i",{staticClass:"fas fa-expand"})])])]):e._e(),t("div",{staticClass:"stream-indicators"},[i.isHost?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.host")}},[t("i",{staticClass:"fas fa-user-tie text-info"})]):i.canModerate?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.moderator")}},[t("i",{staticClass:"fas fa-user-cog text-info"})]):e._e(),i.isHandUp?t("div",{staticClass:"status-icon"},[t("i",{staticClass:"fas fa-hand-paper enabled-text"})]):e._e(),i.audio&&i.hasAudio?t("div",{staticClass:"status-icon"},[i.audioMuted?t("i",{staticClass:"fas fa-volume-off disabled-text"}):t("i",{staticClass:"fas fa-volume-up"})]):e._e()]),t("div",{staticClass:"stream-actions"},[t("base-dropdown",{staticClass:"custom-control-dropdown",attrs:{tag:"div","menu-classes":"fullwidth-on-mobile block-content",position:"right"}},[t("button",{staticClass:"btn action custom-control-dropdown-btn btn-sm",attrs:{slot:"title"},slot:"title"},[t("i",{staticClass:"fas fa-ellipsis-v"})]),i.playing?e._e():t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.playStream(i)}}},[t("i",{staticClass:"fas fa-play disabled-text"}),e._v(" "+e._s(e.$t("meeting.start_playing"))+" ")]),i.audio&&i.hasAudio?t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.toggleRemoteAudio(i)}}},[i.audioMuted?[t("i",{staticClass:"fas fa-volume-off disabled-text"}),e._v(" "+e._s(e.$t("meeting.unmute_for_me"))+" ")]:[t("i",{staticClass:"fas fa-volume-up enabled-text"}),e._v(" "+e._s(e.$t("meeting.mute_for_me"))+" ")]],2):e._e(),i.isFocused?e._e():t("button",{staticClass:"dropdown-item btn-sm d-lg-none",on:{click:function(a){return e.changeFocus(i)}}},[t("i",{staticClass:"fas fa-expand enabled-text"}),e._v(" "+e._s(e.$t("meeting.maximize"))+" ")]),t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.toggleObjectFit(i)}}},[t("i",{staticClass:"fas fa-expand-alt enabled-text"}),e._v(" "+e._s(e.$t("meeting.change_view"))+" ")]),e.meetingConfigs.canTakeSnapshot&&(e.meetingConfigs.anyoneCanTakeSnapshot||e.meeting.canModerate)&&i.video&&i.hasVideo&&!i.videoMuted?t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.takeSnapshotOfStream(i)}}},[t("i",{staticClass:"fas fa-image enabled-text"}),e._v(" "+e._s(e.$t("meeting.take_snapshot"))+" ")]):e._e(),e.meeting.canModerate?[t("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.banRemoteUser(i)}}},[t("i",{staticClass:"fas fa-ban enabled-text"}),e._v(" "+e._s(e.$t("meeting.kick_ban"))+" ")]),i.audio&&i.canToggleAudio?[i.hasAudio?t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.toggleRemoteAVSource(i,"audio","temporary",!1)}}},[t("i",{staticClass:"fas fa-microphone enabled-text"}),e._v(" "+e._s(e.$t("meeting.mute_audio_for_everyone"))+" ")]):e._e()]:e._e(),i.video&&i.canToggleVideo?[i.hasVideo?t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.toggleRemoteAVSource(i,"video","temporary",!1)}}},[t("i",{staticClass:"fas fa-video enabled-text"}),e._v(" "+e._s(e.$t("meeting.mute_video_for_everyone"))+" ")]):e._e()]:e._e(),i.audio?[i.canToggleAudio?t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.toggleRemoteAVSource(i,"audio","permanent",!1)}}},[t("i",{staticClass:"fas fa-microphone enabled-text"}),e._v(" "+e._s(e.$t("meeting.dont_allow_audio"))+" ")]):e._e()]:e._e(),i.video?[i.canToggleVideo?t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(a){return e.toggleRemoteAVSource(i,"video","permanent",!1)}}},[t("i",{staticClass:"fas fa-video enabled-text"}),e._v(" "+e._s(e.$t("meeting.dont_allow_video"))+" ")]):e._e()]:e._e()]:e._e()],2)],1)])]})]:e._e(),e.hasGreenroom?t("div",{class:["stream-item local-stream-item",{"mirrored-video":e.pageConfigs.mirroredVideo||e.selectedDevices.camDirection!=="environment"},{"is-speaking":e.isSpeaking},{"is-focused":e.isFocused==="cam"},{"is-blurred":!!e.localBlurredStream},{"has-no-video":!e.selectedDevices.enableCamera||e.selectedDevices.videoMuted},{"has-stream-cover":e.user.profile.cover}]},[t("div",{staticClass:"stream-video",on:{dblclick:e.toggleFullScreen}},[t("video",{ref:"localStreamElement",attrs:{playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}}),t("canvas",{ref:"localBlurredStreamElement"})]),!e.selectedDevices.enableCamera||e.selectedDevices.videoMuted?t("div",{staticClass:"stream-no-video",on:{dblclick:e.toggleFullScreen}},[e.user.profile.cover?t("div",{staticClass:"stream-cover",style:`background-image: url(${e.user.profile.cover})`}):t("div",{staticClass:"user-avatar-box"},[t("user-avatar",{attrs:{user:e.user}}),e.selectedDevices.mic&&e.selectedDevices.enableMicrophone&&!e.selectedDevices.audioMuted?t("div",{staticClass:"audio-pusle-wrapper"},[t("div",{staticClass:"audio-pusle"},[t("i",{staticClass:"far fa-circle-dot fa-beat"})])]):e._e()],1)]):e._e(),e.isMeetingLive?[t("div",{staticClass:"stream-caption"},[t("user-avatar",{attrs:{user:e.user,"has-shadow":""}}),t("h6",[e._v(e._s(e.$t("meeting.you")))])],1),(e.isFocused!=="cam"||e.meetingConfigs.layout==="grid"||e.meetingConfigs.layout==="fullpage"&&e.allFeedsCount<=2)&&e.allFeedsCount>1?t("div",{staticClass:"stream-controls d-none d-lg-block"},[t("div",{staticClass:"stream-controls-buttons"},[t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.maximize")},on:{click:function(i){return e.changeFocus("cam")}}},[t("i",{staticClass:"fas fa-expand"})])])]):e._e(),t("div",{staticClass:"stream-indicators"},[e.meeting.isHost?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.host")}},[t("i",{staticClass:"fas fa-user-tie text-info"})]):e.meeting.canModerate?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.moderator")}},[t("i",{staticClass:"fas fa-user-cog text-info"})]):e._e(),e.isHandUp?t("div",{staticClass:"status-icon"},[t("i",{staticClass:"fas fa-hand-paper enabled-text"})]):e._e(),e.selectedDevices.mic&&e.meetingConfigs.canToggleAudio?t("div",{staticClass:"status-icon"},[e.selectedDevices.enableMicrophone?t("i",{staticClass:"fas fa-volume-up"}):t("i",{staticClass:"fas fa-volume-off disabled-text"})]):e._e()]),t("div",{staticClass:"stream-actions"},[t("base-dropdown",{staticClass:"custom-control-dropdown",attrs:{tag:"div","menu-classes":"fullwidth-on-mobile block-content",position:"right"}},[t("button",{staticClass:"btn action custom-control-dropdown-btn btn-sm",attrs:{slot:"title"},slot:"title"},[t("i",{staticClass:"fas fa-ellipsis-v"})]),e.isFocused!=="cam"?t("button",{staticClass:"dropdown-item btn-sm d-lg-none",on:{click:function(i){return e.changeFocus("cam")}}},[t("i",{staticClass:"fas fa-expand enabled-text"}),e._v(" "+e._s(e.$t("meeting.maximize"))+" ")]):e._e(),t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(i){return e.toggleObjectFit("localStreamElement")}}},[t("i",{staticClass:"fas fa-expand-alt enabled-text"}),e._v(" "+e._s(e.$t("meeting.change_view"))+" ")]),e.meetingConfigs.canTakeSnapshot&&e.selectedDevices.enableCamera&&!e.selectedDevices.videoMuted?t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(i){return e.takeSnapshotOfStream("localStreamElement",!0)}}},[t("i",{staticClass:"fas fa-image enabled-text"}),e._v(" "+e._s(e.$t("meeting.take_snapshot"))+" ")]):e._e()])],1)]:e._e()],2):e._e(),t("div",{class:["stream-item is-screen local-stream-item",e.localScreenStream?"":"d-none",{"is-focused":e.isFocused==="screen"}]},[t("div",{staticClass:"stream-video",on:{dblclick:e.toggleFullScreen}},[t("video",{ref:"localScreenStreamElement",attrs:{playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}})]),t("div",{staticClass:"stream-caption"},[t("user-avatar",{attrs:{user:e.user,"has-shadow":""}}),t("h6",[e._v(e._s(e.$t("meeting.your_screen")))])],1),(e.isFocused!=="screen"||e.meetingConfigs.layout==="grid"||e.meetingConfigs.layout==="fullpage"&&e.allFeedsCount<=2)&&e.allFeedsCount>1?t("div",{staticClass:"stream-controls d-none d-lg-block"},[e.isFocused!=="screen"?t("div",{staticClass:"stream-controls-buttons"},[t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.maximize")},on:{click:function(i){return e.changeFocus("screen")}}},[t("i",{staticClass:"fas fa-expand"})])]):e._e()]):e._e(),t("div",{staticClass:"stream-indicators"},[e.meeting.isHost?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.host")}},[t("i",{staticClass:"fas fa-user-tie text-info"})]):e.meeting.canModerate?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.moderator")}},[t("i",{staticClass:"fas fa-user-cog text-info"})]):e._e(),e.isHandUp?t("div",{staticClass:"status-icon"},[t("i",{staticClass:"fas fa-hand-paper enabled-text"})]):e._e()]),t("div",{staticClass:"stream-actions"},[t("base-dropdown",{staticClass:"custom-control-dropdown",attrs:{tag:"div","menu-classes":"fullwidth-on-mobile block-content",position:"right"}},[t("button",{staticClass:"btn action custom-control-dropdown-btn btn-sm",attrs:{slot:"title"},slot:"title"},[t("i",{staticClass:"fas fa-ellipsis-v"})]),e.isFocused!=="screen"?t("button",{staticClass:"dropdown-item btn-sm d-lg-none",on:{click:function(i){return e.changeFocus("screen")}}},[t("i",{staticClass:"fas fa-expand enabled-text"}),e._v(" "+e._s(e.$t("meeting.maximize"))+" ")]):e._e(),t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(i){return e.toggleObjectFit("localScreenStreamElement")}}},[t("i",{staticClass:"fas fa-expand-alt enabled-text"}),e._v(" "+e._s(e.$t("meeting.change_view"))+" ")]),e.meetingConfigs.canTakeSnapshot&&(e.meetingConfigs.anyoneCanTakeSnapshot||e.meeting.canModerate)?t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(i){return e.takeSnapshotOfStream("localScreenStreamElement",!0)}}},[t("i",{staticClass:"fas fa-image enabled-text"}),e._v(" "+e._s(e.$t("meeting.take_snapshot"))+" ")]):e._e()])],1)]),t("div",{class:["stream-item is-whiteboard local-stream-item",e.localWhiteboardStream?"":"d-none",{"is-focused":e.isFocused==="whiteboard"}]},[t("div",{staticClass:"stream-video",on:{dblclick:e.toggleFullScreen}},[t("video",{ref:"localWhiteboardStreamElement",attrs:{playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}})]),t("div",{staticClass:"stream-caption"},[t("user-avatar",{attrs:{user:e.user,"has-shadow":""}}),t("h6",[e._v(e._s(e.$t("meeting.your_whiteboard")))])],1),(e.isFocused!=="whiteboard"||e.meetingConfigs.layout==="grid"||e.meetingConfigs.layout==="fullpage"&&e.allFeedsCount<=2)&&e.allFeedsCount>1?t("div",{staticClass:"stream-controls d-none d-lg-block"},[t("div",{staticClass:"stream-controls-buttons"},[t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"controls-btn",attrs:{title:e.$t("meeting.maximize")},on:{click:function(i){return e.changeFocus("whiteboard")}}},[t("i",{staticClass:"fas fa-expand"})])])]):e._e(),t("div",{staticClass:"stream-indicators"},[e.meeting.isHost?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.host")}},[t("i",{staticClass:"fas fa-user-tie text-info"})]):e.meeting.canModerate?t("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"status-icon",attrs:{title:e.$t("meeting.moderator")}},[t("i",{staticClass:"fas fa-user-cog text-info"})]):e._e(),e.isHandUp?t("div",{staticClass:"status-icon"},[t("i",{staticClass:"fas fa-hand-paper enabled-text"})]):e._e()]),t("div",{staticClass:"stream-actions"},[t("base-dropdown",{staticClass:"custom-control-dropdown",attrs:{tag:"div","menu-classes":"fullwidth-on-mobile block-content",position:"right"}},[t("button",{staticClass:"btn action custom-control-dropdown-btn btn-sm",attrs:{slot:"title"},slot:"title"},[t("i",{staticClass:"fas fa-ellipsis-v"})]),e.isFocused!=="whiteboard"?t("button",{staticClass:"dropdown-item btn-sm d-lg-none",on:{click:function(i){return e.changeFocus("whiteboard")}}},[t("i",{staticClass:"fas fa-expand enabled-text"}),e._v(" "+e._s(e.$t("meeting.maximize"))+" ")]):e._e(),t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(i){return e.toggleObjectFit("localWhiteboardStreamElement")}}},[t("i",{staticClass:"fas fa-expand-alt enabled-text"}),e._v(" "+e._s(e.$t("meeting.change_view"))+" ")]),e.meetingConfigs.canTakeSnapshot&&e.selectedDevices.enableCamera&&!e.selectedDevices.videoMuted?t("button",{staticClass:"dropdown-item btn-sm",on:{click:function(i){return e.takeSnapshotOfStream("localWhiteboardStreamElement",!0)}}},[t("i",{staticClass:"fas fa-image enabled-text"}),e._v(" "+e._s(e.$t("meeting.take_snapshot"))+" ")]):e._e()])],1)]),!e.hasGreenroom&&!e.isMeetingLive?[e.meeting.cover?t("div",{staticClass:"greenroom-cover",style:`background-image: url(${e.meeting.cover})`,attrs:{"data-greenroom-background-color":e.uiConfigs.leftSidebarColor},on:{dblclick:e.toggleFullScreen}}):t("div",{staticClass:"greenroom-cover",attrs:{"data-greenroom-background-color":e.uiConfigs.leftSidebarColor}})]:e._e(),e.statusMessage?t("div",{staticClass:"status-message-wrapper"},[t("div",{staticClass:"status-message"},[e._v(" "+e._s(e.statusMessage)+" ")])]):e._e(),e.meetingConfigs.canToggleInfo&&e.isMeetingLive&&e.showMeetingInfo?t("div",{staticClass:"meeting-info-container"},[t("close-button",{staticClass:"info-close-btn",attrs:{"parent-class":""},on:{click:e.toggleMeetingInfo}}),t("div",{staticClass:"meeting-info"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("meeting.props.type")))]),e._v(": "),t("span",{staticClass:"info-value"},[e._v(e._s(e.meeting.type.name))])]),e.meeting.isPam?t("div",{staticClass:"meeting-info"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("meeting.props.is_pam")))]),e._v(": "),t("span",{staticClass:"info-value"},[e._v(e._s(e.$t("general.yes")))])]):e._e(),e.meeting.isPaid?t("div",{staticClass:"meeting-info"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("meeting.props.is_paid")))]),e._v(": "),t("span",{staticClass:"info-value"},[e._v(e._s(e.$t("general.yes")))])]):e._e(),e.meetingRules.session&&e.meetingRules.session.oneway?e.meeting.canModerate?t("div",{staticClass:"meeting-info"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("meeting.total_participants")))]),e._v(": "),t("span",{staticClass:"info-value"},[e._v(e._s(e.numberOfBroadcastViewers))])]):e._e():t("div",{staticClass:"meeting-info"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("meeting.total_participants")))]),e._v(": "),t("span",{staticClass:"info-value"},[e._v(e._s(e.participantsCount))])]),t("div",{staticClass:"meeting-info"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("meeting.started_at")))]),e._v(": "),t("span",{staticClass:"info-value"},[e._v(e._s(e._f("moment")(e.meeting.startedAt,e.vars.defaultDateTimeFormat)))])]),t("div",{staticClass:"meeting-info"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("meeting.meeting_live_since")))]),e._v(": "),t("span",{staticClass:"info-value"},[e._v(e._s(e.meetingDuration))])]),t("div",{staticClass:"meeting-info"},[t("span",{staticClass:"info-label"},[e._v(e._s(e.$t("meeting.props.estimated_end_time")))]),e._v(": "),t("span",{staticClass:"info-value"},[e._v(e._s(e._f("moment")(e.meeting.estimatedEndTime,e.vars.defaultDateTimeFormat)))])])],1):e._e()],2),e.isMeetingLive?e._e():t("card",{staticClass:"waiting-room rounded-0 border-0",attrs:{"body-classes":"d-flex flex-column justify-content-center align-items-center",shadow:""}},[t("animated-loader",{attrs:{"is-loading":e.isSidebarLoading,"loader-color":e.vars.loaderColor,"overlay-color":e.uiConfigs.pageColorSchemeType}}),e.meeting.status==="scheduled"?[e.startDateTimeIsFuture?t("flip-countdown",{staticClass:"countdown-container my-3",attrs:{format:e.vars.serverDateTimeFormat,deadline:e.meeting.startDateTime}}):e.meeting.canModerate?[t("h5",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.waiting_for_you_to_start"))+" ")]),t("div",{staticClass:"d-flex justify-content-center flex-wrap my-3"},[t("base-button",{attrs:{type:"button",design:"primary",size:"lg"},on:{click:e.getOnline}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("meeting.get_live")})))]),e.isLoading?e._e():t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:[t("h5",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.starting_any_time_now"))+" ")]),e.isLoading?e._e():t("div",{staticClass:"d-flex justify-content-center"},[t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)],t("div",{staticClass:"text-center my-3"},[t("span",{staticClass:"text-muted"},[e._v(e._s(e.$t("meeting.scheduled_for")))]),t("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"text-muted-lg m-l-5",attrs:{title:e._f("withTimezone")(e._f("momentDateTime")(e.meeting.startDateTime))}},[e._v(e._s(e._f("momentCalendar")(e.meeting.startDateTime,{sameElse:e.vars.defaultDateTimeFormat})))])]),e.liveMembersCount>0?t("div",{staticClass:"text-muted text-center my-3"},[t("span",{staticClass:"text-xs text-success mr-1"},[t("i",{staticClass:"fas fa-circle"})]),t("animated-number",{attrs:{number:e.liveMembersCount,delay:100}}),e.liveMembersCount>1?t("span",[e._v(e._s(e.$t("meeting.members_online")))]):t("span",[e._v(e._s(e.$t("meeting.member_online")))])],1):e._e(),e.meeting.canModerate?[t("div",{staticClass:"d-flex justify-content-center my-3"},[t("base-button",{attrs:{type:"button",design:"gray-darker",size:"sm"},on:{click:e.cancelMeeting}},[t("i",{staticClass:"fas fa-times m-r-5"}),e._v(" "+e._s(e.$t("meeting.cancel")))]),t("base-dropdown",{attrs:{tag:"div",size:"sm",direction:"up"}},[t("base-button",{attrs:{slot:"title",type:"button",design:"gray-darker",size:"sm","data-toggle":"dropdown",role:"button"},slot:"title"},[t("i",{staticClass:"far fa-clock m-r-5"}),t("span",{staticClass:"nav-link-inner--text"},[e._v(e._s(e.$t("meeting.snooze")))]),t("i",{staticClass:"fas fa-chevron-up m-l-5"})]),e._l(e.snoozeOpts,function(i){return t("button",{key:i.uuid,staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(a){return e.snoozeMeeting(i.uuid)}}},[e._v(e._s(i.name)+" "+e._s(e.$t(`list.general.durations.${i.type}`)))])})],2)],1),t("div",{staticClass:"d-flex justify-content-center"},[t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:e._e()]:e.meeting.status==="live"?[e.isRoomOnline?[t("h5",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.is_live_now"))+" ")]),t("div",{staticClass:"d-flex justify-content-center flex-wrap my-3"},[t("base-button",{attrs:{type:"button",design:"primary",size:"lg"},on:{click:e.getOnline}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("meeting.get_live")})))]),t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:[e.meeting.canModerate?[t("h5",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.waiting_for_you_to_start"))+" ")]),t("div",{staticClass:"d-flex justify-content-center flex-wrap my-3"},[t("base-button",{attrs:{type:"button",design:"primary",size:"lg"},on:{click:e.getOnline}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("meeting.get_live")})))]),t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:[t("h5",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.starting_any_time_now"))+" ")]),t("div",{staticClass:"d-flex justify-content-center flex-wrap my-3"},[t("base-button",{attrs:{type:"button",design:"dark",size:"lg"},on:{click:e.checkRoomStatus}},[t("i",{staticClass:"fas fa-rotate mr-1"}),e._v(" "+e._s(e.$t("general.refresh"))+" ")]),t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]],e.liveMembersCount>0?t("div",{staticClass:"text-muted text-center my-3"},[t("span",{staticClass:"text-xs text-success mr-1"},[t("i",{staticClass:"fas fa-circle"})]),t("animated-number",{attrs:{number:e.liveMembersCount,delay:100}}),e.liveMembersCount>1?t("span",[e._v(e._s(e.$t("meeting.members_online")))]):t("span",[e._v(e._s(e.$t("meeting.member_online")))])],1):e._e()]:e.meeting.status==="cancelled"?[t("h4",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.meeting_cancelled"))+" ")]),e.isLoading?e._e():t("div",{staticClass:"d-flex justify-content-center"},[t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:e.meeting.status==="ended"?[t("h4",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.meeting_ended"))+" ")]),e.isLoading?e._e():t("div",{staticClass:"d-flex justify-content-center"},[t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:e.meeting.status==="rejected"?[t("h4",{staticClass:"text-muted text-center my-3"},[e._v(" "+e._s(e.$t("meeting.joining_request_rejected"))+" ")]),e.isLoading?e._e():t("div",{staticClass:"d-flex justify-content-center"},[t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)]:e._e(),e.isOffline?t("div",{staticClass:"offline-mask"},[t("h1",[e._v(e._s(e.$t("general.offline_message")))])]):e._e()],2),e.meeting.isInstantMeeting?e._e():t("card",{staticClass:"agenda-container rounded-0",attrs:{"body-classes":"p-0",shadow:""}},[t("close-button",{attrs:{"parent-class":""},on:{click:e.toggleAgenda}}),t("h4",{staticClass:"meeting-title p-3 mb-3 pr-5 border-bottom"},[e._v(e._s(e.meeting.title))]),t("vue-scroll",{ref:"vue-scroll-agenda",attrs:{id:"vue-scroll-agenda"}},[t("div",{staticClass:"agenda-wrapper px-3 mb-150"},[t("div",{staticClass:"d-flex justify-content-between"},[t("span",{staticClass:"badge badge-info"},[e._v(e._s(e.meeting.type.name))]),t("span",{staticClass:"badge badge-light"},[e._v(e._s(e.meeting.category.name))])]),t("view-paragraph",{staticClass:"mt-4",attrs:{label:e.$t("meeting.props.agenda"),value:e.meeting.agenda,"label-classes":"text font-weight-600"}}),e.meeting.description?t("view-paragraph",{staticClass:"mt-4",attrs:{label:e.$t("meeting.props.description"),value:e.meeting.description,html:"","label-classes":"text font-weight-600"}}):e._e(),e.meeting.attachments?t("view-uploads",{class:["mt-4",e.uiConfigs.colorSchemeType],attrs:{label:e.$t("upload.attachments"),"name-label":e.$t("upload.attachment"),value:e.meeting.attachments,"download-button-classes":"text-gray","url-prefix":`/meetings/${e.uuid}/downloads`}}):e._e()],1)])],1),e.meetingConfigs.canShareFiles&&e.allFeedsCount&&!e.pageQueries.iframe?t("card",{staticClass:"files-container rounded-0",attrs:{"body-classes":"p-0 d-flex flex-column justify-content-between h-100",shadow:""}},[t("close-button",{attrs:{"parent-class":""},on:{click:e.toggleFileSharing}}),t("h4",{staticClass:"p-3 mb-3 pr-5 border-bottom"},[e._v(e._s(e.$t("upload.share_files")))]),t("file-sharer",{attrs:{connection:e.fileSharingConnection,"allow-sharing":e.meetingConfigs.canShareFiles,options:e.fileSharerOptions},on:{hide:function(i){e.showFileSharing=!1},show:function(i){e.showFileSharing=!0}}})],1):e._e(),e.meeting.canModerate?t("card",{staticClass:"meeting-config-container rounded-0",attrs:{"body-classes":"p-0",shadow:""}},[t("close-button",{attrs:{"parent-class":""},on:{click:e.toggleMeetingConfig}}),t("animated-loader",{attrs:{"is-loading":e.isMeetingConfigsLoading,"loader-color":e.vars.loaderColor}}),t("h4",{staticClass:"p-3 mb-0 pr-5 border-bottom"},[e._v(e._s(e.$t("global.config",{attribute:e.$t("meeting.meeting")})))]),t("vue-scroll",{ref:"vue-scroll-meeting-config",attrs:{id:"vue-scroll-meeting-config"}},[t("div",{staticClass:"meeting-config-wrapper px-3 pt-3 mb-4"},[e.showMeetingConfigs?t("form",{on:{submit:function(i){return i.preventDefault(),e.saveMeetingConfig.apply(null,arguments)}}},[t("edit-config",{attrs:{configs:e.configs,meeting:e.meeting,"meeting-config":e.meetingConfigsFormData,preRequisite:e.meetingConfigsPreRequisite},on:{changed:e.changeMeetingConfigsFormData}}),t("div",{staticClass:"form-footer mt-5"},[t("div",{staticClass:"left-side"},[t("base-button",{attrs:{type:"button",design:"light",tabindex:"-1"},on:{click:e.toggleMeetingConfig}},[t("i",{staticClass:"fas fa-times"}),e._v(" "+e._s(e.$t("general.cancel")))])],1),t("div",{staticClass:"right-side"},[t("base-button",{attrs:{type:"submit",design:"primary"}},[e._v(e._s(e.$t("global.save",{attribute:e.$t("config.config")})))])],1)])],1):e._e()])])],1):e._e(),e.isMeetingLive&&(!(e.meetingRules.session&&e.meetingRules.session.oneway)||e.meeting.canModerate)?t("card",{staticClass:"live-participants-container rounded-0",attrs:{"body-classes":"p-0",shadow:""}},[t("close-button",{attrs:{"parent-class":""},on:{click:e.toggleParticipantsList}}),t("h4",{staticClass:"p-3 mb-0 pr-5 border-bottom"},[e._v(e._s(e.$t("meeting.participants_list"))+" ("+e._s(e.liveParticipants.length)+")")]),t("div",{staticClass:"live-participants-wrapper"},[t("ul",{staticClass:"live-participants"},e._l(e.liveParticipants,function(i){return t("li",{key:i.uuid},[i.user?t("div",{staticClass:"d-flex align-items-center"},[t("user-avatar",{attrs:{user:i.user}}),t("div",{staticClass:"d-flex flex-column flex-grow ml-2"},[t("h6",{staticClass:"font-weight-600 mb-0"},[e._v(e._s(i.user.name))]),t("div",{staticClass:"description"},[e._v(e._s(i.user.username))])])],1):e._e()])}),0)])],1):e._e(),e.meeting.canModerate?t("card",{staticClass:"bulk-actions-container rounded-0",attrs:{"body-classes":"p-0",shadow:""}},[t("close-button",{attrs:{"parent-class":""},on:{click:e.toggleBulkActions}}),t("h4",{staticClass:"p-3 mb-0 pr-5 border-bottom"},[e._v(e._s(e.$t("meeting.bulk_actions")))]),t("div",{staticClass:"bulk-actions-wrapper"},[t("ul",{staticClass:"bulk-actions"},[t("li",{on:{click:function(i){return e.toggleRemoteAVSource(null,"audio","temporary",!1)}}},[e._v(" "+e._s(e.$t("meeting.mute_all_audio_for_everyone"))+" "),t("div",{staticClass:"description"},[e._v(" "+e._s(e.$t("meeting.mute_all_audio_for_everyone_helper"))+" ")])]),t("li",{on:{click:function(i){return e.toggleRemoteAVSource(null,"video","temporary",!1)}}},[e._v(" "+e._s(e.$t("meeting.mute_all_video_for_everyone"))+" "),t("div",{staticClass:"description"},[e._v(" "+e._s(e.$t("meeting.mute_all_video_for_everyone_helper"))+" ")])]),t("li",{on:{click:function(i){return e.toggleRemoteAVSource(null,"audio","permanent",!1)}}},[e._v(" "+e._s(e.$t("meeting.dont_allow_audio_anyone"))+" "),t("div",{staticClass:"description"},[e._v(" "+e._s(e.$t("meeting.dont_allow_audio_anyone_helper"))+" ")])]),t("li",{on:{click:function(i){return e.toggleRemoteAVSource(null,"audio","permanent",!0)}}},[e._v(" "+e._s(e.$t("meeting.allow_audio_everyone"))+" "),t("div",{staticClass:"description"},[e._v(" "+e._s(e.$t("meeting.allow_audio_everyone_helper"))+" ")])]),t("li",{on:{click:function(i){return e.toggleRemoteAVSource(null,"video","permanent",!1)}}},[e._v(" "+e._s(e.$t("meeting.dont_allow_video_anyone"))+" "),t("div",{staticClass:"description"},[e._v(" "+e._s(e.$t("meeting.dont_allow_video_anyone_helper"))+" ")])]),t("li",{on:{click:function(i){return e.toggleRemoteAVSource(null,"video","permanent",!0)}}},[e._v(" "+e._s(e.$t("meeting.allow_video_everyone"))+" "),t("div",{staticClass:"description"},[e._v(" "+e._s(e.$t("meeting.allow_video_everyone_helper"))+" ")])])])])],1):e._e(),e.meeting.canModerate&&e.meetingConfigs.enablePoll?t("card",{staticClass:"polls-list-container rounded-0",attrs:{"body-classes":"p-0",shadow:""}},[t("animated-loader",{attrs:{"is-loading":e.isPollsLoading,"loader-color":e.vars.loaderColor}}),e.showPollForm?t("h4",{staticClass:"p-3 mb-0 pr-5 border-bottom"},[e._v(e._s(e.$t("global.add_new",{attribute:e.$t("meeting.poll.poll")})))]):[t("close-button",{attrs:{"parent-class":""},on:{click:e.togglePollsList}}),t("div",{staticClass:"p-3 mb-0 pr-5 border-bottom d-flex justify-content-start"},[t("h4",{staticClass:"mb-0 mr-2"},[e._v(e._s(e.$t("meeting.polls_list")))]),t("base-button",{attrs:{type:"button",design:"primary",size:"sm"},on:{click:function(i){e.showPollForm=!0}}},[e._v(e._s(e.$t("general.add_new")))])],1)],e.showPollForm?t("div",{staticClass:"polls-form-wrapper"},[t("poll-form",{attrs:{poll:e.selectedPoll,url:`/${this.initUrl}/${this.uuid}/polls`},on:{close:e.closePollForm}})],1):t("div",{staticClass:"polls-list-wrapper"},[t("ul",{staticClass:"polls-list"},e._l(e.polls,function(i){return t("li",{key:i.uuid},[t("div",{staticClass:"d-flex flex-column"},[t("h6",{staticClass:"font-weight-600 mb-2"},[e._v(e._s(i.question))]),t("div",{staticClass:"d-flex flex-wrap text-muted text-sm ml-2"},e._l(i.options,function(a){return t("div",{key:a.uuid,staticClass:"d-flex align-items-center mt-1 flex-basis-50"},[t("div",{staticClass:"mr-2"},[a.selected?t("i",{staticClass:"fas fa-check-circle text-success"}):t("i",{staticClass:"far fa-circle"})]),t("div",{staticClass:"flex-grow"},[e._v(e._s(a.title))])])}),0),t("footer",{staticClass:"d-flex align-items-center justify-content-between mt-3"},[t("div",{staticClass:"meta text-muted text-sm flex-grow"},[e._v(" "+e._s(e.$t("meeting.poll.props.duration"))+": "+e._s(i.duration)+" "+e._s(e.$t("list.general.durations.seconds"))+" ")]),i.isPublished?t("div",{staticClass:"d-flex justify-content-end ml-1"},[t("base-button",{attrs:{type:"button",design:"light",size:"sm"},on:{click:function(a){return e.showPollResult(i)}}},[e._v(e._s(e.$t("meeting.poll.view_result")))]),e.isMeetingLive?t("base-button",{attrs:{type:"button",design:"primary",size:"sm"},on:{click:function(a){return e.publishPollResult(i)}}},[e._v(e._s(e.$t("meeting.poll.publish_result")))]):e._e()],1):t("div",{staticClass:"d-flex justify-content-end ml-1"},[t("base-button",{attrs:{type:"button",design:"light",size:"sm"},on:{click:function(a){return e.deletePoll(i)}}},[e._v(e._s(e.$t("general.delete")))]),t("base-button",{attrs:{type:"button",design:"light",size:"sm"},on:{click:function(a){return e.editPoll(i)}}},[e._v(e._s(e.$t("general.edit")))]),e.isMeetingLive?t("base-button",{attrs:{type:"button",design:"primary",size:"sm"},on:{click:function(a){return e.publishPoll(i)}}},[e._v(e._s(e.$t("meeting.poll.publish")))]):e._e()],1)])])])}),0)])],2):e._e(),e.livePoll?t("card",{staticClass:"live-poll-container",attrs:{"body-classes":"p-0",shadow:""}},[t("div",{staticClass:"live-poll-wrapper"},[t("live-poll",{attrs:{poll:e.livePoll,url:`/${this.initUrl}/${this.uuid}/polls/${this.livePoll.uuid}/vote`,user:e.user},on:{"update:poll":function(i){e.livePoll=i},close:e.toggleLivePoll}})],1)]):e._e(),t("footer",{staticClass:"meeting-footer",attrs:{"data-footer-background-color":e.uiConfigs.leftSidebarColor}},[t("div",{staticClass:"logo-wrapper"},[t("app-logo",{attrs:{place:"sidebar",size:"sm",tag:"span"}})],1),t("div",{staticClass:"meeting-actions meeting-actions-center"},[e.meetingConfigs.canToggleAudio?[e.pageQueries.iframe?[e.selectedDevices.enableMicrophone?t("button",{staticClass:"btn action flex-grow",attrs:{type:"button"},on:{click:e.toggleLocalMicrophone}},[t("i",{staticClass:"fas fa-microphone"})]):t("button",{staticClass:"btn action flex-grow disabled-text",attrs:{type:"button"},on:{click:e.toggleLocalMicrophone}},[t("i",{staticClass:"fas fa-microphone-slash"})])]:t("base-dropdown",{staticClass:"more-actions",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up fullwidth-on-mobile",position:"left"},scopedSlots:e._u([{key:"title",fn:function(){return[e.selectedDevices.enableMicrophone?t("button",{staticClass:"btn action",attrs:{type:"button"}},[t("i",{staticClass:"fas fa-microphone"})]):t("button",{staticClass:"btn action disabled-text",attrs:{type:"button"}},[t("i",{staticClass:"fas fa-microphone-slash"})])]},proxy:!0}],null,!1,1263712370)},[t("div",{staticClass:"mb-2 px-3 text-sm text-muted"},[e._v(e._s(e.$t("meeting.media_devices.audio_input")))]),e._l(e.mediaDevices.mics,function(i){return t("button",{key:i.id,staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(a){return e.changeLocalAudioDevice(i)}}},[e._v(" "+e._s(i.label)+" "),e.selectedDevices.mic&&i.id===e.selectedDevices.mic.id?t("i",{staticClass:"fas fa-check min-width-auto text-dark ml-3"}):e._e()])}),t("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center border-top",attrs:{type:"button"},on:{click:e.toggleLocalMicrophone}},[e.selectedDevices.enableMicrophone?[e._v(e._s(e.$t("meeting.mute_audio"))+" "),t("i",{staticClass:"fas fa-microphone-slash min-width-auto text-dark ml-3"})]:[e._v(e._s(e.$t("meeting.unmute_audio"))+" "),t("i",{staticClass:"fas fa-microphone min-width-auto text-dark ml-3"})]],2)],2)]:e._e(),e.meetingConfigs.canToggleVideo?[e.pageQueries.iframe?[e.selectedDevices.enableCamera?t("button",{staticClass:"btn action flex-grow",attrs:{type:"button"},on:{click:e.toggleLocalCamera}},[t("i",{staticClass:"fas fa-video"})]):t("button",{staticClass:"btn action flex-grow disabled-text",attrs:{type:"button"},on:{click:e.toggleLocalCamera}},[t("i",{staticClass:"fas fa-video-slash"})])]:t("base-dropdown",{staticClass:"more-actions",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up fullwidth-on-mobile video-dropdown",position:"left"},scopedSlots:e._u([{key:"title",fn:function(){return[e.selectedDevices.enableCamera?t("button",{staticClass:"btn action grid-toggle-btn",attrs:{type:"button"}},[t("i",{staticClass:"fas fa-video"})]):t("button",{staticClass:"btn action grid-toggle-btn disabled-text",attrs:{type:"button"}},[t("i",{staticClass:"fas fa-video-slash"})])]},proxy:!0}],null,!1,1861019309)},[t("div",{staticClass:"mb-2 px-3 text-sm text-muted"},[e._v(e._s(e.$t("meeting.media_devices.video_input")))]),e._l(e.mediaDevices.cams,function(i){return t("button",{key:i.id,staticClass:"dropdown-item d-flex justify-content-between align-items-center",attrs:{type:"button"},on:{click:function(a){return e.changeLocalVideoDevice(i)}}},[e._v(" "+e._s(i.label)+" "),e.selectedDevices.cam&&i.id===e.selectedDevices.cam.id?t("i",{staticClass:"fas fa-check min-width-auto text-dark ml-3"}):e._e()])}),t("div",{staticClass:"border-top p-3 d-none d-md-block"},[t("div",{staticClass:"mb-2 text-sm text-muted"},[e._v(e._s(e.$t("meeting.media_devices.video_resolution")))]),t("div",{staticClass:"d-flex justify-content-stretch"},[e._l(e.mediaDevices.resolutions,function(i){return[e.selectedDevices.resolution===i.uuid?t("button",{key:i.uuid,staticClass:"btn btn-sm btn-light",attrs:{type:"button"},on:{click:function(a){return e.changeLocalVideoResolution(i)}}},[e._v(e._s(i.label))]):t("button",{key:i.uuid,staticClass:"btn btn-sm",attrs:{type:"button"},on:{click:function(a){return e.changeLocalVideoResolution(i)}}},[e._v(e._s(i.label))])]})],2)]),e.pageQueries.iframe?e._e():t("button",{staticClass:"dropdown-item d-flex d-md-none justify-content-between align-items-center border-top",attrs:{type:"button"},on:{click:e.switchFacingMode}},[e._v(" "+e._s(e.$t("meeting.switch_to"))+" "),e.selectedDevices.facingMode==="user"?[e._v(e._s(e.$t("meeting.facing_mode_environment")))]:e.selectedDevices.facingMode==="environment"?[e._v(e._s(e.$t("meeting.facing_mode_user")))]:[e._v(e._s(e.$t("meeting.facing_mode_auto")))],t("i",{staticClass:"fas fa-camera-rotate min-width-auto text-dark ml-3"})],2),t("button",{staticClass:"dropdown-item d-flex justify-content-between align-items-center border-top",attrs:{type:"button"},on:{click:e.toggleLocalCamera}},[e.selectedDevices.enableCamera?[e._v(e._s(e.$t("meeting.mute_video"))+" "),t("i",{staticClass:"fas fa-video-slash min-width-auto text-dark ml-3"})]:[e._v(e._s(e.$t("meeting.unmute_video"))+" "),t("i",{staticClass:"fas fa-video min-width-auto text-dark ml-3"})]],2)],2)]:e._e(),e.isMeetingLive?[e.meetingConfigs.canShareFiles&&e.allFeedsCount&&!e.pageQueries.iframe?t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],class:["btn action d-none d-lg-inline-block",{"disabled-text":e.showFileSharing}],attrs:{type:"button",title:e.$t("upload.share_files")},on:{click:e.toggleFileSharing}},[t("i",{staticClass:"fas fa-upload"})]):e._e(),t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],class:["btn action danger-text",{" flex-grow":e.pageQueries.iframe}],attrs:{type:"button",title:e.$t("meeting.leave_meeting")},on:{click:e.getOffline}},[t("i",{staticClass:"fas fa-phone-slash"})]),e.meetingConfigs.canShareScreen?[e.localScreenStream?t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action disabled-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.stop_sharing_screen")},on:{click:e.stopSharingScreen}},[t("i",{staticClass:"fas fa-minus-square"})]):t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.share_screen")},on:{click:e.shareScreen}},[t("i",{staticClass:"fas fa-desktop"})])]:e._e(),e.meetingConfigs.canRecord&&e.meeting.canModerate&&!e.pageQueries.iframe?[e.recordingStatus==="started"||e.recordingStatus==="paused"?[e.meetingConfigs.enableAutoRecording&&!e.meetingConfigs.canStopAutoRecording?[t("button",{staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button"}},[t("i",{staticClass:"fas fa-circle"}),e._v(" "),t("span",{staticClass:"recording_time"},[e._v(e._s(e.recordingDuration))])])]:[e.recordingStatus==="paused"?t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action success-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.resume_recording")},on:{click:e.resumeRecording}},[t("i",{staticClass:"fas fa-circle"})]):t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.pause_recording")},on:{click:e.pauseRecording}},[t("i",{staticClass:"fas fa-pause"})]),t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.stop_recording")},on:{click:e.stopRecording}},[t("i",{staticClass:"fas fa-stop"}),e._v(" "),t("span",{staticClass:"recording_time"},[e._v(e._s(e.recordingDuration))])])]]:t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.start_recording")},on:{click:e.startRecording}},[t("i",{staticClass:"fas fa-circle"})])]:e._e(),e.meetingConfigs.canUseWhiteboard&&!e.pageQueries.iframe?[e.showWhiteboard?t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.hide_whiteboard")},on:{click:e.toggleWhiteboard}},[t("i",{staticClass:"fas fa-chalkboard-teacher"})]):e._e(),e.showWhiteboard?t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action danger-text d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.clear_hide_whiteboard")},on:{click:e.stopWhiteboard}},[t("i",{staticClass:"fas fa-chalkboard-teacher mr-0"}),t("i",{staticClass:"fas fa-times font-size-xs ml-1 font-size-xs text-danger"})]):t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action d-none d-md-inline-block",attrs:{type:"button",title:e.$t("meeting.show_whiteboard")},on:{click:e.toggleWhiteboard}},[t("i",{staticClass:"fas fa-chalkboard-teacher"})])]:e._e(),e.meetingConfigs.canUseHandGesture&&!e.pageQueries.iframe?[e.isHandUp?t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action success-text",attrs:{type:"button",title:e.$t("meeting.lower_hand")},on:{click:e.toggleHandUp}},[t("i",{staticClass:"far fa-hand-paper"})]):t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],staticClass:"btn action",attrs:{type:"button",title:e.$t("meeting.raise_hand")},on:{click:e.toggleHandUp}},[t("i",{staticClass:"fas fa-hand-paper"})])]:e._e()]:e._e()],2),t("div",{staticClass:"meeting-actions meeting-actions-right"},[e.recordedFilesToUpload&&e.recordedFilesToUpload.length?t("base-dropdown",{staticClass:"more-actions d-none d-md-inline-block",attrs:{tag:"div",direction:"up",size:"md","menu-classes":"show-dropdown-up p-0 max-height-500px",position:"right","has-scroll":""}},[t("button",{staticClass:"btn action grid-toggle-btn d-none d-md-inline-block",attrs:{slot:"title",type:"button"},slot:"title"},[t("i",{staticClass:"fas fa-cloud-upload-alt"})]),t("card",{staticClass:"upload-widget",attrs:{shadow:"","body-classes":"p-0","header-classes":"p-2"},scopedSlots:e._u([{key:"header",fn:function(){return[t("h5",{staticClass:"m-0 p-1"},[e._v(e._s(e.$t("meeting.meeting_recordings")))])]},proxy:!0}],null,!1,2909934337)},[t("div",{staticClass:"widget-wrapper"},[t("div",{staticClass:"widget-body file-uploader"},[t("div",{staticClass:"files-list-wrapper"},[t("ul",{staticClass:"files-list"},e._l(e.recordedFilesToUpload,function(i){return t("li",{key:i.uuid,staticClass:"file-details-row"},[t("div",{staticClass:"file-details"},[i.chunk?t("h6",{staticClass:"pointer"},[e._v(e._s(i.name))]):t("h6",{staticClass:"pointer",on:{click:function(a){return i.download(i.blob)}}},[e._v(e._s(i.file.name))]),i.error?t("p",{staticClass:"text-danger"},[e._v(" "+e._s(i.error)+" ")]):[t("p",{staticClass:"text-muted"},[e._v(" "+e._s(i.status)+" ")]),t("p",[i.chunk?e._e():t("span",[t("span",{staticClass:"font-weight-700"},[e._v(e._s(e.$t("upload.size")))]),e._v(": "+e._s(e._f("decimal")(i.file.size/1024,0))+" KB")])])]],2),t("div",{class:["status-wrapper",{"actions-wrapper":i.status==="uploaded"}]},[t("transition",{staticClass:"transition-wrapper",attrs:{appear:"",tag:"div",name:"actions",mode:"out-in"}},[i.status==="uploading"?t("div",{staticClass:"status-uploading-wrapper"},[i.chunk?e._e():t("label",{staticClass:"status-action",on:{click:i.cancel}},[e._v(e._s(e.$t("upload.cancel")))]),t("progress-ring",{attrs:{progress:i.progress,"stroke-color":e.vars.loaderColor,radius:18,"stroke-width":2,"percent-size":"sm"}})],1):i.status==="cancelled"?t("div",{staticClass:"status-cancelled-wrapper"},[t("label",{staticClass:"status-text text-danger"},[e._v(e._s(e.$t("upload.cancelled")))]),t("span",{staticClass:"status-icon text-danger"},[t("i",{staticClass:"fas fa-times"})])]):i.status==="error"?t("div",{staticClass:"status-error-wrapper"},[t("label",{staticClass:"status-text text-danger"},[e._v(e._s(e.$t("upload.error")))]),t("span",{staticClass:"status-icon text-danger"},[t("i",{staticClass:"fas fa-exclamation-triangle"})])]):e._e()])],1)])}),0)])])])])],1):e._e(),e.meetingConfigs.enableChat?t("button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.d500",modifiers:{hover:!0,d500:!0}}],class:["btn action chats-toggle-btn",{pulse:e.totalUnreadMessages&&e.totalUnreadMessages>0&&!e.isChatBoxShown}],attrs:{type:"button",title:e.$t(e.isChatBoxShown?"global.hide":"global.show",{attribute:e.$t("chat.chats")})},on:{click:e.toggleChatBox}},[t("i",{class:[e.isChatBoxShown?"fas fa-comment-slash":"far fa-comment"]}),e.totalUnreadMessages&&e.totalUnreadMessages>0?t("span",{staticClass:"text-success unread-count"},[e._v(e._s(e.totalUnreadMessages))]):e._e()]):e._e(),t("base-dropdown",{staticClass:"more-actions",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up fullwidth-on-mobile",position:"right","has-scroll":e.meeting.canModerate}},[t("button",{staticClass:"btn action more-actions-btn",attrs:{slot:"title",type:"button"},slot:"title"},[t("i",{staticClass:"fas fa-ellipsis-v"})]),e.isMeetingLive?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.getOffline}},[t("i",{staticClass:"fas fa-phone-slash"}),e._v(" "+e._s(e.$t("meeting.leave_meeting")))]):t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[t("i",{staticClass:"fas fa-chevron-left"}),e._v(" "+e._s(e.$t("general.back")))]),e.meeting.canModerate&&e.meeting.status==="live"?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.endMeeting}},[t("i",{staticClass:"fas fa-calendar-times"}),e._v(" "+e._s(e.$t("meeting.end_meeting")))]):e._e(),t("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),e.meeting.isInstantMeeting?e._e():t("button",{staticClass:"dropdown-item agenda-toggle-btn",attrs:{type:"button"},on:{click:e.toggleAgenda}},[t("i",{staticClass:"fas fa-quote-left"}),e._v(" "+e._s(e.$t(e.showAgenda?"global.hide":"global.show",{attribute:e.$t("general.agenda")})))]),t("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:e.toggleFooterAutoHide}},[t("i",{staticClass:"fas fa-hourglass-start"}),e._v(" "+e._s(e.$t("meeting.toggle_autohide")))]),e.meetingConfigs.layout==="grid"?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.toggleCompactLayout}},[t("i",{staticClass:"fas fa-th-large"}),e._v(" "+e._s(e.$t("meeting.toggle_compact_layout")))]):e._e(),e.meetingRules.sendVideo&&e.selectedDevices.enableCamera?t("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:e.toggleBackgroundBlur}},[t("i",{staticClass:"fas fa-crosshairs"}),e._v(" "+e._s(e.$t(e.pageConfigs.backgroundBlur?"meeting.toggle_blur_off":"meeting.toggle_blur_on")))]):e._e(),e.uiConfigs.fullScreen?t("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:function(i){return e.toggleFullScreen(!1)}}},[t("i",{staticClass:"fas fa-compress"}),e._v(" "+e._s(e.$t("config.ui.toggle_fullscreen")))]):t("button",{staticClass:"dropdown-item d-none d-md-block",attrs:{type:"button"},on:{click:function(i){return e.toggleFullScreen(!0)}}},[t("i",{staticClass:"fas fa-expand"}),e._v(" "+e._s(e.$t("config.ui.toggle_fullscreen")))]),e.meetingConfigs.canToggleInfo&&e.isMeetingLive?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.toggleMeetingInfo}},[t("i",{staticClass:"fas fa-info"}),e._v(" "+e._s(e.$t("meeting.toggle_meeting_info")))]):e._e(),e.isMeetingLive&&(!(e.meetingRules.session&&e.meetingRules.session.oneway)||e.meeting.canModerate)?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.toggleParticipantsList}},[t("i",{staticClass:"fas fa-list"}),e._v(" "+e._s(e.$t("meeting.toggle_participants_list")))]):e._e(),e.meeting.canModerate&&e.isMeetingLive?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.toggleBulkActions}},[t("i",{staticClass:"fas fa-check-double"}),e._v(" "+e._s(e.$t("meeting.toggle_bulk_actions")))]):e._e(),e.meeting.canModerate&&e.meetingConfigs.enablePoll?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.togglePollsList}},[t("i",{staticClass:"fas fa-square-poll-vertical"}),e._v(" "+e._s(e.$t("meeting.toggle_polls_list")))]):e._e(),e.meetingConfigs.canToggleLayout&&e.feedsCount?[t("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(i){return e.toggleLayout("grid")}}},[t("i",{staticClass:"fas fa-check text-light",class:{"text-dark":e.meetingConfigs.layout==="grid"}}),e._v(" "+e._s(e.$t("global.enable",{attribute:e.$t("meeting.grid_layout")})))]),t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(i){return e.toggleLayout("gallery")}}},[t("i",{staticClass:"fas fa-check text-light",class:{"text-dark":e.meetingConfigs.layout==="gallery"}}),e._v(" "+e._s(e.$t("global.enable",{attribute:e.$t("meeting.gallery_layout")})))]),t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:function(i){return e.toggleLayout("fullpage")}}},[t("i",{staticClass:"fas fa-check text-light",class:{"text-dark":e.meetingConfigs.layout==="fullpage"}}),e._v(" "+e._s(e.$t("global.enable",{attribute:e.$t("meeting.fullpage_layout")})))])]:e._e(),t("div",{staticClass:"dropdown-divider my-1",attrs:{role:"separator"}}),e.meeting.canModerate&&!e.isMeetingLive?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.toggleMeetingConfig}},[t("i",{staticClass:"fas fa-cog"}),e._v(" "+e._s(e.$t("global.config",{attribute:e.$t("meeting.meeting")})))]):e._e(),e.meetingConfigs.canTakeSnapshot&&e.meeting.hasSnapshots?t("a",{staticClass:"dropdown-item",attrs:{target:"_blank",href:e.snapshotsPageUrl()}},[t("i",{staticClass:"fas fa-image"}),e._v(" "+e._s(e.$t("global.view",{attribute:e.$t("meeting.snapshots")})))]):e._e(),e.meetingConfigs.canRecord&&(e.meeting.hasChunkRecordings||e.meeting.hasRecordings)?t("a",{staticClass:"dropdown-item",attrs:{target:"_blank",href:e.recordingsPageUrl()}},[t("i",{staticClass:"fas fa-photo-video"}),e._v(" "+e._s(e.$t("global.view",{attribute:e.$t("meeting.recordings")})))]):e._e(),e.meetingConfigs.canShareFiles&&e.allFeedsCount&&!e.pageQueries.iframe?t("button",{staticClass:"dropdown-item file-sharing-btn d-md-none",attrs:{type:"button"},on:{click:e.toggleFileSharing}},[t("i",{staticClass:"fas fa-upload"}),e._v(" "+e._s(e.$t("upload.share_files")))]):e._e(),e.meetingConfigs.canShareLink?[t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.shareURL}},[t("i",{staticClass:"fas fa-share-alt"}),e._v(" "+e._s(e.$t("general.share_url")))]),e.hasNativeShare?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.share}},[t("i",{staticClass:"fas fa-share-alt"}),e._v(" "+e._s(e.$t("general.share")))]):e._e()]:e._e(),e.isMeetingLive&&e.feedsCount?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.refreshStreams}},[t("i",{staticClass:"fas fa-refresh"}),e._v(" "+e._s(e.$t("meeting.refresh_streams")))]):e._e(),e.meetingConfigs.debugMode?t("button",{staticClass:"dropdown-item",attrs:{type:"button"},on:{click:e.reportAnIssue}},[t("i",{staticClass:"fas fa-bug"}),e._v(" "+e._s(e.$t("general.report_an_issue")))]):e._e()],2),t("base-dropdown",{staticClass:"more-actions",attrs:{tag:"div",direction:"up","menu-classes":"show-dropdown-up",position:"right"}},[t("button",{staticClass:"btn action grid-toggle-btn d-none d-md-inline-block px-1",attrs:{slot:"title",type:"button"},slot:"title"},[e.loggedInUser?t("user-avatar",{attrs:{user:e.loggedInUser,size:40,color:e.vars.colors[e.uiConfigs.topNavbarColor]}}):e._e()],1),t("h6",{staticClass:"dropdown-header"},[e._v(e._s(e.$t("general.greeting")+", "+e.loggedInUser.name))]),e.loggedInUser?t("router-link",{staticClass:"dropdown-item",attrs:{to:{name:"appProfileView"}}},[t("i",{staticClass:"fas fa-user"}),e._v(" "+e._s(e.$t("user.your_profile"))+" ")]):e._e(),e.hasPermission("access-config")?e._e():t("router-link",{staticClass:"dropdown-item",attrs:{to:{name:"appUserPreference"}}},[t("i",{staticClass:"fas fa-user-cog"}),e._v(" "+e._s(e.$t("user.user_preference"))+" ")]),t("router-link",{staticClass:"dropdown-item",attrs:{to:{name:"appUserChangePassword"}}},[t("i",{staticClass:"fas fa-key"}),e._v(" "+e._s(e.$t("auth.password.change_password"))+" ")])],1)],1)]),e.meeting&&e.meeting.uuid&&e.meetingConfigs.enableChat&&e.configs.chat&&e.configs.chat.enabled?t("div",{staticClass:"chat-box-container"},[t("chat-box",{attrs:{"box-visibility":e.isChatBoxShown,meeting:e.meeting,channel:e.subscriptions.userPrivate,restrict:e.meetingConfigs.chatVisibility==="meeting_group","restrict-to":e.meeting.uuid},on:{boxHidden:function(i){e.isChatBoxShown=!1},boxShown:function(i){e.isChatBoxShown=!0}}})],1):e._e()]:t("card",{staticClass:"d-flex justify-content-center align-items-center min-height-90vh",attrs:{shadow:""}},[t("h2",{staticClass:"text-center text-danger my-3"},[e._v(" "+e._s(e.$t("meeting.not_allowed"))+" ")]),e.isLoading?e._e():t("div",{staticClass:"d-flex justify-content-center"},[t("base-button",{attrs:{type:"button",design:"light",size:"lg"},on:{click:function(i){return e.$router.push({name:e.fallBackRoute})}}},[e._v(e._s(e.$t("global.click_to",{attribute:e.$t("general.go_back")})))])],1)])],2)},Me=[],xe=R(Le,Te,Me,!1,null,null,null,null);const nt=xe.exports;export{nt as default};
