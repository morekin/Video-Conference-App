import{f as a}from"../../auth-form.6e2f513b.js";import{n as i}from"../../_plugin-vue2_normalizer.7b9a2fe2.js";import"../../vendor/vendor-core.3574f8d9.js";import"../../vendor/vendor-others.c8ba1624.js";import"../../guest-footer.6b237a73.js";import"../../AppLogo.91541531.js";const n={extends:a,data(){return{formData:{email:"",otp:"",ref:null},otpRequested:!1}},methods:{submit(){this.isLoading=!0;let r=this.$route.query;this.$gaEvent("engagement","login","EmailOTP");const t=this.otpRequested?{...this.formData}:{email:this.formData.email,ref:this.formData.ref};this.LoginUsingOtp(t).then(e=>{if(this.$toasted.success(e.message,this.$toastConfig),this.otpRequested){this.$gaEvent("activity","loggedin","EmailOTP");let s=e.reload?{name:"appDashboard",query:{reload:1}}:{name:"appDashboard"};r&&r.ref&&this.$router.resolve(r.ref)&&(s=this.$router.resolve(r.ref).route),this.hasRole("admin")&&this.configs.system&&this.configs.system.setupWizard&&(s=this.withQuery({name:"setup"})),this.ResetTwoFactorSet().then(()=>{this.$router.push(s)}).catch(o=>{this.isLoading=!1,this.formErrors=formUtil.handleErrors(o)})}else this.$gaEvent("activity","loginOtpRequested","EmailOTP"),this.otpRequested=!0,this.isLoading=!1}).catch(e=>{this.isLoading=!1,this.formErrors=formUtil.handleErrors(e)})}},mounted(){let r=this.$route.query;r&&r.ref&&(this.formData.ref=r.ref),this.SetCSRF()}};var l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"guest-page"},[e("box",[e("animated-loader",{attrs:{"is-loading":t.isLoading,"loader-color":t.vars.loaderColor}}),e("guest-header",[e("h5",[t._v(t._s(t.$t("auth.login.login_using_email_otp")))])]),e("section",{attrs:{role:"main"}},[e("form",{on:{submit:function(s){return s.preventDefault(),t.submit.apply(null,arguments)}}},[e("base-input",{staticClass:"mb-3",attrs:{"auto-focus":!t.otpRequested,label:t.$t("auth.login.props.email"),type:"text","addon-left-icon":"fas fa-envelope",error:t.formErrors.email,disabled:t.otpRequested},on:{"update:error":function(s){return t.$set(t.formErrors,"email",s)}},model:{value:t.formData.email,callback:function(s){t.$set(t.formData,"email",s)},expression:"formData.email"}}),t.otpRequested?e("base-input",{staticClass:"mb-3",attrs:{"auto-focus":t.otpRequested,label:t.$t("auth.login.props.otp"),type:"text","addon-left-icon":"fas fa-key",error:t.formErrors.otp},on:{"update:error":function(s){return t.$set(t.formErrors,"otp",s)}},model:{value:t.formData.otp,callback:function(s){t.$set(t.formData,"otp",s)},expression:"formData.otp"}}):t._e(),e("div",{staticClass:"text-center"},[e("base-button",{staticClass:"my-4 text-lg",attrs:{type:"submit",design:"primary",block:""}},[t.otpRequested?e("span",[t._v(t._s(t.$t("auth.login.login")))]):e("span",[t._v(t._s(t.$t("auth.login.request_otp")))])])],1),e("div",{staticClass:"form-group m-b-0"},[e("div",{staticClass:"col-sm-12 text-center"},[t.configs.meeting&&t.configs.meeting.enablePam?[t.$route.query&&(t.$route.query.identifier||t.$route.query.uuid)&&t.$route.query.pam?e("p",[e("router-link",{staticClass:"text-primary m-l-5",attrs:{to:t.withQuery({name:"liveMeetingForGuest",params:{uuid:t.$route.query.uuid},query:{identifier:t.$route.query.identifier}},!1,{removeRef:!0})}},[e("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.$t("meeting.join_meeting_as_guest")))])])],1):t._e()]:t._e(),e("p",[e("router-link",{staticClass:"text-primary m-l-5",attrs:{to:t.withQuery({name:"login"})}},[e("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.$t("auth.login.login_using_password")))])])],1)],2)])],1)])],1),t.configs.system?e("guest-footer",{attrs:{"footer-credit":t.configs.system.footerCredit,version:t.configs.system.version}}):t._e()],1)},u=[],m=i(n,l,u,!1,null,null,null,null);const _=m.exports;export{_ as default};
